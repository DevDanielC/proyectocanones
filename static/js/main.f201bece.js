(()=>{"use strict";var e={2705:(e,t,o)=>{var a=o(9289),r=o(614),n=o(314),i=o(1411),l=o(6466),s=o(7575),d=o(4485),c=o(2535),u=o(7795),f=o(4790),h=o(2412),m=o(607),g=o(8561),p=o(8798),x=o(2057),b=o(4023),y=o(8503),j=o(343),w=o(7730);const{width:C}=x.default.get("window"),v=C<768,S=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa",padding:20},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},errorText:{fontSize:18,color:"#dc3545",textAlign:"center",marginBottom:20},backButton:{padding:15,borderRadius:8,backgroundColor:"#4a6da7"},backButtonText:{color:"white",fontSize:16,fontWeight:"600"},scrollContainer:{padding:v?16:24,paddingBottom:40},card:{backgroundColor:"white",borderRadius:12,padding:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:6,elevation:3},cardHeader:{flexDirection:"row",alignItems:"center",marginBottom:20,flexWrap:"wrap"},equipoIcon:{marginRight:12},cardTitle:{fontSize:22,fontWeight:"600",color:"#2c3e50",marginRight:12,flexShrink:1},detailsContainer:{marginTop:10},statusBadge:{paddingHorizontal:10,paddingVertical:6,borderRadius:12,alignSelf:"flex-start"},statusAvailable:{backgroundColor:"#e6f7ee"},statusReserved:{backgroundColor:"#fff8e1"},statusMaintenance:{backgroundColor:"#fff0f0"},statusUnavailable:{backgroundColor:"#f0f0f0"},statusText:{fontSize:12,fontWeight:"600"},detailItem:{flexDirection:"row",alignItems:"center",marginBottom:12},detailText:{fontSize:16,color:"#495057",marginLeft:8,flexShrink:1},descriptionContainer:{marginTop:20,paddingTop:20,borderTopWidth:1,borderTopColor:"#e9ecef"},sectionTitle:{fontSize:16,fontWeight:"600",color:"#2c3e50",marginBottom:8},descriptionText:{fontSize:14,color:"#6c757d",lineHeight:22},actionsContainer:{marginTop:24},button:{flexDirection:"row",justifyContent:"center",alignItems:"center",backgroundColor:"#4a6da7",padding:14,borderRadius:8},buttonDisabled:{opacity:.7},buttonText:{color:"white",fontSize:16,fontWeight:"600",marginLeft:8},notAvailableText:{fontSize:16,color:"#dc3545",textAlign:"center",paddingVertical:12}}),T=()=>{const e=(0,i.useRoute)(),t=(0,i.useNavigation)(),[o,a]=(0,n.useState)(null),[r,l]=(0,n.useState)(!0),[s,u]=(0,n.useState)(!1),[x,C]=(0,n.useState)(null),{equipoId:v,equipo:T}=e.params||{};(0,n.useEffect)((()=>{(async()=>{try{if(l(!0),T)a(T);else{if(!v||isNaN(v))throw new Error("ID de equipo no v\xe1lido");const{data:e,error:t}=await b.supabase.from("equipos").select("\n              idequipo,\n              nombreequipo,\n              estado,\n              descripcion,\n              fechacreacion,\n              fechabaja,\n              fechaactualizacion,\n              categoriasequipos: idcategoria (nombrecategoria, descripcion)\n            ").eq("idequipo",v).single();if(t)throw t;if(!e)throw new Error("Equipo no encontrado");a(e)}const{data:e,error:t}=await b.supabase.from("prestamos").select("\n            idprestamo,\n            fechaprestamo,\n            fechadevolucion_prevista,\n            personal: idpersonal (nombre_completo)\n          ").eq("idequipo",T?.idequipo||v).eq("estado","Prestado").single();!t&&e&&C(e)}catch(e){console.error("Error al cargar datos:",e),p.default.alert("Error",e.message||"No se pudo cargar la informaci\xf3n del equipo",[{text:"OK",onPress:()=>t.goBack()}])}finally{l(!1)}})()}),[v,T]);return r?(0,w.jsxs)(g.default,{style:S.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:S.loadingText,children:"Cargando informaci\xf3n del equipo..."})]}):o?(0,w.jsx)(g.default,{style:S.safeArea,children:(0,w.jsx)(m.default,{contentContainerStyle:S.scrollContainer,showsVerticalScrollIndicator:!1,children:(0,w.jsxs)(d.default,{style:S.card,children:[(0,w.jsxs)(d.default,{style:S.cardHeader,children:[(0,w.jsx)(y.default,{name:"desktop-classic",size:32,color:"#4a6da7",style:S.equipoIcon}),(0,w.jsx)(c.default,{style:S.cardTitle,children:o.nombreequipo}),(0,w.jsx)(d.default,{style:[S.statusBadge,"disponible"===o.estado?S.statusAvailable:"prestado"===o.estado?S.statusReserved:"mantenimiento"===o.estado?S.statusMaintenance:S.statusUnavailable],children:(0,w.jsx)(c.default,{style:S.statusText,children:o.estado.toUpperCase()})})]}),(0,w.jsxs)(d.default,{style:S.detailsContainer,children:[(0,w.jsxs)(d.default,{style:S.detailItem,children:[(0,w.jsx)(j.default,{name:"category",size:20,color:"#6c757d"}),(0,w.jsxs)(c.default,{style:S.detailText,children:["Categor\xeda: ",o.categoriasequipos?.nombrecategoria||"No especificada"]})]}),(0,w.jsxs)(d.default,{style:S.detailItem,children:[(0,w.jsx)(j.default,{name:"event",size:20,color:"#6c757d"}),(0,w.jsxs)(c.default,{style:S.detailText,children:["Fecha de creaci\xf3n: ",new Date(o.fechacreacion).toLocaleDateString()]})]}),o.fechaactualizacion&&(0,w.jsxs)(d.default,{style:S.detailItem,children:[(0,w.jsx)(j.default,{name:"update",size:20,color:"#6c757d"}),(0,w.jsxs)(c.default,{style:S.detailText,children:["\xdaltima actualizaci\xf3n: ",new Date(o.fechaactualizacion).toLocaleDateString()]})]}),x&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(d.default,{style:S.detailItem,children:[(0,w.jsx)(j.default,{name:"person",size:20,color:"#6c757d"}),(0,w.jsxs)(c.default,{style:S.detailText,children:["Prestado a: ",x.personal?.nombre_completo||"No especificado"]})]}),(0,w.jsxs)(d.default,{style:S.detailItem,children:[(0,w.jsx)(j.default,{name:"date-range",size:20,color:"#6c757d"}),(0,w.jsxs)(c.default,{style:S.detailText,children:["Fecha pr\xe9stamo: ",new Date(x.fechaprestamo).toLocaleDateString()]})]}),x.fechadevolucion_prevista&&(0,w.jsxs)(d.default,{style:S.detailItem,children:[(0,w.jsx)(j.default,{name:"event-available",size:20,color:"#6c757d"}),(0,w.jsxs)(c.default,{style:S.detailText,children:["Devoluci\xf3n prevista: ",new Date(x.fechadevolucion_prevista).toLocaleDateString()]})]})]}),o.descripcion&&(0,w.jsxs)(d.default,{style:S.descriptionContainer,children:[(0,w.jsx)(c.default,{style:S.sectionTitle,children:"Descripci\xf3n"}),(0,w.jsx)(c.default,{style:S.descriptionText,children:o.descripcion})]}),o.categoriasequipos?.descripcion&&(0,w.jsxs)(d.default,{style:S.descriptionContainer,children:[(0,w.jsx)(c.default,{style:S.sectionTitle,children:"Descripci\xf3n de la categor\xeda"}),(0,w.jsx)(c.default,{style:S.descriptionText,children:o.categoriasequipos.descripcion})]})]}),(0,w.jsxs)(d.default,{style:S.actionsContainer,children:[(0,w.jsx)(h.default,{style:[S.button,s&&S.buttonDisabled,"mantenimiento"===o.estado&&S.buttonDisabled],onPress:async()=>{if(o){u(!0);try{const{data:{user:e}}=await b.supabase.auth.getUser();if(!e)throw new Error("Usuario no autenticado");if("disponible"===o.estado){const{error:a}=await b.supabase.rpc("realizar_prestamo",{p_id_usuario:e.id,p_id_equipo:o.idequipo,p_nombre_equipo:o.nombreequipo});if(a)throw a;p.default.alert("Pr\xe9stamo registrado",`El pr\xe9stamo del equipo ${o.nombreequipo} ha sido registrado correctamente.`,[{text:"Aceptar",onPress:()=>t.goBack()}])}else if("prestado"===o.estado){if(!x)throw new Error("No se encontr\xf3 informaci\xf3n del pr\xe9stamo activo");const{error:e}=await b.supabase.rpc("registrar_devolucion_app",{p_idprestamo:x.idprestamo});if(e)throw e;p.default.alert("Devoluci\xf3n registrada",`El equipo ${o.nombreequipo} ha sido devuelto correctamente.`,[{text:"Aceptar",onPress:()=>t.goBack()}])}}catch(e){console.error("Error al procesar:",e),p.default.alert("Error",e.message||"No se pudo completar la operaci\xf3n")}finally{u(!1)}}},disabled:s||"mantenimiento"===o.estado,children:s?(0,w.jsx)(f.default,{color:"white"}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(j.default,{name:"disponible"===o.estado?"send":"assignment-return",size:20,color:"white"}),(0,w.jsx)(c.default,{style:S.buttonText,children:"disponible"===o.estado?"Solicitar Pr\xe9stamo":"Registrar Devoluci\xf3n"})]})}),"mantenimiento"===o.estado&&(0,w.jsx)(c.default,{style:S.notAvailableText,children:"Este equipo est\xe1 en mantenimiento y no est\xe1 disponible"})]})]})})}):(0,w.jsxs)(g.default,{style:S.container,children:[(0,w.jsx)(c.default,{style:S.errorText,children:"No se encontr\xf3 informaci\xf3n del equipo"}),(0,w.jsx)(h.default,{style:S.backButton,onPress:()=>t.goBack(),children:(0,w.jsx)(c.default,{style:S.backButtonText,children:"Volver"})})]})};var B=o(4975),z=o(6445);const{width:q}=x.default.get("window"),k=q<768,I=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:k?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:k?18:20,fontWeight:"600",color:"#2c3e50"},scrollContent:{flexGrow:1,paddingBottom:24},content:{width:"100%",maxWidth:1200,alignSelf:"center",paddingHorizontal:k?16:24},statsContainer:{flexDirection:k?"column":"row",flexWrap:"wrap",justifyContent:"space-between",marginTop:24,marginBottom:32},statCard:{width:k?"100%":"23%",backgroundColor:"#ffffff",borderRadius:12,padding:20,marginBottom:k?16:0,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2,alignItems:"center"},statIconContainer:{width:48,height:48,borderRadius:24,justifyContent:"center",alignItems:"center",marginBottom:16},statTitle:{fontSize:14,color:"#6c757d",marginBottom:4,fontWeight:"500"},statValue:{fontSize:28,fontWeight:"700",color:"#2c3e50",marginBottom:4},statSubtitle:{fontSize:12,color:"#95a5a6",fontWeight:"400"},section:{backgroundColor:"#ffffff",borderRadius:12,padding:k?16:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},sectionTitle:{fontSize:k?16:18,fontWeight:"600",color:"#2c3e50",marginBottom:16},quickActions:{flexDirection:k?"column":"row",justifyContent:"space-between"},quickAction:{flexDirection:"row",alignItems:"center",backgroundColor:"#f8f9fa",borderRadius:8,padding:k?14:16,marginBottom:k?12:0,width:k?"100%":"48%",borderWidth:1,borderColor:"#e0e0e0"},quickActionIcon:{marginRight:16},quickActionText:{fontSize:14,color:"#2c3e50",fontWeight:"500"},quickActionSubtext:{fontSize:12,color:"#95a5a6",marginTop:2}}),R=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)({usuarios:0,equipos:0,prestamos:0,mantenimientos:0}),[a,r]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{(async()=>{try{const{count:e}=await b.supabase.from("usuarios").select("*",{count:"exact"}),{count:t}=await b.supabase.from("equipos").select("*",{count:"exact"}),{count:a}=await b.supabase.from("prestamos").select("*",{count:"exact"}).or("estado.eq.Prestado,estado.eq.Reservado"),{count:n}=await b.supabase.from("historial_mantenimiento").select("*",{count:"exact"}).is("horadevolucion",null);o({usuarios:e||0,equipos:t||0,prestamos:a||0,mantenimientos:n||0}),r(!1)}catch(e){console.error("Error fetching stats:",e),r(!1)}})()}),[]),a?(0,w.jsxs)(g.default,{style:I.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:I.loadingText,children:"Cargando estad\xedsticas..."})]}):(0,w.jsx)(g.default,{style:I.safeArea,children:(0,w.jsxs)(d.default,{style:I.container,children:[(0,w.jsxs)(d.default,{style:I.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:I.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:I.headerTitle,children:"Panel de Administraci\xf3n"})]}),(0,w.jsx)(m.default,{contentContainerStyle:I.scrollContent,showsVerticalScrollIndicator:!1,children:(0,w.jsxs)(d.default,{style:I.content,children:[(0,w.jsxs)(d.default,{style:I.statsContainer,children:[(0,w.jsxs)(d.default,{style:I.statCard,children:[(0,w.jsx)(d.default,{style:[I.statIconContainer,{backgroundColor:"#e3f2fd"}],children:(0,w.jsx)(z.default,{name:"account-group",size:24,color:"#1976d2"})}),(0,w.jsx)(c.default,{style:I.statTitle,children:"Usuarios"}),(0,w.jsx)(c.default,{style:I.statValue,children:t.usuarios}),(0,w.jsx)(c.default,{style:I.statSubtitle,children:"Registrados"})]}),(0,w.jsxs)(d.default,{style:I.statCard,children:[(0,w.jsx)(d.default,{style:[I.statIconContainer,{backgroundColor:"#e8f5e9"}],children:(0,w.jsx)(z.default,{name:"desktop-classic",size:24,color:"#388e3c"})}),(0,w.jsx)(c.default,{style:I.statTitle,children:"Equipos"}),(0,w.jsx)(c.default,{style:I.statValue,children:t.equipos}),(0,w.jsx)(c.default,{style:I.statSubtitle,children:"Disponibles"})]}),(0,w.jsxs)(d.default,{style:I.statCard,children:[(0,w.jsx)(d.default,{style:[I.statIconContainer,{backgroundColor:"#fff8e1"}],children:(0,w.jsx)(z.default,{name:"book-clock",size:24,color:"#ffa000"})}),(0,w.jsx)(c.default,{style:I.statTitle,children:"Pr\xe9stamos"}),(0,w.jsx)(c.default,{style:I.statValue,children:t.prestamos}),(0,w.jsx)(c.default,{style:I.statSubtitle,children:"Activos"})]}),(0,w.jsxs)(d.default,{style:I.statCard,children:[(0,w.jsx)(d.default,{style:[I.statIconContainer,{backgroundColor:"#ffebee"}],children:(0,w.jsx)(z.default,{name:"toolbox",size:24,color:"#d32f2f"})}),(0,w.jsx)(c.default,{style:I.statTitle,children:"Mantenimientos"}),(0,w.jsx)(c.default,{style:I.statValue,children:t.mantenimientos}),(0,w.jsx)(c.default,{style:I.statSubtitle,children:"Pendientes"})]})]}),(0,w.jsxs)(d.default,{style:I.section,children:[(0,w.jsx)(c.default,{style:I.sectionTitle,children:"Acciones R\xe1pidas"}),(0,w.jsxs)(d.default,{style:I.quickActions,children:[(0,w.jsxs)(h.default,{style:I.quickAction,onPress:()=>e.navigate("AgregarUsuarios"),activeOpacity:.7,children:[(0,w.jsx)(d.default,{style:I.quickActionIcon,children:(0,w.jsx)(B.default,{name:"person-add",size:20,color:"#1976d2"})}),(0,w.jsxs)(d.default,{children:[(0,w.jsx)(c.default,{style:I.quickActionText,children:"Agregar Usuario"}),(0,w.jsx)(c.default,{style:I.quickActionSubtext,children:"Registrar nuevo usuario"})]})]}),(0,w.jsxs)(h.default,{style:I.quickAction,onPress:()=>e.navigate("AgregarEquipos"),activeOpacity:.7,children:[(0,w.jsx)(d.default,{style:I.quickActionIcon,children:(0,w.jsx)(B.default,{name:"add-box",size:20,color:"#1976d2"})}),(0,w.jsxs)(d.default,{children:[(0,w.jsx)(c.default,{style:I.quickActionText,children:"Agregar Equipo"}),(0,w.jsx)(c.default,{style:I.quickActionSubtext,children:"Nuevo equipo al inventario"})]})]})]})]})]})})]})})};var E=o(8725),P=o(8202),D=o(7137),O=o(9371),F=o(400),W=o(6233),A=o(7689),L=o(6563),N=o(4e3);const{width:H,height:V}=x.default.get("window"),M=Math.min(.75*H,400),_="#0062cc",$="#333333",U="#666666",G=L.default.isRTL,X=[{title:"Equipos",icon:"devices-other",subItems:[{title:"Solicitar Pr\xe9stamo",icon:"add",route:"SolicitarPrestamo"},{title:"Mis Devoluciones",icon:"assignment-return",route:"DevolucionesUsuarios"}]}],J=u.default.create({overlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:99},container:{flex:1,backgroundColor:"#fff",position:"absolute",top:0,bottom:0,shadowColor:"#000",shadowOffset:{width:2,height:0},shadowOpacity:.2,shadowRadius:8,elevation:20,zIndex:100},profileContainer:{flexDirection:"row",alignItems:"center",padding:20,borderBottomWidth:u.default.hairlineWidth,borderBottomColor:"#e0e0e0"},avatarPlaceholder:{width:50,height:50,borderRadius:25,backgroundColor:_,justifyContent:"center",alignItems:"center",marginRight:15},profileInfo:{flex:1},userName:{fontSize:16,fontWeight:"600",color:$,marginBottom:3},userRole:{fontSize:13,color:_,fontWeight:"500"},menuScroll:{flex:1},menuScrollContent:{paddingBottom:10},menuItems:{paddingVertical:5},menuItemContainer:{overflow:"hidden"},subMenuItemContainer:{backgroundColor:"rgba(0, 98, 204, 0.05)",borderLeftWidth:G?0:2,borderRightWidth:G?2:0,borderLeftColor:G?"transparent":"rgba(0, 98, 204, 0.2)",borderRightColor:G?"rgba(0, 98, 204, 0.2)":"transparent"},menuItem:{flexDirection:"row",alignItems:"center",paddingVertical:void 0,paddingHorizontal:20},subMenuItem:{paddingVertical:void 0,paddingLeft:G?20:15,paddingRight:G?15:20},activeMenuItem:{backgroundColor:"rgba(0, 98, 204, 0.1)"},menuItemText:{flex:1,fontSize:15,fontWeight:"500",color:$,marginLeft:15,textAlign:G?"right":"left"},subMenuItemText:{fontWeight:"400",color:U},activeMenuItemText:{color:_},icon:{width:24,textAlign:"center"},subItemsContainer:{overflow:"hidden"},logoutButton:{flexDirection:"row",alignItems:"center",padding:18,borderTopWidth:u.default.hairlineWidth,borderTopColor:"#e0e0e0"},logoutText:{fontSize:15,fontWeight:"500",color:"#e53935",marginLeft:10}}),Q=({navigation:e,onClose:t})=>{const o=(0,N.useSafeAreaInsets)(),[a,r]=(0,n.useState)(null),i=(0,n.useRef)(0),l=(0,n.useRef)(null),[s]=(0,n.useState)((()=>{const e={};return X.forEach((t=>{t.subItems&&(e[t.title]=new W.default.Value(0))})),e}));(0,n.useEffect)((()=>{const t=A.default.addEventListener("hardwareBackPress",(()=>!!e.isFocused()&&(0===i.current?(i.current+=1,p.default.alert("Salir","Presiona nuevamente para salir de la aplicaci\xf3n",[{text:"Cancelar",onPress:()=>i.current=0,style:"cancel"}],{cancelable:!0}),setTimeout((()=>i.current=0),2e3),!0):(A.default.exitApp(),!0))));return()=>t.remove()}),[e]),(0,n.useEffect)((()=>{X.forEach((e=>{e.subItems&&W.default.timing(s[e.title],{toValue:a===e.title?1:0,duration:250,useNativeDriver:!1}).start()}))}),[a]);const u=(o,n=0)=>{const i=o.subItems&&o.subItems.length>0,l=a===o.title,f=i?s[o.title]?.interpolate({inputRange:[0,1],outputRange:[0,46*o.subItems.length]}):0;return(0,w.jsxs)(d.default,{style:[J.menuItemContainer,n>0&&J.subMenuItemContainer,n>0&&{marginLeft:G?0:20,marginRight:G?20:0}],children:[(0,w.jsxs)(h.default,{style:[J.menuItem,n>0&&J.subMenuItem,l&&!n&&J.activeMenuItem],onPress:()=>{return i?(a=o.title,void r((e=>e===a?null:a))):(o=>{if(!o)return;(e.getState()?.routeNames||[]).includes(o)?(e.navigate(o),t&&t()):p.default.alert("Ruta no disponible",`La pantalla "${o}" no est\xe1 configurada`)})(o.route);var a},activeOpacity:.7,children:[(0,w.jsx)(B.default,{name:o.icon,size:22,color:n>0||l?_:$,style:[J.icon,G&&{transform:[{scaleX:-1}]}]}),(0,w.jsx)(c.default,{style:[J.menuItemText,n>0&&J.subMenuItemText,l&&!n&&J.activeMenuItemText],children:o.title}),i&&(0,w.jsx)(B.default,{name:l?"expand-less":"expand-more",size:22,color:l?_:U,style:G&&{transform:[{scaleX:-1}]}})]}),i&&(0,w.jsx)(W.default.View,{style:[J.subItemsContainer,{height:f}],children:o.subItems.map((e=>u(e,n+1)))})]},`${o.title}-${n}`)};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(h.default,{style:J.overlay,activeOpacity:1,onPress:t}),(0,w.jsxs)(d.default,{ref:l,style:[J.container,{width:M,paddingTop:o.top,paddingBottom:o.bottom,[G?"right":"left"]:0}],onStartShouldSetResponder:()=>!0,children:[(0,w.jsxs)(d.default,{style:J.profileContainer,children:[(0,w.jsx)(d.default,{style:J.avatarPlaceholder,children:(0,w.jsx)(B.default,{name:"person",size:24,color:"#fff"})}),(0,w.jsxs)(d.default,{style:J.profileInfo,children:[(0,w.jsx)(c.default,{style:J.userName,numberOfLines:1,children:"Usuario"}),(0,w.jsx)(c.default,{style:J.userRole,children:"Usuario"})]})]}),(0,w.jsx)(m.default,{style:J.menuScroll,showsVerticalScrollIndicator:!1,contentContainerStyle:J.menuScrollContent,keyboardShouldPersistTaps:"handled",children:(0,w.jsx)(d.default,{style:J.menuItems,children:X.map((e=>u(e)))})}),(0,w.jsxs)(h.default,{style:J.logoutButton,onPress:()=>{p.default.alert("Salir de la aplicaci\xf3n","\xbfEst\xe1s seguro que quieres salir de la aplicaci\xf3n?",[{text:"Cancelar",style:"cancel"},{text:"Salir",onPress:()=>A.default.exitApp()}],{cancelable:!1})},activeOpacity:.8,children:[(0,w.jsx)(B.default,{name:"exit-to-app",size:20,color:"#e53935"}),(0,w.jsx)(c.default,{style:J.logoutText,children:"Salir de la aplicaci\xf3n"})]})]})]})};var Y=o(8076),Z=o(9688),K=o(4979);const ee=u.default.create({container:{flex:1,backgroundColor:"black"},permissionContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.7)",padding:20},loadingText:{color:"white",marginTop:20,fontSize:16},permissionText:{color:"white",fontSize:20,fontWeight:"bold",marginTop:20,textAlign:"center"},permissionHint:{color:"white",fontSize:16,marginTop:10,textAlign:"center",paddingHorizontal:30},button:{backgroundColor:"#4a6da7",padding:15,borderRadius:10,marginTop:30,width:"80%",alignItems:"center"},buttonText:{color:"white",fontSize:16,fontWeight:"bold"},cancelButton:{padding:15,marginTop:15,width:"80%",alignItems:"center"},cancelButtonText:{color:"white",fontSize:16},overlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},frame:{width:250,height:250,position:"relative",marginBottom:30},cornerTopLeft:{position:"absolute",top:0,left:0,width:50,height:50,borderLeftWidth:4,borderTopWidth:4,borderColor:"white"},cornerTopRight:{position:"absolute",top:0,right:0,width:50,height:50,borderRightWidth:4,borderTopWidth:4,borderColor:"white"},cornerBottomLeft:{position:"absolute",bottom:0,left:0,width:50,height:50,borderLeftWidth:4,borderBottomWidth:4,borderColor:"white"},cornerBottomRight:{position:"absolute",bottom:0,right:0,width:50,height:50,borderRightWidth:4,borderBottomWidth:4,borderColor:"white"},scanText:{color:"white",fontSize:16,marginTop:20},closeButton:{position:"absolute",top:30,right:20,backgroundColor:"rgba(0,0,0,0.5)",borderRadius:20,padding:10},flipButton:{position:"absolute",top:30,left:20,backgroundColor:"rgba(0,0,0,0.5)",borderRadius:20,padding:10}}),te=({visible:e,onClose:t,onScan:o})=>{const[a,r]=(0,n.useState)(null),[i,l]=(0,n.useState)(!1),[s,m]=(0,n.useState)(!1),[p,x]=(0,n.useState)("back");(0,n.useEffect)((()=>{let t=!0;return e?(async()=>{try{const{status:e}=await Z.Camera.getCameraPermissionsAsync();if("granted"!==e){const{status:e}=await Z.Camera.requestCameraPermissionsAsync();t&&r("granted"===e)}else t&&r(!0)}catch(e){console.error("Error al solicitar permisos:",e),t&&r(!1)}})():l(!1),()=>{t=!1}}),[e]);const b=async()=>{await Y.default.openSettings(),t()};return e?null===a?(0,w.jsx)(E.default,{transparent:!0,visible:!0,onRequestClose:t,children:(0,w.jsxs)(d.default,{style:ee.permissionContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:ee.loadingText,children:"Solicitando permiso para la c\xe1mara..."})]})}):!1===a?(0,w.jsx)(E.default,{transparent:!0,visible:!0,onRequestClose:t,children:(0,w.jsxs)(d.default,{style:ee.permissionContainer,children:[(0,w.jsx)(j.default,{name:"no-photography",size:50,color:"#dc3545"}),(0,w.jsx)(c.default,{style:ee.permissionText,children:"Acceso a la c\xe1mara denegado"}),(0,w.jsx)(c.default,{style:ee.permissionHint,children:"Por favor habilita los permisos de c\xe1mara en la configuraci\xf3n de tu dispositivo"}),(0,w.jsx)(h.default,{style:ee.button,onPress:b,children:(0,w.jsx)(c.default,{style:ee.buttonText,children:"Abrir Configuraci\xf3n"})}),(0,w.jsx)(h.default,{style:ee.cancelButton,onPress:t,children:(0,w.jsx)(c.default,{style:ee.cancelButtonText,children:"Cancelar"})})]})}):(0,w.jsx)(E.default,{animationType:"slide",transparent:!1,visible:e,onRequestClose:t,statusBarTranslucent:!0,children:(0,w.jsxs)(g.default,{style:ee.container,children:[(0,w.jsx)(K.default,{style:u.default.absoluteFillObject,facing:p,onBarcodeScanned:i?void 0:({data:e})=>{if(s&&!i&&e)try{let a=e;if(e.startsWith("equipos://detalles/")&&(a=e.split("/").pop()),!/^\d+$/.test(a))throw new Error("Formato de ID inv\xe1lido");l(!0),o(a),t()}catch(a){console.error("Error al procesar c\xf3digo QR:",a),Alert.alert("Error","El c\xf3digo QR escaneado no es v\xe1lido"),l(!1)}},onCameraReady:()=>m(!0),barcodeScannerSettings:{barcodeTypes:["qr"]},children:(0,w.jsxs)(d.default,{style:ee.overlay,children:[(0,w.jsxs)(d.default,{style:ee.frame,children:[(0,w.jsx)(d.default,{style:ee.cornerTopLeft}),(0,w.jsx)(d.default,{style:ee.cornerTopRight}),(0,w.jsx)(d.default,{style:ee.cornerBottomLeft}),(0,w.jsx)(d.default,{style:ee.cornerBottomRight})]}),(0,w.jsx)(c.default,{style:ee.scanText,children:"Escanea el c\xf3digo QR del equipo"})]})}),(0,w.jsx)(h.default,{style:ee.closeButton,onPress:t,children:(0,w.jsx)(j.default,{name:"close",size:30,color:"white"})}),(0,w.jsx)(h.default,{style:ee.flipButton,onPress:()=>{x((e=>"back"===e?"front":"back"))},children:(0,w.jsx)(j.default,{name:"flip-camera-ios",size:30,color:"white"})})]})}):null},oe=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa"},contentWithMenuOpen:{opacity:.8,transform:[{scale:.95}]},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,backgroundColor:"white",borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3,zIndex:1},menuButton:{padding:8},headerTitle:{fontSize:20,fontWeight:"600",color:"#343a40"},scanButton:{padding:8},sectionTitle:{fontSize:16,fontWeight:"600",color:"#4a6da7",marginBottom:10,paddingHorizontal:15},listContainer:{padding:15,flexGrow:1},card:{backgroundColor:"white",borderRadius:10,padding:20,marginBottom:15,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:2},cardHeader:{flexDirection:"row",alignItems:"center",marginBottom:10},cardTitle:{fontSize:18,fontWeight:"600",color:"#495057",marginLeft:10},cardDescription:{fontSize:14,color:"#6c757d",marginBottom:15},cardFooter:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderTopWidth:1,borderTopColor:"#e9ecef",paddingTop:15},disponibleText:{fontSize:14,color:"#28a745",fontWeight:"500"},modalContainer:{flex:1,backgroundColor:"white",paddingHorizontal:15,paddingTop:20},modalHeader:{marginBottom:20,paddingBottom:10,borderBottomWidth:1,borderBottomColor:"#e9ecef"},modalTitle:{fontSize:22,fontWeight:"600",color:"#343a40"},modalSubtitle:{fontSize:16,color:"#6c757d",marginTop:5},listItem:{padding:15,borderBottomWidth:1,borderBottomColor:"#e9ecef",flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"white"},itemSelected:{backgroundColor:"#f0f7ff",borderLeftWidth:4,borderLeftColor:"#4a6da7"},itemPreselected:{backgroundColor:"#e6f3ff",borderLeftWidth:4,borderLeftColor:"#8ab6f9"},itemDisabled:{opacity:.6},listItemText:{fontSize:16,color:"#495057",fontWeight:"500"},selectedText:{fontWeight:"bold",color:"#2c5282"},listItemSubText:{fontSize:14,color:"#6c757d",marginTop:3},listItemTitle:{fontSize:18,fontWeight:"600",color:"#343a40",marginBottom:5},label:{color:"#6c757d",fontWeight:"normal"},equipoInfo:{flex:1},statusBadge:{paddingHorizontal:10,paddingVertical:5,borderRadius:15,alignSelf:"flex-start"},statusText:{fontSize:12,fontWeight:"bold"},searchInput:{height:50,borderColor:"#ced4da",borderWidth:1,borderRadius:8,paddingHorizontal:15,marginBottom:15,fontSize:16,color:"#495057",backgroundColor:"white"},cancelButton:{backgroundColor:"#e9ecef",padding:15,borderRadius:8,alignItems:"center",marginVertical:15},cancelButtonText:{color:"#495057",fontSize:16,fontWeight:"500"},confirmationContainer:{paddingVertical:15,borderTopWidth:1,borderTopColor:"#e2e8f0"},confirmButton:{backgroundColor:"#4299e1",padding:15,borderRadius:8,alignItems:"center"},buttonDisabled:{backgroundColor:"#a0aec0"},confirmButtonText:{color:"white",fontWeight:"bold",fontSize:16},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},emptyText:{fontSize:16,color:"#6c757d",marginTop:15,textAlign:"center"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:16,color:"#6c757d"},loadingOverlay:Object.assign({},u.default.absoluteFillObject,{backgroundColor:"rgba(255, 255, 255, 0.9)",justifyContent:"center",alignItems:"center",zIndex:10})}),ae=({navigation:e})=>{const[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[i,l]=(0,n.useState)([]),[s,u]=(0,n.useState)(!0),[x,y]=(0,n.useState)(!1),[C,v]=(0,n.useState)(!1),[S,T]=(0,n.useState)(!1),[B,z]=(0,n.useState)(!1),[q,k]=(0,n.useState)(""),[I,R]=(0,n.useState)(null),[W,A]=(0,n.useState)(null),[L,N]=(0,n.useState)(null),[H,V]=(0,n.useState)(null),[M,_]=(0,n.useState)(null);(0,n.useEffect)((()=>e.addListener("focus",(async()=>{try{u(!0);const{data:e,error:t}=await b.supabase.from("categoriasequipos").select("*").eq("estado","activo").order("nombrecategoria",{ascending:!0});if(t)throw t;o(e||[]);const{data:a,error:r}=await b.supabase.from("personal").select("idpersonal, nombre_completo, tipo_persona, estado").eq("estado","activo").order("nombre_completo",{ascending:!0});if(r)throw r;l(a||[])}catch(e){console.error("Error cargando datos:",e),p.default.alert("Error","No se pudieron cargar los datos iniciales")}finally{u(!1)}}))),[e]);const $=e=>{e&&(A(e),V(null),y(!1),_(null),v(!0))},U=e=>{e&&(N(e),_(null),v(!1),G())},G=()=>{W&&L?p.default.alert("Confirmar pr\xe9stamo",`\xbfDesea registrar el pr\xe9stamo de:\n\nEquipo: ${W.nombreequipo}\nA: ${L.nombre_completo}?`,[{text:"Cancelar",style:"cancel"},{text:"Confirmar",onPress:X}]):p.default.alert("Error","Debe seleccionar tanto el equipo como el personal")},X=async()=>{if(W&&L){u(!0);try{const{data:e,error:t}=await b.supabase.from("equipos").select("estado").eq("idequipo",W.idequipo).single();if(t||!e)throw new Error("No se pudo verificar el estado del equipo");if("disponible"!==e.estado)throw new Error(`El equipo no est\xe1 disponible (Estado actual: ${e.estado})`);const{data:o,error:a}=await b.supabase.from("prestamos").insert({idpersonal:L.idpersonal,idequipo:W.idequipo,estado:"Prestado",fechaprestamo:(new Date).toISOString(),fechadevolucion_prevista:new Date(Date.now()+6048e5).toISOString()}).select("*").single();if(a||!o)throw a||new Error("No se pudo crear el pr\xe9stamo");const{error:r}=await b.supabase.from("equipos").update({estado:"prestado",fechaactualizacion:(new Date).toISOString()}).eq("idequipo",W.idequipo);if(r)throw r;const{error:n}=await b.supabase.from("historial_prestamos").insert({idprestamo:o.idprestamo,idpersonal:L.idpersonal,accion:"Pr\xe9stamo",fechaaccion:(new Date).toISOString(),detalles:`Pr\xe9stamo del equipo ${W.nombreequipo} a ${L.nombre_completo}`});if(n)throw n;p.default.alert("\xc9xito",`Pr\xe9stamo registrado:\n\nEquipo: ${W.nombreequipo}\nPersona: ${L.nombre_completo}`,[{text:"OK",onPress:J}])}catch(e){console.error("Error registrando pr\xe9stamo:",e),p.default.alert("Error",e.message||"No se pudo registrar el pr\xe9stamo")}finally{u(!1)}}},J=()=>{A(null),N(null),R(null),k(""),V(null),_(null)},Y=i.filter((e=>e.nombre_completo.toLowerCase().includes(q.toLowerCase())));return(0,w.jsxs)(g.default,{style:oe.safeArea,children:[(0,w.jsx)(O.default,{barStyle:"dark-content",backgroundColor:"#f8f9fa"}),B&&(0,w.jsx)(Q,{navigation:e,onClose:()=>z(!1)}),(0,w.jsxs)(d.default,{style:[oe.container,B&&oe.contentWithMenuOpen],children:[(0,w.jsxs)(d.default,{style:oe.header,children:[(0,w.jsx)(h.default,{onPress:()=>z(!0),style:oe.menuButton,activeOpacity:.7,children:(0,w.jsx)(j.default,{name:"menu",size:28,color:"#4a6da7"})}),(0,w.jsx)(c.default,{style:oe.headerTitle,children:"Pr\xe9stamos Directos"}),(0,w.jsx)(h.default,{onPress:()=>T(!0),style:oe.scanButton,disabled:s,activeOpacity:.7,children:(0,w.jsx)(j.default,{name:"qr-code-scanner",size:28,color:s?"#adb5bd":"#4a6da7"})})]}),(0,w.jsx)(m.default,{contentContainerStyle:oe.listContainer,children:s&&0===t.length?(0,w.jsxs)(d.default,{style:oe.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:oe.loadingText,children:"Cargando datos..."})]}):0===t.length?(0,w.jsxs)(d.default,{style:oe.emptyContainer,children:[(0,w.jsx)(j.default,{name:"error-outline",size:50,color:"#6c757d"}),(0,w.jsx)(c.default,{style:oe.emptyText,children:"No hay categor\xedas disponibles"})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.default,{style:oe.sectionTitle,children:"Seleccione una categor\xeda:"}),(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsxs)(h.default,{style:oe.card,onPress:()=>(async e=>{try{u(!0),V(null);const{data:t,error:o}=await b.supabase.from("equipos").select("\n          idequipo, \n          nombreequipo, \n          estado, \n          idcategoria, \n          descripcion,\n          categoriasequipos(nombrecategoria)\n        ").eq("idcategoria",e.idcategoria).order("nombreequipo",{ascending:!0});if(o)throw o;if(!t||0===t.length)return void p.default.alert("Sin equipos",`No hay equipos registrados en la categor\xeda "${e.nombrecategoria}"`);r(t),R(e),y(!0)}catch(t){console.error("Error:",t),p.default.alert("Error","Fall\xf3 al cargar equipos")}finally{u(!1)}})(e),disabled:s,activeOpacity:.7,children:[(0,w.jsxs)(d.default,{style:oe.cardHeader,children:[(0,w.jsx)(j.default,{name:"category",size:24,color:"activo"===e.estado?"#4a6da7":"#6c757d"}),(0,w.jsx)(c.default,{style:oe.cardTitle,children:e.nombrecategoria})]}),(0,w.jsx)(c.default,{style:oe.cardDescription,children:e.descripcion}),(0,w.jsxs)(d.default,{style:oe.cardFooter,children:[(0,w.jsx)(c.default,{style:oe.disponibleText,children:"activo"===e.estado?"Categor\xeda activa":"Categor\xeda inactiva"}),(0,w.jsx)(F.default,{name:"chevron-right",size:16,color:"#4a6da7"})]})]}),keyExtractor:e=>e.idcategoria.toString(),scrollEnabled:!1})]})}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!1,visible:x,onRequestClose:()=>{V(null),y(!1)},children:(0,w.jsxs)(d.default,{style:oe.modalContainer,children:[(0,w.jsxs)(d.default,{style:oe.modalHeader,children:[(0,w.jsx)(c.default,{style:oe.modalTitle,children:"Seleccionar equipo"}),(0,w.jsx)(c.default,{style:oe.modalSubtitle,children:I?.nombrecategoria||"Categor\xeda no especificada"})]}),s?(0,w.jsxs)(d.default,{style:oe.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:oe.loadingText,children:"Buscando equipos..."})]}):0===a.length?(0,w.jsxs)(d.default,{style:oe.emptyContainer,children:[(0,w.jsx)(j.default,{name:"error-outline",size:50,color:"#6c757d"}),(0,w.jsx)(c.default,{style:oe.emptyText,children:"No hay equipos disponibles en esta categor\xeda"})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(P.default,{data:a,renderItem:({item:e})=>(0,w.jsxs)(h.default,{style:[oe.listItem,"disponible"!==e.estado&&oe.itemDisabled,H?.idequipo===e.idequipo&&oe.itemPreselected],onPress:()=>{"disponible"===e.estado&&V(e)},onLongPress:()=>{"disponible"===e.estado&&$(e)},disabled:"disponible"!==e.estado,activeOpacity:.7,children:[(0,w.jsxs)(d.default,{style:oe.equipoInfo,children:[(0,w.jsx)(c.default,{style:[oe.listItemTitle,H?.idequipo===e.idequipo&&oe.selectedText],children:e.nombreequipo}),(0,w.jsxs)(c.default,{style:oe.listItemText,children:[(0,w.jsx)(c.default,{style:oe.label,children:"Categor\xeda: "}),e.categoriasequipos?.nombrecategoria||"General"]}),e.descripcion&&(0,w.jsx)(c.default,{style:oe.listItemText,children:e.descripcion})]}),(0,w.jsx)(d.default,{style:[oe.statusBadge,{backgroundColor:"disponible"===e.estado?"#e6f7ee":"#fff0f0"}],children:(0,w.jsx)(c.default,{style:[oe.statusText,{color:"disponible"===e.estado?"#28a745":"#dc3545"}],children:e.estado.toUpperCase()})})]}),keyExtractor:e=>e.idequipo.toString(),contentContainerStyle:{paddingBottom:15}}),(0,w.jsx)(d.default,{style:oe.confirmationContainer,children:(0,w.jsx)(h.default,{style:[oe.confirmButton,!H&&oe.buttonDisabled],onPress:()=>H&&$(H),disabled:!H,activeOpacity:.7,children:(0,w.jsx)(c.default,{style:oe.confirmButtonText,children:H?`Confirmar ${H.nombreequipo}`:"Seleccione un equipo"})})})]}),(0,w.jsx)(h.default,{style:oe.cancelButton,onPress:()=>{V(null),y(!1)},activeOpacity:.7,children:(0,w.jsx)(c.default,{style:oe.cancelButtonText,children:"Volver a categor\xedas"})})]})}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!1,visible:C,onRequestClose:()=>{_(null),v(!1)},children:(0,w.jsxs)(d.default,{style:oe.modalContainer,children:[(0,w.jsxs)(d.default,{style:oe.modalHeader,children:[(0,w.jsx)(c.default,{style:oe.modalTitle,children:"Asignar a persona"}),(0,w.jsx)(c.default,{style:oe.modalSubtitle,children:"Seleccione el beneficiario"}),W&&(0,w.jsxs)(c.default,{style:oe.modalSubtitle,children:["Equipo: ",W.nombreequipo]})]}),(0,w.jsx)(D.default,{style:oe.searchInput,placeholder:"Buscar personal...",placeholderTextColor:"#6c757d",value:q,onChangeText:k}),s?(0,w.jsxs)(d.default,{style:oe.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:oe.loadingText,children:"Cargando personal..."})]}):0===Y.length?(0,w.jsxs)(d.default,{style:oe.emptyContainer,children:[(0,w.jsx)(j.default,{name:"person-off",size:50,color:"#6c757d"}),(0,w.jsx)(c.default,{style:oe.emptyText,children:q?"No se encontraron coincidencias":"No hay personal disponible"})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(P.default,{data:Y,renderItem:({item:e})=>(0,w.jsxs)(h.default,{style:[oe.listItem,M?.idpersonal===e.idpersonal&&oe.itemPreselected,L?.idpersonal===e.idpersonal&&oe.itemSelected,"inactivo"===e.estado&&oe.itemDisabled],onPress:()=>{"activo"===e.estado&&_(e)},onLongPress:()=>{"activo"===e.estado&&U(e)},disabled:"inactivo"===e.estado,activeOpacity:.7,children:[(0,w.jsxs)(d.default,{children:[(0,w.jsx)(c.default,{style:[oe.listItemText,(M?.idpersonal===e.idpersonal||L?.idpersonal===e.idpersonal)&&oe.selectedText],children:e.nombre_completo}),(0,w.jsx)(c.default,{style:oe.listItemSubText,children:e.tipo_persona})]}),(0,w.jsx)(j.default,{name:"person",size:24,color:"inactivo"===e.estado?"#ced4da":M?.idpersonal===e.idpersonal||L?.idpersonal===e.idpersonal?"#4a6da7":"#adb5bd"})]}),keyExtractor:e=>e.idpersonal.toString(),contentContainerStyle:{paddingBottom:15}}),(0,w.jsx)(d.default,{style:oe.confirmationContainer,children:(0,w.jsx)(h.default,{style:[oe.confirmButton,!M&&oe.buttonDisabled],onPress:()=>M&&U(M),disabled:!M,activeOpacity:.7,children:(0,w.jsx)(c.default,{style:oe.confirmButtonText,children:M?`Confirmar ${M.nombre_completo}`:"Seleccione una persona"})})})]}),(0,w.jsx)(h.default,{style:oe.cancelButton,onPress:()=>{_(null),v(!1)},activeOpacity:.7,children:(0,w.jsx)(c.default,{style:oe.cancelButtonText,children:"Cancelar pr\xe9stamo"})})]})}),(0,w.jsx)(te,{visible:S,onClose:()=>T(!1),onScan:async t=>{try{u(!0),T(!1);const o=t.split("/").pop(),{data:a,error:r}=await b.supabase.from("equipos").select("*, categoriasequipos(*)").eq("idequipo",o).single();if(r||!a)throw r||new Error("Equipo no encontrado");e.navigate("DetallesEquipo",{equipoId:a.idequipo,equipo:a,categoria:a.categoriasequipos})}catch(o){console.error("Error al buscar equipo:",o),p.default.alert("Error","No se pudo encontrar el equipo escaneado")}finally{u(!1)}}}),s&&(0,w.jsxs)(d.default,{style:oe.loadingOverlay,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:oe.loadingText,children:"Procesando..."})]})]})]})};var re=o(9772);const{width:ne}=x.default.get("window"),ie="#0062cc",le="#333333",se="#666666",de=[{title:"Inicio",icon:"home",route:"PrincipalAdmin"},{title:"Gesti\xf3n de Equipos",icon:"inventory",subItems:[{title:"Pr\xe9stamos",icon:"assignment",route:"Prestamos"},{title:"Reporte de pr\xe9stamos",icon:"history",route:"HistorialPrestamos"},{title:"Devoluciones",icon:"keyboard-return",route:"Devoluciones"}]},{title:"Mantenimiento",icon:"build",subItems:[{title:"Registrar mantenimiento",icon:"add-task",route:"AgregarMantenimiento"},{title:"Devolver del mantenimiento",icon:"refresh",route:"DevolverMantenimiento"},{title:"Reporte de mantenimiento",icon:"description",route:"ReporteMantenimiento"}]},{title:"Usuarios",icon:"people",subItems:[{title:"Agregar admin",icon:"person-add-alt",route:"AgregarAdmin"},{title:"Agregar usuarios",icon:"person-add",route:"AgregarUsuarios"},{title:"Modificar usuarios",icon:"edit",route:"ModificarUsuarios"},{title:"Ver usuarios",icon:"list",route:"VerUsuarios"}]},{title:"Control de Equipos",icon:"devices-other",subItems:[{title:"Agregar Equipos",icon:"add",route:"AgregarEquipos"},{title:"Modificar Equipos",icon:"edit",route:"ModificarEquipos"},{title:"Ver Equipos",icon:"search",route:"VerEquipos"}]},{title:"Categor\xedas",icon:"category",subItems:[{title:"Agregar Categor\xedas",icon:"settings",route:"AgregarCategorias"},{title:"Ver categor\xedas",icon:"visibility",route:"VerCategorias"}]},{title:"Extras",icon:"extension",subItems:[{title:"Sanciones",icon:"warning",route:"Sanciones"},{title:"Manual Administrador",icon:"menu-book",route:"Manual"}]}],ce=u.default.create({container:{flex:1,backgroundColor:"#fff",width:"100%"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},loadingText:{marginTop:15,color:se,fontSize:16},profileContainer:Object.assign({flexDirection:"row",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:"#e0e0e0",backgroundColor:"#fff"},void 0),avatarImage:{width:50,height:50,borderRadius:25,marginRight:15,backgroundColor:"#f0f0f0"},avatarPlaceholder:{width:50,height:50,borderRadius:25,backgroundColor:ie,justifyContent:"center",alignItems:"center",marginRight:15},profileInfo:{flex:1},userName:Object.assign({fontSize:16,fontWeight:"600",color:le,marginBottom:3},void 0),userRole:Object.assign({fontSize:13,color:ie,fontWeight:"500"},void 0),menuScroll:{flex:1},menuScrollContent:{paddingBottom:10},menuItems:{paddingVertical:5},menuItemContainer:{overflow:"hidden"},subMenuItemContainer:{backgroundColor:"rgba(0, 98, 204, 0.05)",marginLeft:20,borderLeftWidth:2,borderLeftColor:"rgba(0, 98, 204, 0.2)"},menuItem:{flexDirection:"row",alignItems:"center",paddingVertical:12,paddingHorizontal:20},androidMenuItem:{paddingVertical:10},subMenuItem:{paddingVertical:10,paddingLeft:15},activeMenuItem:{backgroundColor:"rgba(0, 98, 204, 0.1)"},menuItemText:Object.assign({flex:1,fontSize:15,fontWeight:"500",color:le,marginLeft:15},void 0),androidText:{fontSize:14},subMenuItemText:{fontWeight:"400",color:se},activeMenuItemText:{color:ie},icon:{width:24,textAlign:"center"},subItemsContainer:{overflow:"hidden"},logoutButton:Object.assign({flexDirection:"row",alignItems:"center",padding:18,borderTopWidth:1,borderTopColor:"#e0e0e0",backgroundColor:"#fff"},void 0),androidLogoutButton:{paddingVertical:15},logoutText:Object.assign({fontSize:15,fontWeight:"500",color:"#e53935",marginLeft:10},void 0)}),ue=({navigation:e})=>{const t=(0,N.useSafeAreaInsets)(),[o,a]=(0,n.useState)(null),[r,i]=(0,n.useState)(null),[l,s]=(0,n.useState)(!0),[u]=(0,n.useState)((()=>{const e={};return de.forEach((t=>{t.subItems&&(e[t.title]=new W.default.Value(0))})),e}));(0,n.useEffect)((()=>((async()=>{try{const{data:{session:t},error:o}=await b.supabase.auth.getSession();if(o||!t)return void e.reset({index:0,routes:[{name:"Login"}]});const{data:a,error:r}=await b.supabase.from("usuarios").select("nombreusuario, email, rol, fotoperfil").eq("idusuario",t.user.id).single();if(r)throw r;i({name:a?.nombreusuario||t.user.email,email:a?.email||t.user.email,role:a?.rol||"usuario",avatar:a?.fotoperfil||null})}catch(t){p.default.alert("Error","No se pudieron cargar los datos del usuario. Por favor, reinicie la aplicaci\xf3n.")}finally{s(!1)}})(),()=>{console.log("Componente MenuAdmin desmontado")})),[]);(0,n.useEffect)((()=>{de.forEach((e=>{var t,a;e.subItems&&(t=e.title,a=o===e.title?1:0,u[t]&&W.default.timing(u[t],{toValue:a,duration:250,useNativeDriver:!1}).start())}))}),[o]);const g=t=>{if(t)try{(e.getState()?.routeNames||[]).includes(t)?(e.navigate(t),e.closeDrawer()):p.default.alert("Ruta no disponible",`La pantalla "${t}" no est\xe1 configurada en la aplicaci\xf3n.`)}catch(o){console.error("Error al navegar:",o),p.default.alert("Error","Ocurri\xf3 un problema al intentar navegar")}},x=(e,t=0)=>{const r=e.subItems&&e.subItems.length>0,n=o===e.title,i=r?u[e.title]?.interpolate({inputRange:[0,1],outputRange:[0,46*e.subItems.length]}):0;return(0,w.jsxs)(d.default,{style:[ce.menuItemContainer,t>0&&ce.subMenuItemContainer],children:[(0,w.jsxs)(h.default,{style:[ce.menuItem,t>0&&ce.subMenuItem,n&&!t&&ce.activeMenuItem,!1],onPress:()=>{var t;r?(t=e.title,a((e=>e===t?null:t))):g(e.route)},activeOpacity:.7,children:[(0,w.jsx)(B.default,{name:e.icon,size:22,color:t>0||n?ie:le,style:ce.icon}),(0,w.jsx)(c.default,{style:[ce.menuItemText,t>0&&ce.subMenuItemText,n&&!t&&ce.activeMenuItemText,!1],children:e.title}),r&&(0,w.jsx)(B.default,{name:n?"expand-less":"expand-more",size:22,color:n?ie:se})]}),r&&(0,w.jsx)(W.default.View,{style:[ce.subItemsContainer,{height:i}],children:e.subItems.map(((e,o)=>x(e,t+1)))})]},`${e.title}-${t}`)};return l?(0,w.jsxs)(d.default,{style:[ce.loadingContainer,{paddingTop:t.top,paddingBottom:t.bottom}],children:[(0,w.jsx)(f.default,{size:"large",color:ie,style:null}),(0,w.jsx)(c.default,{style:ce.loadingText,children:"Cargando informaci\xf3n..."})]}):(0,w.jsxs)(d.default,{style:[ce.container,{paddingTop:t.top,paddingBottom:t.bottom,paddingLeft:t.left,paddingRight:t.right}],children:[(0,w.jsxs)(h.default,{style:ce.profileContainer,onPress:()=>g("PerfilUsuario"),activeOpacity:.8,children:[r?.avatar?(0,w.jsx)(re.default,{source:{uri:r.avatar},style:ce.avatarImage}):(0,w.jsx)(d.default,{style:ce.avatarPlaceholder,children:(0,w.jsx)(B.default,{name:"person",size:24,color:"#fff"})}),(0,w.jsxs)(d.default,{style:ce.profileInfo,children:[(0,w.jsx)(c.default,{style:ce.userName,numberOfLines:1,children:r?.name||"Usuario"}),(0,w.jsx)(c.default,{style:ce.userRole,children:r?.role?r.role.charAt(0).toUpperCase()+r.role.slice(1):"Administrador"})]}),(0,w.jsx)(B.default,{name:"edit",size:20,color:ie})]}),(0,w.jsx)(m.default,{style:ce.menuScroll,showsVerticalScrollIndicator:!1,contentContainerStyle:ce.menuScrollContent,children:(0,w.jsx)(d.default,{style:ce.menuItems,children:de.map((e=>x(e)))})}),(0,w.jsxs)(h.default,{style:[ce.logoutButton,!1],onPress:async()=>{try{const{error:e}=await b.supabase.auth.signOut();if(e)throw e;window.location.href="/login"}catch(e){p.default.alert("Error","No se pudo cerrar la sesi\xf3n"),console.error("Error al cerrar sesi\xf3n:",e)}},activeOpacity:.8,children:[(0,w.jsx)(B.default,{name:"logout",size:20,color:"#e53935"}),(0,w.jsx)(c.default,{style:ce.logoutText,children:"Cerrar sesi\xf3n"})]})]})};var fe=o(7704),he=o(1695),me=o(2420),ge=o(4948),pe=o(2909),xe=o(18);const{width:be}=x.default.get("window"),ye=be<768,je="#4361ee",we="#4895ef",Ce="#4cc9f0",ve="#f72585",Se="#f8961e",Te="#f8f9fa",Be="#212529",ze="#ffffff",qe="#ffffff",ke="#2b2d42",Ie="#8d99ae",Re="#e9ecef",Ee=u.default.create({container:{flex:1,backgroundColor:Te},header:{flexDirection:"row",alignItems:"center",backgroundColor:ze,paddingVertical:16,paddingHorizontal:ye?20:30,borderBottomWidth:1,borderBottomColor:Re,shadowColor:Be,shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:10,elevation:3,zIndex:10},menuButton:{marginRight:16,padding:8,borderRadius:20,backgroundColor:Te},headerTitle:{fontSize:ye?20:22,fontWeight:"700",color:Be,letterSpacing:.5},content:{flex:1,width:"100%",alignSelf:"center",padding:ye?16:24},tabsContainer:{flexDirection:"row",justifyContent:"space-around",marginBottom:24,backgroundColor:ze,borderRadius:12,padding:6,shadowColor:Be,shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:8,elevation:2},tabButton:{flex:1,alignItems:"center",padding:12,borderRadius:10,flexDirection:"row",justifyContent:"center"},activeTab:{backgroundColor:je+"15"},tabText:{fontSize:16,color:Ie,marginLeft:8,fontWeight:"500"},activeTabText:{color:je,fontWeight:"600"},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:ze,borderRadius:12,paddingHorizontal:20,paddingVertical:8,marginBottom:20,shadowColor:Be,shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:8,elevation:2},searchIcon:{marginRight:12,color:Ie},searchInput:{flex:1,height:48,fontSize:16,color:ke,fontFamily:"Roboto"},listContent:{paddingBottom:20},card:{backgroundColor:qe,borderRadius:16,padding:20,marginBottom:16,shadowColor:Be,shadowOffset:{width:0,height:4},shadowOpacity:.05,shadowRadius:12,elevation:3,borderWidth:1,borderColor:Re},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},cardTitleContainer:{flexDirection:"row",alignItems:"center",flex:1},cardTitle:{fontSize:18,fontWeight:"600",color:ke,marginLeft:12},cardBody:{marginBottom:16},cardRow:{flexDirection:"row",alignItems:"center",marginBottom:12},cardText:{marginLeft:12,color:Ie,fontSize:15,flex:1,lineHeight:22},cardFooter:{flexDirection:"row",justifyContent:"space-between",marginTop:12},actionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:12,paddingHorizontal:16,borderRadius:10,backgroundColor:je,flex:1,marginHorizontal:6,shadowColor:je,shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:2},actionButtonText:{color:ze,marginLeft:8,fontWeight:"500",fontSize:15},reserveButton:{backgroundColor:we,shadowColor:we},deleteButton:{backgroundColor:ve,shadowColor:ve},disabledButton:{opacity:.6},statusBadge:{paddingHorizontal:14,paddingVertical:6,borderRadius:14,alignSelf:"flex-start"},badgeAvailable:{backgroundColor:Ce},badgeReserved:{backgroundColor:Se},badgeUnavailable:{backgroundColor:ve},badgeActive:{backgroundColor:je},badgeReturned:{backgroundColor:Ie},statusText:{color:ze,fontWeight:"600",fontSize:12,textTransform:"uppercase",letterSpacing:.5},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:18,marginTop:20,color:ke,textAlign:"center",fontWeight:"500"},emptySubtext:{fontSize:15,marginTop:10,color:Ie,textAlign:"center",lineHeight:22},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:20,fontSize:16,color:Ie},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.4)"},modalContainer:{width:ye?"90%":"70%",maxWidth:500,backgroundColor:ze,borderRadius:16,padding:24,shadowColor:Be,shadowOffset:{width:0,height:4},shadowOpacity:.1,shadowRadius:20,elevation:5},modalTitle:{fontSize:22,fontWeight:"600",marginBottom:24,color:ke,textAlign:"center"},modalText:{marginBottom:16,fontSize:16,lineHeight:24,color:ke},modalLabel:{fontWeight:"600",color:ke},dateInput:{flexDirection:"row",alignItems:"center",padding:16,borderWidth:1,borderColor:Re,borderRadius:12,marginBottom:16,backgroundColor:ze},timeInput:{flexDirection:"row",alignItems:"center",padding:16,borderWidth:1,borderColor:Re,borderRadius:12,marginBottom:20,backgroundColor:ze},dateInputText:{marginLeft:12,fontSize:16,color:ke},timeInputText:{marginLeft:12,fontSize:16,color:ke},picker:{width:"100%",backgroundColor:ze},modalButtons:{flexDirection:"row",justifyContent:"flex-end",marginTop:24},modalButton:{paddingVertical:14,paddingHorizontal:24,borderRadius:12,marginLeft:16,minWidth:120,alignItems:"center"},cancelButton:{backgroundColor:Te,borderWidth:1,borderColor:Re},confirmButton:{backgroundColor:je,shadowColor:je,shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:2},modalButtonText:{fontWeight:"500",fontSize:16},confirmButtonText:{color:ze}}),Pe=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[l,s]=(0,n.useState)(!0),[u,m]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[y,j]=(0,n.useState)(!1),[C,v]=(0,n.useState)(!1),[S,T]=(0,n.useState)(!1),[q,k]=(0,n.useState)(null),[I,R]=(0,n.useState)(null),[O,F]=(0,n.useState)("devolver"),[W,A]=(0,n.useState)("activos"),[L,N]=(0,n.useState)(new Date),[H,V]=(0,n.useState)(new Date),[M,_]=(0,n.useState)(!1),[$,U]=(0,n.useState)(!1),[G,X]=(0,n.useState)("equipos"),J=async()=>{try{s(!0);let e=b.supabase.from("equipos").select("*").or("estado.eq.disponible,estado.eq.reservado").order("nombreequipo",{ascending:!0});p&&(e=e.ilike("nombreequipo",`%${p}%`));const{data:t,error:a}=await e;if(a)throw a;o(t||[])}catch(e){console.error("Error al cargar equipos:",e),pe.default.show({type:"error",text1:"Error",text2:"No se pudieron cargar los equipos"})}finally{s(!1),m(!1)}},Q=async()=>{try{s(!0);let e=b.supabase.from("prestamos").select("\n          idprestamo,\n          fechaprestamo,\n          fechareserva,\n          horasreserva,\n          estado,\n          equipos: idequipo (nombreequipo, modelo, numero_serie),\n          usuarios: idusuario (nombreusuario, email),\n          horaprestamo\n        ").or("estado.eq.Prestado,estado.eq.Reservado").order("fechaprestamo",{ascending:!1});p&&(e=e.or(`equipos.nombreequipo.ilike.%${p}%,usuarios.nombreusuario.ilike.%${p}%,equipos.numero_serie.ilike.%${p}%`));const{data:t,error:o}=await e;if(o)throw o;const a=t.map((e=>Object.assign({},e,{fechaCompleta:"Prestado"===e.estado?e.fechaprestamo?`${(0,he.format)((0,me.parseISO)(e.fechaprestamo),"PPP",{locale:ge.es})} a las ${e.horaprestamo}`:"No especificado":e.fechareserva?`${(0,he.format)((0,me.parseISO)(e.fechareserva),"PPP",{locale:ge.es})} a las ${e.horasreserva}`:"No especificado",idequipo:e.equipos?.idequipo})));r(a||[])}catch(e){console.error("Error al cargar pr\xe9stamos:",e),pe.default.show({type:"error",text1:"Error",text2:"No se pudieron cargar los pr\xe9stamos"})}finally{s(!1),m(!1)}};(0,n.useEffect)((()=>{"equipos"===G?J():Q()}),[G,p]);const Y=()=>{m(!0),"equipos"===G?J():Q()},Z=e=>(0,he.format)(e,"HH:mm");return l&&("equipos"===G&&0===t.length||"prestamos"===G&&0===a.length)?(0,w.jsx)(g.default,{style:Ee.container,children:(0,w.jsxs)(d.default,{style:Ee.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:je}),(0,w.jsx)(c.default,{style:Ee.loadingText,children:"Cargando..."})]})}):(0,w.jsxs)(g.default,{style:Ee.container,children:[(0,w.jsxs)(d.default,{style:Ee.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:Ee.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:ke})}),(0,w.jsx)(c.default,{style:Ee.headerTitle,children:"equipos"===G?"Gesti\xf3n de Equipos":"Pr\xe9stamos Activos"})]}),(0,w.jsxs)(d.default,{style:[Ee.content,{maxWidth:1200}],children:[(0,w.jsxs)(d.default,{style:Ee.tabsContainer,children:[(0,w.jsxs)(h.default,{style:[Ee.tabButton,"equipos"===G&&Ee.activeTab],onPress:()=>X("equipos"),children:[(0,w.jsx)(z.default,{name:"devices",size:20,color:"equipos"===G?je:Ie}),(0,w.jsx)(c.default,{style:[Ee.tabText,"equipos"===G&&Ee.activeTabText],children:"Equipos"})]}),(0,w.jsxs)(h.default,{style:[Ee.tabButton,"prestamos"===G&&Ee.activeTab],onPress:()=>X("prestamos"),children:[(0,w.jsx)(z.default,{name:"history",size:20,color:"prestamos"===G?je:Ie}),(0,w.jsx)(c.default,{style:[Ee.tabText,"prestamos"===G&&Ee.activeTabText],children:"Pr\xe9stamos"})]})]}),(0,w.jsxs)(d.default,{style:Ee.searchContainer,children:[(0,w.jsx)(B.default,{name:"search",size:20,color:Ie,style:Ee.searchIcon}),(0,w.jsx)(D.default,{style:Ee.searchInput,placeholder:"Buscar "+("equipos"===G?"equipos...":"pr\xe9stamos..."),value:p,onChangeText:x,placeholderTextColor:Ie})]}),"equipos"===G?(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsxs)(d.default,{style:Ee.card,children:[(0,w.jsxs)(d.default,{style:Ee.cardHeader,children:[(0,w.jsxs)(d.default,{style:Ee.cardTitleContainer,children:[(0,w.jsx)(z.default,{name:"devices",size:24,color:"disponible"===e.estado?Ce:Se}),(0,w.jsx)(c.default,{style:Ee.cardTitle,children:e.nombreequipo})]}),(0,w.jsx)(d.default,{style:[Ee.statusBadge,"disponible"===e.estado?Ee.badgeAvailable:"reservado"===e.estado?Ee.badgeReserved:Ee.badgeUnavailable],children:(0,w.jsx)(c.default,{style:Ee.statusText,children:"disponible"===e.estado?"Disponible":"Reservado"})})]}),(0,w.jsxs)(d.default,{style:Ee.cardBody,children:[e.modelo&&(0,w.jsxs)(d.default,{style:Ee.cardRow,children:[(0,w.jsx)(B.default,{name:"info",size:20,color:Ie}),(0,w.jsxs)(c.default,{style:Ee.cardText,children:["Modelo: ",e.modelo]})]}),e.numero_serie&&(0,w.jsxs)(d.default,{style:Ee.cardRow,children:[(0,w.jsx)(B.default,{name:"tag",size:20,color:Ie}),(0,w.jsxs)(c.default,{style:Ee.cardText,children:["Serie: ",e.numero_serie]})]})]}),(0,w.jsxs)(d.default,{style:Ee.cardFooter,children:[(0,w.jsxs)(h.default,{style:[Ee.actionButton,"disponible"!==e.estado&&Ee.disabledButton],onPress:()=>{k(e),V(new Date),j(!0)},disabled:"disponible"!==e.estado,children:[(0,w.jsx)(B.default,{name:"check-circle",size:20,color:ze}),(0,w.jsx)(c.default,{style:Ee.actionButtonText,children:"Prestar"})]}),(0,w.jsxs)(h.default,{style:[Ee.actionButton,Ee.reserveButton,"disponible"!==e.estado&&Ee.disabledButton],onPress:()=>{k(e),N(new Date),V(new Date),v(!0)},disabled:"disponible"!==e.estado,children:[(0,w.jsx)(B.default,{name:"event-available",size:20,color:ze}),(0,w.jsx)(c.default,{style:Ee.actionButtonText,children:"Reservar"})]})]})]}),keyExtractor:e=>e.idequipo.toString(),refreshControl:(0,w.jsx)(fe.default,{refreshing:u,onRefresh:Y,colors:[je]}),contentContainerStyle:Ee.listContent,ListEmptyComponent:(0,w.jsxs)(d.default,{style:Ee.emptyContainer,children:[(0,w.jsx)(z.default,{name:"devices",size:60,color:Re}),(0,w.jsx)(c.default,{style:Ee.emptyText,children:"No se encontraron equipos"}),(0,w.jsx)(c.default,{style:Ee.emptySubtext,children:p?"Prueba con otros t\xe9rminos de b\xfasqueda":"No hay equipos disponibles en este momento"})]})}):(0,w.jsx)(P.default,{data:a,renderItem:({item:e})=>(0,w.jsxs)(d.default,{style:Ee.card,children:[(0,w.jsxs)(d.default,{style:Ee.cardHeader,children:[(0,w.jsxs)(d.default,{style:Ee.cardTitleContainer,children:[(0,w.jsx)(z.default,{name:"Prestado"===e.estado?"devices":"calendar-clock",size:24,color:"Prestado"===e.estado?je:Se}),(0,w.jsx)(c.default,{style:Ee.cardTitle,children:e.equipos?.nombreequipo||"Equipo desconocido"})]}),(0,w.jsx)(d.default,{style:[Ee.statusBadge,"Prestado"===e.estado?Ee.badgeActive:Ee.badgeReserved],children:(0,w.jsx)(c.default,{style:Ee.statusText,children:e.estado})})]}),(0,w.jsxs)(d.default,{style:Ee.cardBody,children:[(0,w.jsxs)(d.default,{style:Ee.cardRow,children:[(0,w.jsx)(B.default,{name:"person",size:20,color:Ie}),(0,w.jsx)(c.default,{style:Ee.cardText,children:e.usuarios?.nombreusuario||"Usuario desconocido"})]}),(0,w.jsxs)(d.default,{style:Ee.cardRow,children:[(0,w.jsx)(B.default,{name:"email",size:20,color:Ie}),(0,w.jsx)(c.default,{style:Ee.cardText,children:e.usuarios?.email||"No especificado"})]}),(0,w.jsxs)(d.default,{style:Ee.cardRow,children:[(0,w.jsx)(B.default,{name:"date-range",size:20,color:Ie}),(0,w.jsxs)(c.default,{style:Ee.cardText,children:["Prestado"===e.estado?"Pr\xe9stamo: ":"Reserva: ",e.fechaCompleta]})]}),e.equipos?.modelo&&(0,w.jsxs)(d.default,{style:Ee.cardRow,children:[(0,w.jsx)(B.default,{name:"info",size:20,color:Ie}),(0,w.jsxs)(c.default,{style:Ee.cardText,children:["Modelo: ",e.equipos.modelo]})]}),e.equipos?.numero_serie&&(0,w.jsxs)(d.default,{style:Ee.cardRow,children:[(0,w.jsx)(B.default,{name:"tag",size:20,color:Ie}),(0,w.jsxs)(c.default,{style:Ee.cardText,children:["Serie: ",e.equipos.numero_serie]})]})]}),(0,w.jsx)(d.default,{style:Ee.cardFooter,children:(0,w.jsxs)(h.default,{style:[Ee.actionButton,"Prestado"!==e.estado&&Ee.disabledButton],onPress:()=>{R(e),F("devolver"),T(!0)},disabled:"Prestado"!==e.estado,children:[(0,w.jsx)(B.default,{name:"assignment-return",size:20,color:ze}),(0,w.jsx)(c.default,{style:Ee.actionButtonText,children:"Devolver"})]})})]}),keyExtractor:e=>e.idprestamo.toString(),refreshControl:(0,w.jsx)(fe.default,{refreshing:u,onRefresh:Y,colors:[je]}),contentContainerStyle:Ee.listContent,ListEmptyComponent:(0,w.jsxs)(d.default,{style:Ee.emptyContainer,children:[(0,w.jsx)(z.default,{name:"history",size:60,color:Re}),(0,w.jsx)(c.default,{style:Ee.emptyText,children:"No se encontraron pr\xe9stamos"}),(0,w.jsx)(c.default,{style:Ee.emptySubtext,children:p?"Prueba con otros t\xe9rminos de b\xfasqueda":"No hay pr\xe9stamos activos registrados"})]})}),(0,w.jsx)(E.default,{visible:y,animationType:"slide",transparent:!0,onRequestClose:()=>j(!1),children:(0,w.jsx)(d.default,{style:Ee.modalOverlay,children:(0,w.jsx)(d.default,{style:Ee.modalContainer,children:q&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.default,{style:Ee.modalTitle,children:"Registrar Pr\xe9stamo"}),(0,w.jsxs)(c.default,{style:Ee.modalText,children:[(0,w.jsx)(c.default,{style:Ee.modalLabel,children:"Equipo: "}),q.nombreequipo]}),(0,w.jsxs)(c.default,{style:Ee.modalText,children:[(0,w.jsx)(c.default,{style:Ee.modalLabel,children:"Hora del pr\xe9stamo: "}),Z(H)]}),(0,w.jsxs)(h.default,{style:Ee.timeInput,onPress:()=>U(!0),children:[(0,w.jsx)(B.default,{name:"access-time",size:20,color:Ie}),(0,w.jsxs)(c.default,{style:Ee.timeInputText,children:["Cambiar hora: ",Z(H)]})]}),$&&(0,w.jsx)(xe.default,{value:H,mode:"time",is24Hour:!0,display:"default",onChange:(e,t)=>{U(!1),t&&V(t)},style:Ee.picker}),(0,w.jsxs)(d.default,{style:Ee.modalButtons,children:[(0,w.jsx)(h.default,{style:[Ee.modalButton,Ee.cancelButton],onPress:()=>j(!1),children:(0,w.jsx)(c.default,{style:Ee.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[Ee.modalButton,Ee.confirmButton],onPress:async()=>{if(q)try{const{data:{session:t}}=await b.supabase.auth.getSession();if(!t)return void e.navigate("Login");const{error:o}=await b.supabase.from("prestamos").insert([{idusuario:t.user.id,idequipo:q.idequipo,estado:"Prestado",fechaprestamo:(new Date).toISOString(),horaprestamo:(0,he.format)(H,"HH:mm")}]);if(o)throw o;await b.supabase.from("equipos").update({estado:"prestado"}).eq("idequipo",q.idequipo),j(!1),J(),pe.default.show({type:"success",text1:"Pr\xe9stamo registrado",text2:`El equipo ${q.nombreequipo} ha sido prestado correctamente`})}catch(t){console.error("Error al registrar pr\xe9stamo:",t),pe.default.show({type:"error",text1:"Error",text2:"No se pudo registrar el pr\xe9stamo"})}},children:(0,w.jsx)(c.default,{style:[Ee.modalButtonText,Ee.confirmButtonText],children:"Confirmar Pr\xe9stamo"})})]})]})})})}),(0,w.jsx)(E.default,{visible:C,animationType:"slide",transparent:!0,onRequestClose:()=>v(!1),children:(0,w.jsx)(d.default,{style:Ee.modalOverlay,children:(0,w.jsx)(d.default,{style:Ee.modalContainer,children:q&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.default,{style:Ee.modalTitle,children:"Registrar Reserva"}),(0,w.jsxs)(c.default,{style:Ee.modalText,children:[(0,w.jsx)(c.default,{style:Ee.modalLabel,children:"Equipo: "}),q.nombreequipo]}),(0,w.jsxs)(h.default,{style:Ee.dateInput,onPress:()=>_(!0),children:[(0,w.jsx)(B.default,{name:"calendar-today",size:20,color:Ie}),(0,w.jsxs)(c.default,{style:Ee.dateInputText,children:["Fecha: ",(K=L,(0,he.format)(K,"PPP",{locale:ge.es}))]})]}),(0,w.jsxs)(h.default,{style:Ee.timeInput,onPress:()=>U(!0),children:[(0,w.jsx)(B.default,{name:"access-time",size:20,color:Ie}),(0,w.jsxs)(c.default,{style:Ee.timeInputText,children:["Hora: ",Z(H)]})]}),M&&(0,w.jsx)(xe.default,{value:L,mode:"date",display:"default",minimumDate:new Date,onChange:(e,t)=>{_(!1),t&&N(t)},style:Ee.picker}),$&&(0,w.jsx)(xe.default,{value:H,mode:"time",is24Hour:!0,display:"default",onChange:(e,t)=>{U(!1),t&&V(t)},style:Ee.picker}),(0,w.jsxs)(d.default,{style:Ee.modalButtons,children:[(0,w.jsx)(h.default,{style:[Ee.modalButton,Ee.cancelButton],onPress:()=>v(!1),children:(0,w.jsx)(c.default,{style:Ee.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[Ee.modalButton,Ee.confirmButton],onPress:async()=>{if(q)try{const{data:{session:t}}=await b.supabase.auth.getSession();if(!t)return void e.navigate("Login");const{error:o}=await b.supabase.from("prestamos").insert([{idusuario:t.user.id,idequipo:q.idequipo,estado:"Reservado",fechareserva:L.toISOString().split("T")[0],horasreserva:(0,he.format)(H,"HH:mm")}]);if(o)throw o;await b.supabase.from("equipos").update({estado:"reservado"}).eq("idequipo",q.idequipo),v(!1),J(),pe.default.show({type:"success",text1:"Reserva registrada",text2:`El equipo ${q.nombreequipo} ha sido reservado para el ${(0,he.format)(L,"PPP",{locale:ge.es})} a las ${(0,he.format)(H,"HH:mm")}`})}catch(t){console.error("Error al registrar reserva:",t),pe.default.show({type:"error",text1:"Error",text2:"No se pudo registrar la reserva"})}},children:(0,w.jsx)(c.default,{style:[Ee.modalButtonText,Ee.confirmButtonText],children:"Confirmar Reserva"})})]})]})})})}),(0,w.jsx)(E.default,{visible:S,animationType:"slide",transparent:!0,onRequestClose:()=>T(!1),children:(0,w.jsx)(d.default,{style:Ee.modalOverlay,children:(0,w.jsx)(d.default,{style:Ee.modalContainer,children:I&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.default,{style:Ee.modalTitle,children:"Registrar Devoluci\xf3n"}),(0,w.jsxs)(c.default,{style:Ee.modalText,children:[(0,w.jsx)(c.default,{style:Ee.modalLabel,children:"Equipo: "}),I.equipos?.nombreequipo||"Desconocido"]}),(0,w.jsxs)(c.default,{style:Ee.modalText,children:[(0,w.jsx)(c.default,{style:Ee.modalLabel,children:"Usuario: "}),I.usuarios?.nombreusuario||"Usuario desconocido"]}),(0,w.jsxs)(c.default,{style:Ee.modalText,children:[(0,w.jsx)(c.default,{style:Ee.modalLabel,children:"Fecha: "}),I.fechaCompleta]}),(0,w.jsxs)(d.default,{style:Ee.modalButtons,children:[(0,w.jsx)(h.default,{style:[Ee.modalButton,Ee.cancelButton],onPress:()=>T(!1),children:(0,w.jsx)(c.default,{style:Ee.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[Ee.modalButton,Ee.confirmButton],onPress:async()=>{if(I)try{const{error:e}=await b.supabase.from("prestamos").update({estado:"Devuelto",fechadevolucion:(new Date).toISOString()}).eq("idprestamo",I.idprestamo);if(e)throw e;await b.supabase.from("equipos").update({estado:"disponible"}).eq("idequipo",I.idequipo),T(!1),Q(),pe.default.show({type:"success",text1:"Devoluci\xf3n registrada",text2:"El equipo ha sido marcado como devuelto"})}catch(e){console.error("Error al realizar acci\xf3n:",e),pe.default.show({type:"error",text1:"Error",text2:"No se pudo completar la acci\xf3n"})}},children:(0,w.jsx)(c.default,{style:[Ee.modalButtonText,Ee.confirmButtonText],children:"Confirmar Devoluci\xf3n"})})]})]})})})})]}),(0,w.jsx)(pe.default,{})]});var K};var De=o(9517),Oe=o(6444);const{width:Fe}=x.default.get("window"),We=Fe<768,Ae=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa",alignSelf:"center",width:"100%"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:We?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:We?18:20,fontWeight:"600",color:"#2c3e50",flex:1},buttonGroup:{flexDirection:"row",alignItems:"center"},directorButton:{backgroundColor:"#4a6da7",borderRadius:4,marginRight:8,minWidth:40},printButton:{backgroundColor:"#27ae60",borderRadius:4,minWidth:40},buttonLabel:{color:"#FFF",marginVertical:6,marginHorizontal:0},filterContainer:{padding:16,backgroundColor:"#ffffff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},filterRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},filterLabel:{fontSize:14,color:"#6c757d"},filterOptions:{flexDirection:"row",alignItems:"center"},filterOption:{paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginLeft:8,borderWidth:1,borderColor:"#e0e0e0"},filterOptionActive:{backgroundColor:"#4a6da7",borderColor:"#4a6da7"},filterOptionText:{fontSize:12,color:"#6c757d"},filterOptionTextActive:{color:"#FFF"},dateFilterContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},dateInput:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:"#ced4da",borderRadius:6,padding:12,flex:1,marginHorizontal:5},dateText:{marginLeft:8,color:"#495057"},dateSeparator:{marginHorizontal:8,color:"#6c757d"},webDateInput:{marginLeft:8,border:"none",outline:"none",fontSize:14,color:"#495057",fontFamily:"inherit",backgroundColor:"transparent",width:"100%"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},modalContent:{backgroundColor:"#FFF",borderRadius:8,padding:20,width:We?"90%":"40%"},detalleModalContent:{backgroundColor:"#FFF",borderRadius:8,padding:20,width:We?"90%":"60%",maxHeight:"80%"},modalTitle:{fontSize:18,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},detalleModalTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},input:{borderWidth:1,borderColor:"#ced4da",borderRadius:6,padding:12,marginBottom:20,fontSize:16},modalButtons:{flexDirection:"row",justifyContent:"space-between"},cancelButton:{borderColor:"#95a5a6",flex:1,marginRight:10},cancelButtonText:{color:"#95a5a6"},saveButton:{backgroundColor:"#4a6da7",flex:1},saveButtonText:{color:"#FFF"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},listContent:{padding:We?8:16},card:{backgroundColor:"#FFF",borderRadius:8,padding:16,marginBottom:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:4,elevation:2},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},cardTitle:{fontSize:16,fontWeight:"600",color:"#2c3e50"},cardSubtitle:{fontSize:12,color:"#95a5a6"},subtitlePrestamo:{color:"#2980b9"},subtitleDevolucion:{color:"#27ae60"},statusBadge:{borderRadius:12,paddingVertical:4,paddingHorizontal:10},statusActive:{backgroundColor:"#e6f7ee"},statusCompleted:{backgroundColor:"#e8f5e9"},statusOther:{backgroundColor:"#fff8e1"},statusText:{fontSize:12,fontWeight:"500"},detailRow:{flexDirection:"row",alignItems:"center",marginVertical:4},detailText:{fontSize:14,color:"#6c757d",marginLeft:8,flex:1},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:16,color:"#95a5a6",marginTop:16,textAlign:"center"},detalleSection:{marginBottom:15},detalleLabel:{fontSize:14,color:"#6c757d",marginBottom:4},detalleValue:{fontSize:16,color:"#2c3e50"},detallePrestamo:{color:"#2980b9",fontWeight:"600"},detalleDevolucion:{color:"#27ae60",fontWeight:"600"},closeDetalleButton:{backgroundColor:"#4a6da7",marginTop:20},closeDetalleButtonText:{color:"#FFF"}}),Le=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),[u,m]=(0,n.useState)("Lic. Juan P\xe9rez"),[x,y]=(0,n.useState)(!1),[j,C]=(0,n.useState)(""),[v,S]=(0,n.useState)(new Date),[T,q]=(0,n.useState)(new Date),[k,I]=(0,n.useState)(!1),[R,O]=(0,n.useState)(!1),[F,W]=(0,n.useState)("Todos"),[A,L]=(0,n.useState)(!1),[N,H]=(0,n.useState)(null),V=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,M=(e,t)=>{const o=e.split("-");t(new Date(o[0],o[1]-1,o[2])),_()};(0,n.useEffect)((()=>{(async()=>{try{const e=await De.default.getItem("@director_name");e&&m(e)}catch(e){console.error("Error al cargar nombre:",e)}})(),_()}),[]);const _=async()=>{r(!0),s(!0);try{let e=b.supabase.from("historial_prestamos").select("\n          idhistorial,\n          idprestamo,\n          accion,\n          fechaaccion,\n          detalles,\n          usuarios:usuarios!idusuario(\n            nombreusuario,\n            email,\n            rol\n          ),\n          personal:personal!idpersonal(\n            nombre_completo,\n            tipo_persona,\n            estado\n          ),\n          prestamos:prestamos!idprestamo(\n            idprestamo,\n            estado,\n            fechaprestamo,\n            fechadevolucion_real,\n            equipos:equipos!idequipo(\n              nombreequipo,\n              estado,\n              descripcion\n            )\n          )\n        ").gte("fechaaccion",v.toISOString()).lte("fechaaccion",T.toISOString()).order("fechaaccion",{ascending:!1});"Todos"!==F&&(e=e.eq("accion",F));const{data:t,error:a}=await e;if(a)throw a;const r=t?.map((e=>({idhistorial:e.idhistorial,idprestamo:e.idprestamo,accion:e.accion,fechaaccion:e.fechaaccion,detalles:e.detalles,nombreUsuario:e.usuarios?.nombreusuario||e.personal?.nombre_completo||"Usuario no registrado",emailUsuario:e.usuarios?.email||"",tipoPersona:e.personal?.tipo_persona||e.usuarios?.rol||"",estadoPrestamo:e.prestamos?.estado||"N/A",nombreEquipo:e.prestamos?.equipos?.nombreequipo||"Equipo no encontrado",descripcionEquipo:e.prestamos?.equipos?.descripcion||"",fechaPrestamo:e.prestamos?.fechaprestamo,fechaDevolucion:e.prestamos?.fechadevolucion_real})))||[];o(r)}catch(e){console.error("Error al cargar historial:",e),p.default.alert("Error","No se pudieron cargar los registros del historial")}finally{r(!1),s(!1)}};return(0,w.jsx)(g.default,{style:Ae.safeArea,children:(0,w.jsxs)(d.default,{style:[Ae.container,{maxWidth:1200}],children:[(0,w.jsxs)(d.default,{style:Ae.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:Ae.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:Ae.headerTitle,children:"Historial de Pr\xe9stamos y Devoluciones"}),(0,w.jsxs)(d.default,{style:Ae.buttonGroup,children:[(0,w.jsx)(Oe.default,{mode:"contained",onPress:()=>{C(u),y(!0)},style:Ae.directorButton,labelStyle:Ae.buttonLabel,children:(0,w.jsx)(B.default,{name:"edit",size:18,color:"#FFF"})}),(0,w.jsx)(Oe.default,{mode:"contained",onPress:async()=>{try{const e=`\n        <html>\n          <head>\n            <meta charset="UTF-8">\n            <style>\n              body { font-family: Arial; padding: 20px; margin: 0; }\n              .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #eee; }\n              .logo { max-width: 200px; max-height: 100px; margin-bottom: 15px; }\n              h1 { color: #2c3e50; margin: 5px 0; font-size: 24px; }\n              .subtitle { color: #7f8c8d; font-size: 14px; }\n              .date-range { margin: 10px 0; font-size: 14px; color: #34495e; }\n              .filter-info { margin: 10px 0; font-size: 14px; font-style: italic; }\n              table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px; }\n              th, td { padding: 12px 8px; border: 1px solid #ddd; text-align: left; }\n              th { background-color: #f8f9fa; font-weight: bold; color: #34495e; }\n              .accion-prestamo { color: #2980b9; }\n              .accion-devolucion { color: #27ae60; }\n              .accion-otro { color: #e67e22; }\n              .firma-container { margin-top: 60px; text-align: center; }\n              .linea-firma { width: 300px; border-top: 1px solid #000; margin: 10px auto; }\n              .nombre-director { font-weight: bold; margin-top: 5px; font-size: 16px; }\n              .cargo-director { font-style: italic; color: #7f8c8d; }\n              .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #95a5a6; border-top: 1px solid #eee; padding-top: 15px; }\n              @media print { body { padding: 0; } .no-print { display: none; } }\n            </style>\n          </head>\n          <body>\n            <div class="header">\n              <img src="https://utregionaldelsur.sidci.mx/img/logo.png" class="logo" alt="Logo de la escuela">\n              <h1>Reporte de Historial de Pr\xe9stamos</h1>\n              <p class="subtitle">Generado el: ${(new Date).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}</p>\n              <p class="date-range">\n                Per\xedodo: ${v.toLocaleDateString("es-ES")} - ${T.toLocaleDateString("es-ES")}\n              </p>\n              <p class="filter-info">\n                Filtro: ${"Todos"===F?"Todas las acciones":`Solo acciones de tipo: ${F}`}\n              </p>\n            </div>\n            \n            <table>\n              <thead>\n                <tr>\n                  <th>Equipo</th>\n                  <th>Acci\xf3n</th>\n                  <th>Fecha/Hora</th>\n                  <th>Responsable</th>\n                  <th>Estado</th>\n                  <th>Detalles</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${t.map((e=>`\n                  <tr>\n                    <td>${e.nombreEquipo}</td>\n                    <td class="${"Pr\xe9stamo"===e.accion?"accion-prestamo":"Devoluci\xf3n"===e.accion?"accion-devolucion":"accion-otro"}">\n                      ${e.accion}\n                    </td>\n                    <td>${new Date(e.fechaaccion).toLocaleString("es-ES")}</td>\n                    <td>${e.nombreUsuario}${e.departamento?` (${e.departamento})`:""}</td>\n                    <td>${e.estadoPrestamo}</td>\n                    <td>${e.detalles||"N/A"}</td>\n                  </tr>\n                `)).join("")}\n              </tbody>\n            </table>\n            \n            <div class="firma-container">\n              <div class="linea-firma"></div>\n              <div class="nombre-director">${u}</div>\n              <div class="cargo-director">Director de Carrera</div>\n            </div>\n            \n            <div class="footer">\n              <p>Sistema de Gesti\xf3n de Pr\xe9stamos - ${(new Date).getFullYear()}</p>\n              <p>Documento generado autom\xe1ticamente - V\xe1lido sin firma manuscrita</p>\n            </div>\n          </body>\n        </html>\n      `;{const t=window.open("","_blank");t.document.write(e),t.document.close(),t.focus(),setTimeout((()=>t.print()),500)}}catch(e){p.default.alert("Error","No se pudo generar el documento"),console.error("Error generating document:",e)}},style:Ae.printButton,labelStyle:Ae.buttonLabel,children:(0,w.jsx)(B.default,{name:"print",size:18,color:"#FFF"})})]})]}),(0,w.jsxs)(d.default,{style:Ae.filterContainer,children:[(0,w.jsxs)(d.default,{style:Ae.filterRow,children:[(0,w.jsx)(c.default,{style:Ae.filterLabel,children:"Filtrar por:"}),(0,w.jsxs)(d.default,{style:Ae.filterOptions,children:[(0,w.jsx)(h.default,{style:[Ae.filterOption,"Todos"===F&&Ae.filterOptionActive],onPress:()=>{W("Todos"),_()},children:(0,w.jsx)(c.default,{style:[Ae.filterOptionText,"Todos"===F&&Ae.filterOptionTextActive],children:"Todos"})}),(0,w.jsx)(h.default,{style:[Ae.filterOption,"Pr\xe9stamo"===F&&Ae.filterOptionActive],onPress:()=>{W("Pr\xe9stamo"),_()},children:(0,w.jsx)(c.default,{style:[Ae.filterOptionText,"Pr\xe9stamo"===F&&Ae.filterOptionTextActive],children:"Pr\xe9stamos"})}),(0,w.jsx)(h.default,{style:[Ae.filterOption,"Devoluci\xf3n"===F&&Ae.filterOptionActive],onPress:()=>{W("Devoluci\xf3n"),_()},children:(0,w.jsx)(c.default,{style:[Ae.filterOptionText,"Devoluci\xf3n"===F&&Ae.filterOptionTextActive],children:"Devoluciones"})})]})]}),(0,w.jsx)(d.default,{style:Ae.dateFilterContainer,children:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(d.default,{style:Ae.dateInput,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:16,color:"#4a6da7"}),(0,w.jsx)("input",{type:"date",value:V(v),onChange:e=>M(e.target.value,S),style:Ae.webDateInput,max:V(new Date)})]}),(0,w.jsx)(c.default,{style:Ae.dateSeparator,children:"a"}),(0,w.jsxs)(d.default,{style:Ae.dateInput,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:16,color:"#4a6da7"}),(0,w.jsx)("input",{type:"date",value:V(T),onChange:e=>M(e.target.value,q),style:Ae.webDateInput,min:V(v),max:V(new Date)})]})]})})]}),(0,w.jsx)(E.default,{visible:x,transparent:!0,animationType:"slide",onRequestClose:()=>y(!1),children:(0,w.jsx)(d.default,{style:Ae.modalContainer,children:(0,w.jsxs)(d.default,{style:Ae.modalContent,children:[(0,w.jsx)(c.default,{style:Ae.modalTitle,children:"Cambiar Nombre del Director"}),(0,w.jsx)(D.default,{style:Ae.input,value:j,onChangeText:C,placeholder:"Ingrese el nombre completo",placeholderTextColor:"#95a5a6",autoFocus:!0}),(0,w.jsxs)(d.default,{style:Ae.modalButtons,children:[(0,w.jsx)(Oe.default,{mode:"outlined",onPress:()=>y(!1),style:Ae.cancelButton,labelStyle:Ae.cancelButtonText,children:"Cancelar"}),(0,w.jsx)(Oe.default,{mode:"contained",onPress:async()=>{if(j.trim())try{await De.default.setItem("@director_name",j),m(j),y(!1),p.default.alert("\xc9xito","Nombre actualizado correctamente")}catch(e){p.default.alert("Error","No se pudo actualizar el nombre")}else p.default.alert("Error","Por favor ingrese un nombre v\xe1lido")},style:Ae.saveButton,labelStyle:Ae.saveButtonText,children:"Guardar"})]})]})})}),(0,w.jsx)(E.default,{visible:A,transparent:!0,animationType:"slide",onRequestClose:()=>L(!1),children:(0,w.jsx)(d.default,{style:Ae.modalContainer,children:(0,w.jsxs)(d.default,{style:Ae.detalleModalContent,children:[(0,w.jsx)(c.default,{style:Ae.detalleModalTitle,children:N?.nombreEquipo}),(0,w.jsxs)(d.default,{style:Ae.detalleSection,children:[(0,w.jsx)(c.default,{style:Ae.detalleLabel,children:"Acci\xf3n:"}),(0,w.jsx)(c.default,{style:[Ae.detalleValue,"Pr\xe9stamo"===N?.accion&&Ae.detallePrestamo,"Devoluci\xf3n"===N?.accion&&Ae.detalleDevolucion],children:N?.accion})]}),(0,w.jsxs)(d.default,{style:Ae.detalleSection,children:[(0,w.jsx)(c.default,{style:Ae.detalleLabel,children:"Estado:"}),(0,w.jsx)(c.default,{style:Ae.detalleValue,children:N?.estadoPrestamo})]}),(0,w.jsxs)(d.default,{style:Ae.detalleSection,children:[(0,w.jsx)(c.default,{style:Ae.detalleLabel,children:"Fecha y Hora:"}),(0,w.jsx)(c.default,{style:Ae.detalleValue,children:N?.fechaaccion?new Date(N.fechaaccion).toLocaleString("es-ES"):"N/A"})]}),(0,w.jsxs)(d.default,{style:Ae.detalleSection,children:[(0,w.jsx)(c.default,{style:Ae.detalleLabel,children:"Responsable:"}),(0,w.jsxs)(c.default,{style:Ae.detalleValue,children:[N?.nombreUsuario,N?.departamento?` (${N.departamento})`:""]})]}),N?.fechaPrestamo&&(0,w.jsxs)(d.default,{style:Ae.detalleSection,children:[(0,w.jsx)(c.default,{style:Ae.detalleLabel,children:"Fecha Pr\xe9stamo:"}),(0,w.jsx)(c.default,{style:Ae.detalleValue,children:new Date(N.fechaPrestamo).toLocaleDateString("es-ES")})]}),N?.fechaDevolucion&&(0,w.jsxs)(d.default,{style:Ae.detalleSection,children:[(0,w.jsx)(c.default,{style:Ae.detalleLabel,children:"Fecha Devoluci\xf3n:"}),(0,w.jsx)(c.default,{style:Ae.detalleValue,children:new Date(N.fechaDevolucion).toLocaleDateString("es-ES")})]}),N?.descripcionEquipo&&(0,w.jsxs)(d.default,{style:Ae.detalleSection,children:[(0,w.jsx)(c.default,{style:Ae.detalleLabel,children:"Descripci\xf3n Equipo:"}),(0,w.jsx)(c.default,{style:Ae.detalleValue,children:N.descripcionEquipo})]}),N?.detalles&&(0,w.jsxs)(d.default,{style:Ae.detalleSection,children:[(0,w.jsx)(c.default,{style:Ae.detalleLabel,children:"Detalles:"}),(0,w.jsx)(c.default,{style:Ae.detalleValue,children:N.detalles})]}),(0,w.jsx)(Oe.default,{mode:"contained",onPress:()=>L(!1),style:Ae.closeDetalleButton,labelStyle:Ae.closeDetalleButtonText,children:"Cerrar"})]})})}),a?(0,w.jsxs)(d.default,{style:Ae.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#3498db"}),(0,w.jsx)(c.default,{style:Ae.loadingText,children:"Cargando historial..."})]}):(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsxs)(h.default,{style:Ae.card,onPress:()=>(e=>{H(e),L(!0)})(e),children:[(0,w.jsxs)(d.default,{style:Ae.cardHeader,children:[(0,w.jsxs)(d.default,{children:[(0,w.jsx)(c.default,{style:Ae.cardTitle,children:e.nombreEquipo}),(0,w.jsxs)(c.default,{style:[Ae.cardSubtitle,"Pr\xe9stamo"===e.accion&&Ae.subtitlePrestamo,"Devoluci\xf3n"===e.accion&&Ae.subtitleDevolucion],children:[e.accion," \u2022 ",new Date(e.fechaaccion).toLocaleDateString("es-ES")]})]}),(0,w.jsx)(d.default,{style:[Ae.statusBadge,"Prestado"===e.estadoPrestamo?Ae.statusActive:"Devuelto"===e.estadoPrestamo?Ae.statusCompleted:Ae.statusOther],children:(0,w.jsx)(c.default,{style:Ae.statusText,children:e.estadoPrestamo})})]}),(0,w.jsxs)(d.default,{style:Ae.detailRow,children:[(0,w.jsx)(z.default,{name:"account-circle-outline",size:16,color:"#4a6da7"}),(0,w.jsxs)(c.default,{style:Ae.detailText,children:[e.nombreUsuario,e.tipoPersona?` (${e.tipoPersona})`:""]})]}),e.detalles&&(0,w.jsxs)(d.default,{style:Ae.detailRow,children:[(0,w.jsx)(B.default,{name:"notes",size:16,color:"#4a6da7"}),(0,w.jsx)(c.default,{style:Ae.detailText,numberOfLines:1,ellipsizeMode:"tail",children:e.detalles})]}),(0,w.jsxs)(d.default,{style:Ae.detailRow,children:[(0,w.jsx)(z.default,{name:"clock-outline",size:16,color:"#4a6da7"}),(0,w.jsx)(c.default,{style:Ae.detailText,children:new Date(e.fechaaccion).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]}),keyExtractor:e=>e.idhistorial.toString(),contentContainerStyle:Ae.listContent,refreshControl:(0,w.jsx)(fe.default,{refreshing:l,onRefresh:_,colors:["#3498db"],tintColor:"#3498db"}),ListEmptyComponent:(0,w.jsxs)(d.default,{style:Ae.emptyContainer,children:[(0,w.jsx)(z.default,{name:"book-clock",size:48,color:"#ecf0f1"}),(0,w.jsx)(c.default,{style:Ae.emptyText,children:"No se encontraron registros con los filtros seleccionados"})]})})]})})},{width:Ne}=x.default.get("window"),He=Ne<768,Ve=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:He?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:He?18:20,fontWeight:"600",color:"#2c3e50"},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",borderRadius:8,margin:16,paddingHorizontal:16,paddingVertical:10,borderWidth:1,borderColor:"#e0e0e0"},searchIcon:{marginRight:12},searchInput:{flex:1,fontSize:16,color:"#2c3e50"},listContent:{paddingHorizontal:16,paddingBottom:24},card:{backgroundColor:"#ffffff",borderRadius:12,padding:16,marginBottom:16,marginHorizontal:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},cardTitleContainer:{flexDirection:"row",alignItems:"center",flex:1},cardTitle:{fontSize:18,fontWeight:"600",color:"#2c3e50",marginLeft:10},statusBadge:{paddingHorizontal:12,paddingVertical:6,borderRadius:12},badgeActive:{backgroundColor:"#e3f2fd"},badgeReserved:{backgroundColor:"#fff8e1"},statusText:{fontSize:12,fontWeight:"600",color:"#2c3e50"},cardBody:{marginBottom:16},infoRow:{flexDirection:"row",alignItems:"center",marginBottom:8},infoText:{marginLeft:8,fontSize:14,color:"#6c757d"},actionButton:{backgroundColor:"#4a6da7",borderRadius:6,paddingVertical:12,alignItems:"center",justifyContent:"center"},actionButtonText:{color:"#ffffff",fontWeight:"500",fontSize:14},disabledButton:{opacity:.6},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:16,color:"#6c757d",marginTop:16,textAlign:"center"},retryButton:{marginTop:16,paddingHorizontal:20,paddingVertical:10,backgroundColor:"#e0e7ff",borderRadius:6},retryButtonText:{color:"#4a6da7",fontWeight:"500"},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},modalContainer:{width:He?"90%":"70%",maxWidth:500,backgroundColor:"#ffffff",borderRadius:12,padding:24,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:20,elevation:5},modalTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},modalText:{fontSize:16,color:"#2c3e50",marginBottom:12},modalLabel:{fontSize:14,fontWeight:"500",color:"#6c757d",marginTop:16,marginBottom:8},modalInput:{borderWidth:1,borderColor:"#e0e0e0",borderRadius:8,padding:12,minHeight:100,textAlignVertical:"top",marginBottom:20},modalButtons:{flexDirection:"row",justifyContent:"space-between",marginTop:16},modalButton:{flex:1,paddingVertical:14,borderRadius:8,alignItems:"center",justifyContent:"center",marginHorizontal:8},cancelButton:{backgroundColor:"#6c757d"},confirmButton:{backgroundColor:"#4a6da7"},modalButtonText:{color:"#ffffff",fontWeight:"500",fontSize:16}}),Me=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),[u,m]=(0,n.useState)(""),[p,x]=(0,n.useState)(!1),[y,j]=(0,n.useState)(""),[C,v]=(0,n.useState)(null);(0,n.useEffect)((()=>{S()}),[]);const S=async()=>{try{r(!0),s(!0);const{data:e,error:t}=await b.supabase.from("prestamos").select("\n          idprestamo,\n          idequipo,\n          idusuario,\n          fechaprestamo,\n          horaprestamo,\n          estado,\n          equipos:equipos(nombreequipo),\n          usuarios:usuarios(nombreusuario)\n        ").or("estado.eq.Prestado,estado.eq.Reservado").order("fechaprestamo",{ascending:!1});if(t)throw t;const a=e?.map((e=>({idprestamo:e.idprestamo,idequipo:e.idequipo,idusuario:e.idusuario,nombreequipo:e.equipos?.nombreequipo||"Equipo no encontrado",nombreusuario:e.usuarios?.nombreusuario||"Usuario no encontrado",fechaprestamo:e.fechaprestamo?new Date(e.fechaprestamo).toLocaleDateString():"Sin fecha",horaprestamo:e.horaprestamo||"Sin hora",estado:e.estado})))||[];o(a)}catch(e){console.error("Error al cargar pr\xe9stamos activos:",e),pe.default.show({type:"error",text1:"Error",text2:"No se pudieron cargar los pr\xe9stamos activos"})}finally{r(!1),s(!1)}};return a&&0===t.length?(0,w.jsxs)(g.default,{style:Ve.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:Ve.loadingText,children:"Cargando pr\xe9stamos..."})]}):(0,w.jsxs)(g.default,{style:Ve.safeArea,children:[(0,w.jsxs)(d.default,{style:Ve.container,children:[(0,w.jsxs)(d.default,{style:Ve.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:Ve.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:Ve.headerTitle,children:"Devoluciones"})]}),(0,w.jsxs)(d.default,{style:Ve.searchContainer,children:[(0,w.jsx)(B.default,{name:"search",size:20,color:"#95a5a6",style:Ve.searchIcon}),(0,w.jsx)(D.default,{style:Ve.searchInput,placeholder:"Buscar pr\xe9stamos...",placeholderTextColor:"#95a5a6",value:u,onChangeText:m})]}),(0,w.jsx)(P.default,{data:t.filter((e=>e.nombreequipo.toLowerCase().includes(u.toLowerCase())||e.nombreusuario.toLowerCase().includes(u.toLowerCase()))),renderItem:({item:e})=>(0,w.jsxs)(d.default,{style:Ve.card,children:[(0,w.jsxs)(d.default,{style:Ve.cardHeader,children:[(0,w.jsxs)(d.default,{style:Ve.cardTitleContainer,children:[(0,w.jsx)(z.default,{name:"Prestado"===e.estado?"devices":"calendar-clock",size:24,color:"Prestado"===e.estado?"#1976d2":"#ffa000"}),(0,w.jsx)(c.default,{style:Ve.cardTitle,children:e.nombreequipo})]}),(0,w.jsx)(d.default,{style:[Ve.statusBadge,"Prestado"===e.estado?Ve.badgeActive:Ve.badgeReserved],children:(0,w.jsx)(c.default,{style:Ve.statusText,children:e.estado})})]}),(0,w.jsxs)(d.default,{style:Ve.cardBody,children:[(0,w.jsxs)(d.default,{style:Ve.infoRow,children:[(0,w.jsx)(B.default,{name:"person",size:20,color:"#6c757d"}),(0,w.jsx)(c.default,{style:Ve.infoText,children:e.nombreusuario})]}),(0,w.jsxs)(d.default,{style:Ve.infoRow,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:20,color:"#6c757d"}),(0,w.jsx)(c.default,{style:Ve.infoText,children:e.fechaprestamo})]}),(0,w.jsxs)(d.default,{style:Ve.infoRow,children:[(0,w.jsx)(B.default,{name:"access-time",size:20,color:"#6c757d"}),(0,w.jsx)(c.default,{style:Ve.infoText,children:e.horaprestamo})]})]}),(0,w.jsx)(h.default,{style:[Ve.actionButton,a&&Ve.disabledButton],onPress:()=>(v(e),void x(!0)),disabled:a,children:(0,w.jsx)(c.default,{style:Ve.actionButtonText,children:"Registrar Devoluci\xf3n"})})]}),keyExtractor:e=>e.idprestamo.toString(),contentContainerStyle:Ve.listContent,refreshControl:(0,w.jsx)(fe.default,{refreshing:l,onRefresh:()=>{s(!0),S()},colors:["#4a6da7"]}),ListEmptyComponent:(0,w.jsxs)(d.default,{style:Ve.emptyContainer,children:[(0,w.jsx)(z.default,{name:"clipboard-check-outline",size:48,color:"#e0e0e0"}),(0,w.jsx)(c.default,{style:Ve.emptyText,children:u?"No se encontraron resultados":"No hay pr\xe9stamos activos"}),(0,w.jsx)(h.default,{style:Ve.retryButton,onPress:S,children:(0,w.jsx)(c.default,{style:Ve.retryButtonText,children:"Recargar"})})]})}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!0,visible:p,onRequestClose:()=>{x(!1),j("")},children:(0,w.jsx)(d.default,{style:Ve.modalOverlay,children:(0,w.jsxs)(d.default,{style:Ve.modalContainer,children:[(0,w.jsx)(c.default,{style:Ve.modalTitle,children:"Registrar Devoluci\xf3n"}),(0,w.jsxs)(c.default,{style:Ve.modalText,children:["Equipo: ",C?.nombreequipo||"N/A"]}),(0,w.jsx)(c.default,{style:Ve.modalLabel,children:"Observaciones:"}),(0,w.jsx)(D.default,{style:Ve.modalInput,multiline:!0,numberOfLines:4,placeholder:"Ingrese observaciones sobre la devoluci\xf3n...",value:y,onChangeText:j}),(0,w.jsxs)(d.default,{style:Ve.modalButtons,children:[(0,w.jsx)(h.default,{style:[Ve.modalButton,Ve.cancelButton],onPress:()=>{x(!1),j("")},disabled:a,children:(0,w.jsx)(c.default,{style:Ve.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[Ve.modalButton,Ve.confirmButton],onPress:async()=>{try{r(!0);const{idprestamo:e,idequipo:t,idusuario:o}=C,a=new Date,n=a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),{error:i}=await b.supabase.from("devoluciones").insert({idprestamo:e,fechadevolucion:a.toISOString(),horadevolucion:n,observaciones:y||"Devoluci\xf3n sin observaciones"});if(i)throw i;const{error:l}=await b.supabase.from("historial_prestamos").insert({idprestamo:e,idusuario:o,accion:"Devoluci\xf3n",fechaaccion:a.toISOString(),detalles:y||"Devoluci\xf3n registrada"});if(l)throw l;const{error:s}=await b.supabase.from("prestamos").update({estado:"Devuelto"}).eq("idprestamo",e);if(s)throw s;const{error:d}=await b.supabase.from("equipos").update({estado:"disponible"}).eq("idequipo",t);if(d)throw d;pe.default.show({type:"success",text1:"Devoluci\xf3n registrada",text2:"El equipo est\xe1 disponible nuevamente",visibilityTime:3e3}),x(!1),j(""),v(null),setTimeout((()=>{S()}),500)}catch(e){console.error("Error en devoluci\xf3n:",e),pe.default.show({type:"error",text1:"Error en devoluci\xf3n",text2:e.message||"No se pudo completar la devoluci\xf3n",visibilityTime:4e3})}finally{r(!1)}},disabled:a,children:a?(0,w.jsx)(f.default,{color:"white"}):(0,w.jsx)(c.default,{style:Ve.modalButtonText,children:"Confirmar"})})]})]})})})]}),(0,w.jsx)(pe.default,{})]})},{width:_e}=x.default.get("window"),$e=_e<768,Ue="#4361ee",Ge="#4895ef",Xe="#4cc9f0",Je="#f72585",Qe="#f8961e",Ye="#f8f9fa",Ze="#212529",Ke="#ffffff",et="#ffffff",tt="#2b2d42",ot="#8d99ae",at="#e9ecef",rt=u.default.create({container:{flex:1,backgroundColor:Ye},header:{flexDirection:"row",alignItems:"center",backgroundColor:Ke,paddingVertical:16,paddingHorizontal:$e?20:30,borderBottomWidth:1,borderBottomColor:at,shadowColor:Ze,shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:10,elevation:3,zIndex:10},menuButton:{marginRight:16,padding:8,borderRadius:20,backgroundColor:Ye},headerTitle:{fontSize:$e?20:22,fontWeight:"700",color:Ze,letterSpacing:.5},content:{flex:1,width:"100%",alignSelf:"center",padding:$e?16:24},tabsContainer:{flexDirection:"row",justifyContent:"space-around",marginBottom:24,backgroundColor:Ke,borderRadius:12,padding:6,shadowColor:Ze,shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:8,elevation:2},tabButton:{flex:1,alignItems:"center",padding:12,borderRadius:10,flexDirection:"row",justifyContent:"center"},activeTab:{backgroundColor:Ue+"15"},tabText:{fontSize:16,color:ot,marginLeft:8,fontWeight:"500"},activeTabText:{color:Ue,fontWeight:"600"},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:Ke,borderRadius:12,paddingHorizontal:20,paddingVertical:8,marginBottom:20,shadowColor:Ze,shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:8,elevation:2},searchIcon:{marginRight:12,color:ot},searchInput:{flex:1,height:48,fontSize:16,color:tt,fontFamily:"Roboto"},listContent:{paddingBottom:20},card:{backgroundColor:et,borderRadius:16,padding:20,marginBottom:16,shadowColor:Ze,shadowOffset:{width:0,height:4},shadowOpacity:.05,shadowRadius:12,elevation:3,borderWidth:1,borderColor:at},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},cardTitleContainer:{flexDirection:"row",alignItems:"center",flex:1},cardTitle:{fontSize:18,fontWeight:"600",color:tt,marginLeft:12},cardBody:{marginBottom:16},cardRow:{flexDirection:"row",alignItems:"center",marginBottom:12},cardText:{marginLeft:12,color:ot,fontSize:15,flex:1,lineHeight:22},cardFooter:{flexDirection:"row",justifyContent:"space-between",marginTop:12},actionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:12,paddingHorizontal:16,borderRadius:10,backgroundColor:Ue,flex:1,marginHorizontal:6,shadowColor:Ue,shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:2},actionButtonText:{color:Ke,marginLeft:8,fontWeight:"500",fontSize:15},reserveButton:{backgroundColor:Ge,shadowColor:Ge},deleteButton:{backgroundColor:Je,shadowColor:Je},disabledButton:{opacity:.6},statusBadge:{paddingHorizontal:14,paddingVertical:6,borderRadius:14,alignSelf:"flex-start"},badgeAvailable:{backgroundColor:Xe},badgeReserved:{backgroundColor:Qe},badgeUnavailable:{backgroundColor:Je},badgeActive:{backgroundColor:Ue},badgeReturned:{backgroundColor:ot},statusText:{color:Ke,fontWeight:"600",fontSize:12,textTransform:"uppercase",letterSpacing:.5},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:18,marginTop:20,color:tt,textAlign:"center",fontWeight:"500"},emptySubtext:{fontSize:15,marginTop:10,color:ot,textAlign:"center",lineHeight:22},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:20,fontSize:16,color:ot},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.4)"},modalContainer:{width:$e?"90%":"70%",maxWidth:500,backgroundColor:Ke,borderRadius:16,padding:24,shadowColor:Ze,shadowOffset:{width:0,height:4},shadowOpacity:.1,shadowRadius:20,elevation:5},modalTitle:{fontSize:22,fontWeight:"600",marginBottom:24,color:tt,textAlign:"center"},modalText:{marginBottom:16,fontSize:16,lineHeight:24,color:tt},modalLabel:{fontWeight:"600",color:tt},dateInput:{flexDirection:"row",alignItems:"center",padding:16,borderWidth:1,borderColor:at,borderRadius:12,marginBottom:16,backgroundColor:Ke},timeInput:{flexDirection:"row",alignItems:"center",padding:16,borderWidth:1,borderColor:at,borderRadius:12,marginBottom:20,backgroundColor:Ke},dateInputText:{marginLeft:12,fontSize:16,color:tt},timeInputText:{marginLeft:12,fontSize:16,color:tt},picker:{width:"100%",backgroundColor:Ke},modalButtons:{flexDirection:"row",justifyContent:"flex-end",marginTop:24},modalButton:{paddingVertical:14,paddingHorizontal:24,borderRadius:12,marginLeft:16,minWidth:120,alignItems:"center"},cancelButton:{backgroundColor:Ye,borderWidth:1,borderColor:at},confirmButton:{backgroundColor:Ue,shadowColor:Ue,shadowOffset:{width:0,height:2},shadowOpacity:.2,shadowRadius:4,elevation:2},modalButtonText:{fontWeight:"500",fontSize:16},confirmButtonText:{color:Ke}}),nt=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[l,s]=(0,n.useState)(!0),[u,m]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[y,j]=(0,n.useState)(!1),[C,v]=(0,n.useState)(!1),[S,T]=(0,n.useState)(!1),[q,k]=(0,n.useState)(null),[I,R]=(0,n.useState)(null),[O,F]=(0,n.useState)("devolver"),[W,A]=(0,n.useState)("activos"),[L,N]=(0,n.useState)(new Date),[H,V]=(0,n.useState)(new Date),[M,_]=(0,n.useState)(!1),[$,U]=(0,n.useState)(!1),[G,X]=(0,n.useState)("equipos"),J=async()=>{try{s(!0);let e=b.supabase.from("equipos").select("*").or("estado.eq.disponible,estado.eq.reservado").order("nombreequipo",{ascending:!0});p&&(e=e.ilike("nombreequipo",`%${p}%`));const{data:t,error:a}=await e;if(a)throw a;o(t||[])}catch(e){console.error("Error al cargar equipos:",e),pe.default.show({type:"error",text1:"Error",text2:"No se pudieron cargar los equipos"})}finally{s(!1),m(!1)}},Q=async()=>{try{s(!0);let e=b.supabase.from("prestamos").select("\n          idprestamo,\n          fechaprestamo,\n          fechareserva,\n          horasreserva,\n          estado,\n          equipos: idequipo (nombreequipo, modelo, numero_serie),\n          usuarios: idusuario (nombreusuario, email),\n          horaprestamo\n        ").or("estado.eq.Prestado,estado.eq.Reservado").order("fechaprestamo",{ascending:!1});p&&(e=e.or(`equipos.nombreequipo.ilike.%${p}%,usuarios.nombreusuario.ilike.%${p}%,equipos.numero_serie.ilike.%${p}%`));const{data:t,error:o}=await e;if(o)throw o;const a=t.map((e=>Object.assign({},e,{fechaCompleta:"Prestado"===e.estado?e.fechaprestamo?`${(0,he.format)((0,me.parseISO)(e.fechaprestamo),"PPP",{locale:ge.es})} a las ${e.horaprestamo}`:"No especificado":e.fechareserva?`${(0,he.format)((0,me.parseISO)(e.fechareserva),"PPP",{locale:ge.es})} a las ${e.horasreserva}`:"No especificado",idequipo:e.equipos?.idequipo})));r(a||[])}catch(e){console.error("Error al cargar pr\xe9stamos:",e),pe.default.show({type:"error",text1:"Error",text2:"No se pudieron cargar los pr\xe9stamos"})}finally{s(!1),m(!1)}};(0,n.useEffect)((()=>{"equipos"===G?J():Q()}),[G,p]);const Y=()=>{m(!0),"equipos"===G?J():Q()},Z=e=>(0,he.format)(e,"HH:mm");return l&&("equipos"===G&&0===t.length||"prestamos"===G&&0===a.length)?(0,w.jsx)(g.default,{style:rt.container,children:(0,w.jsxs)(d.default,{style:rt.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:Ue}),(0,w.jsx)(c.default,{style:rt.loadingText,children:"Cargando..."})]})}):(0,w.jsxs)(g.default,{style:rt.container,children:[(0,w.jsxs)(d.default,{style:rt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:rt.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:tt})}),(0,w.jsx)(c.default,{style:rt.headerTitle,children:"equipos"===G?"Gesti\xf3n de Equipos":"Pr\xe9stamos Activos"})]}),(0,w.jsxs)(d.default,{style:[rt.content,{maxWidth:1200}],children:[(0,w.jsxs)(d.default,{style:rt.tabsContainer,children:[(0,w.jsxs)(h.default,{style:[rt.tabButton,"equipos"===G&&rt.activeTab],onPress:()=>X("equipos"),children:[(0,w.jsx)(z.default,{name:"devices",size:20,color:"equipos"===G?Ue:ot}),(0,w.jsx)(c.default,{style:[rt.tabText,"equipos"===G&&rt.activeTabText],children:"Equipos"})]}),(0,w.jsxs)(h.default,{style:[rt.tabButton,"prestamos"===G&&rt.activeTab],onPress:()=>X("prestamos"),children:[(0,w.jsx)(z.default,{name:"history",size:20,color:"prestamos"===G?Ue:ot}),(0,w.jsx)(c.default,{style:[rt.tabText,"prestamos"===G&&rt.activeTabText],children:"Pr\xe9stamos"})]})]}),(0,w.jsxs)(d.default,{style:rt.searchContainer,children:[(0,w.jsx)(B.default,{name:"search",size:20,color:ot,style:rt.searchIcon}),(0,w.jsx)(D.default,{style:rt.searchInput,placeholder:"Buscar "+("equipos"===G?"equipos...":"pr\xe9stamos..."),value:p,onChangeText:x,placeholderTextColor:ot})]}),"equipos"===G?(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsxs)(d.default,{style:rt.card,children:[(0,w.jsxs)(d.default,{style:rt.cardHeader,children:[(0,w.jsxs)(d.default,{style:rt.cardTitleContainer,children:[(0,w.jsx)(z.default,{name:"devices",size:24,color:"disponible"===e.estado?Xe:Qe}),(0,w.jsx)(c.default,{style:rt.cardTitle,children:e.nombreequipo})]}),(0,w.jsx)(d.default,{style:[rt.statusBadge,"disponible"===e.estado?rt.badgeAvailable:"reservado"===e.estado?rt.badgeReserved:rt.badgeUnavailable],children:(0,w.jsx)(c.default,{style:rt.statusText,children:"disponible"===e.estado?"Disponible":"Reservado"})})]}),(0,w.jsxs)(d.default,{style:rt.cardBody,children:[e.modelo&&(0,w.jsxs)(d.default,{style:rt.cardRow,children:[(0,w.jsx)(B.default,{name:"info",size:20,color:ot}),(0,w.jsxs)(c.default,{style:rt.cardText,children:["Modelo: ",e.modelo]})]}),e.numero_serie&&(0,w.jsxs)(d.default,{style:rt.cardRow,children:[(0,w.jsx)(B.default,{name:"tag",size:20,color:ot}),(0,w.jsxs)(c.default,{style:rt.cardText,children:["Serie: ",e.numero_serie]})]})]}),(0,w.jsxs)(d.default,{style:rt.cardFooter,children:[(0,w.jsxs)(h.default,{style:[rt.actionButton,"disponible"!==e.estado&&rt.disabledButton],onPress:()=>{k(e),V(new Date),j(!0)},disabled:"disponible"!==e.estado,children:[(0,w.jsx)(B.default,{name:"check-circle",size:20,color:Ke}),(0,w.jsx)(c.default,{style:rt.actionButtonText,children:"Prestar"})]}),(0,w.jsxs)(h.default,{style:[rt.actionButton,rt.reserveButton,"disponible"!==e.estado&&rt.disabledButton],onPress:()=>{k(e),N(new Date),V(new Date),v(!0)},disabled:"disponible"!==e.estado,children:[(0,w.jsx)(B.default,{name:"event-available",size:20,color:Ke}),(0,w.jsx)(c.default,{style:rt.actionButtonText,children:"Reservar"})]})]})]}),keyExtractor:e=>e.idequipo.toString(),refreshControl:(0,w.jsx)(fe.default,{refreshing:u,onRefresh:Y,colors:[Ue]}),contentContainerStyle:rt.listContent,ListEmptyComponent:(0,w.jsxs)(d.default,{style:rt.emptyContainer,children:[(0,w.jsx)(z.default,{name:"devices",size:60,color:at}),(0,w.jsx)(c.default,{style:rt.emptyText,children:"No se encontraron equipos"}),(0,w.jsx)(c.default,{style:rt.emptySubtext,children:p?"Prueba con otros t\xe9rminos de b\xfasqueda":"No hay equipos disponibles en este momento"})]})}):(0,w.jsx)(P.default,{data:a,renderItem:({item:e})=>(0,w.jsxs)(d.default,{style:rt.card,children:[(0,w.jsxs)(d.default,{style:rt.cardHeader,children:[(0,w.jsxs)(d.default,{style:rt.cardTitleContainer,children:[(0,w.jsx)(z.default,{name:"Prestado"===e.estado?"devices":"calendar-clock",size:24,color:"Prestado"===e.estado?Ue:Qe}),(0,w.jsx)(c.default,{style:rt.cardTitle,children:e.equipos?.nombreequipo||"Equipo desconocido"})]}),(0,w.jsx)(d.default,{style:[rt.statusBadge,"Prestado"===e.estado?rt.badgeActive:rt.badgeReserved],children:(0,w.jsx)(c.default,{style:rt.statusText,children:e.estado})})]}),(0,w.jsxs)(d.default,{style:rt.cardBody,children:[(0,w.jsxs)(d.default,{style:rt.cardRow,children:[(0,w.jsx)(B.default,{name:"person",size:20,color:ot}),(0,w.jsx)(c.default,{style:rt.cardText,children:e.usuarios?.nombreusuario||"Usuario desconocido"})]}),(0,w.jsxs)(d.default,{style:rt.cardRow,children:[(0,w.jsx)(B.default,{name:"email",size:20,color:ot}),(0,w.jsx)(c.default,{style:rt.cardText,children:e.usuarios?.email||"No especificado"})]}),(0,w.jsxs)(d.default,{style:rt.cardRow,children:[(0,w.jsx)(B.default,{name:"date-range",size:20,color:ot}),(0,w.jsxs)(c.default,{style:rt.cardText,children:["Prestado"===e.estado?"Pr\xe9stamo: ":"Reserva: ",e.fechaCompleta]})]}),e.equipos?.modelo&&(0,w.jsxs)(d.default,{style:rt.cardRow,children:[(0,w.jsx)(B.default,{name:"info",size:20,color:ot}),(0,w.jsxs)(c.default,{style:rt.cardText,children:["Modelo: ",e.equipos.modelo]})]}),e.equipos?.numero_serie&&(0,w.jsxs)(d.default,{style:rt.cardRow,children:[(0,w.jsx)(B.default,{name:"tag",size:20,color:ot}),(0,w.jsxs)(c.default,{style:rt.cardText,children:["Serie: ",e.equipos.numero_serie]})]})]}),(0,w.jsx)(d.default,{style:rt.cardFooter,children:(0,w.jsxs)(h.default,{style:[rt.actionButton,"Prestado"!==e.estado&&rt.disabledButton],onPress:()=>{R(e),F("devolver"),T(!0)},disabled:"Prestado"!==e.estado,children:[(0,w.jsx)(B.default,{name:"assignment-return",size:20,color:Ke}),(0,w.jsx)(c.default,{style:rt.actionButtonText,children:"Devolver"})]})})]}),keyExtractor:e=>e.idprestamo.toString(),refreshControl:(0,w.jsx)(fe.default,{refreshing:u,onRefresh:Y,colors:[Ue]}),contentContainerStyle:rt.listContent,ListEmptyComponent:(0,w.jsxs)(d.default,{style:rt.emptyContainer,children:[(0,w.jsx)(z.default,{name:"history",size:60,color:at}),(0,w.jsx)(c.default,{style:rt.emptyText,children:"No se encontraron pr\xe9stamos"}),(0,w.jsx)(c.default,{style:rt.emptySubtext,children:p?"Prueba con otros t\xe9rminos de b\xfasqueda":"No hay pr\xe9stamos activos registrados"})]})}),(0,w.jsx)(E.default,{visible:y,animationType:"slide",transparent:!0,onRequestClose:()=>j(!1),children:(0,w.jsx)(d.default,{style:rt.modalOverlay,children:(0,w.jsx)(d.default,{style:rt.modalContainer,children:q&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.default,{style:rt.modalTitle,children:"Registrar Pr\xe9stamo"}),(0,w.jsxs)(c.default,{style:rt.modalText,children:[(0,w.jsx)(c.default,{style:rt.modalLabel,children:"Equipo: "}),q.nombreequipo]}),(0,w.jsxs)(c.default,{style:rt.modalText,children:[(0,w.jsx)(c.default,{style:rt.modalLabel,children:"Hora del pr\xe9stamo: "}),Z(H)]}),(0,w.jsxs)(h.default,{style:rt.timeInput,onPress:()=>U(!0),children:[(0,w.jsx)(B.default,{name:"access-time",size:20,color:ot}),(0,w.jsxs)(c.default,{style:rt.timeInputText,children:["Cambiar hora: ",Z(H)]})]}),$&&(0,w.jsx)(xe.default,{value:H,mode:"time",is24Hour:!0,display:"default",onChange:(e,t)=>{U(!1),t&&V(t)},style:rt.picker}),(0,w.jsxs)(d.default,{style:rt.modalButtons,children:[(0,w.jsx)(h.default,{style:[rt.modalButton,rt.cancelButton],onPress:()=>j(!1),children:(0,w.jsx)(c.default,{style:rt.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[rt.modalButton,rt.confirmButton],onPress:async()=>{if(q)try{const{data:{session:t}}=await b.supabase.auth.getSession();if(!t)return void e.navigate("Login");const{data:o,error:a}=await b.supabase.from("solicitudes_prestamo").insert([{idusuario:t.user.id,idequipo:q.idequipo,tiposolicitud:"prestamo",fechasolicitud:(new Date).toISOString().split("T")[0],estado:"aprobado"}]).select();if(a)throw a;const{error:r}=await b.supabase.from("prestamos").insert([{idusuario:t.user.id,idequipo:q.idequipo,estado:"Prestado",fechaprestamo:(new Date).toISOString(),horaprestamo:(0,he.format)(H,"HH:mm"),idsolicitud:o[0].idsolicitud}]);if(r)throw r;await b.supabase.from("equipos").update({estado:"prestado"}).eq("idequipo",q.idequipo),j(!1),J(),pe.default.show({type:"success",text1:"Pr\xe9stamo registrado",text2:`El equipo ${q.nombreequipo} ha sido prestado correctamente`})}catch(t){console.error("Error al registrar pr\xe9stamo:",t),pe.default.show({type:"error",text1:"Error",text2:"No se pudo registrar el pr\xe9stamo"})}},children:(0,w.jsx)(c.default,{style:[rt.modalButtonText,rt.confirmButtonText],children:"Confirmar Pr\xe9stamo"})})]})]})})})}),(0,w.jsx)(E.default,{visible:C,animationType:"slide",transparent:!0,onRequestClose:()=>v(!1),children:(0,w.jsx)(d.default,{style:rt.modalOverlay,children:(0,w.jsx)(d.default,{style:rt.modalContainer,children:q&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.default,{style:rt.modalTitle,children:"Registrar Reserva"}),(0,w.jsxs)(c.default,{style:rt.modalText,children:[(0,w.jsx)(c.default,{style:rt.modalLabel,children:"Equipo: "}),q.nombreequipo]}),(0,w.jsxs)(h.default,{style:rt.dateInput,onPress:()=>_(!0),children:[(0,w.jsx)(B.default,{name:"calendar-today",size:20,color:ot}),(0,w.jsxs)(c.default,{style:rt.dateInputText,children:["Fecha: ",(K=L,(0,he.format)(K,"PPP",{locale:ge.es}))]})]}),(0,w.jsxs)(h.default,{style:rt.timeInput,onPress:()=>U(!0),children:[(0,w.jsx)(B.default,{name:"access-time",size:20,color:ot}),(0,w.jsxs)(c.default,{style:rt.timeInputText,children:["Hora: ",Z(H)]})]}),M&&(0,w.jsx)(xe.default,{value:L,mode:"date",display:"default",minimumDate:new Date,onChange:(e,t)=>{_(!1),t&&N(t)},style:rt.picker}),$&&(0,w.jsx)(xe.default,{value:H,mode:"time",is24Hour:!0,display:"default",onChange:(e,t)=>{U(!1),t&&V(t)},style:rt.picker}),(0,w.jsxs)(d.default,{style:rt.modalButtons,children:[(0,w.jsx)(h.default,{style:[rt.modalButton,rt.cancelButton],onPress:()=>v(!1),children:(0,w.jsx)(c.default,{style:rt.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[rt.modalButton,rt.confirmButton],onPress:async()=>{if(q)try{const{data:{session:t}}=await b.supabase.auth.getSession();if(!t)return void e.navigate("Login");const{error:o}=await b.supabase.from("prestamos").insert([{idusuario:t.user.id,idequipo:q.idequipo,estado:"Reservado",fechareserva:L.toISOString().split("T")[0],horasreserva:(0,he.format)(H,"HH:mm")}]);if(o)throw o;await b.supabase.from("equipos").update({estado:"reservado"}).eq("idequipo",q.idequipo),v(!1),J(),pe.default.show({type:"success",text1:"Reserva registrada",text2:`El equipo ${q.nombreequipo} ha sido reservado para el ${(0,he.format)(L,"PPP",{locale:ge.es})} a las ${(0,he.format)(H,"HH:mm")}`})}catch(t){console.error("Error al registrar reserva:",t),pe.default.show({type:"error",text1:"Error",text2:"No se pudo registrar la reserva"})}},children:(0,w.jsx)(c.default,{style:[rt.modalButtonText,rt.confirmButtonText],children:"Confirmar Reserva"})})]})]})})})}),(0,w.jsx)(E.default,{visible:S,animationType:"slide",transparent:!0,onRequestClose:()=>T(!1),children:(0,w.jsx)(d.default,{style:rt.modalOverlay,children:(0,w.jsx)(d.default,{style:rt.modalContainer,children:I&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.default,{style:rt.modalTitle,children:"Registrar Devoluci\xf3n"}),(0,w.jsxs)(c.default,{style:rt.modalText,children:[(0,w.jsx)(c.default,{style:rt.modalLabel,children:"Equipo: "}),I.equipos?.nombreequipo||"Desconocido"]}),(0,w.jsxs)(c.default,{style:rt.modalText,children:[(0,w.jsx)(c.default,{style:rt.modalLabel,children:"Usuario: "}),I.usuarios?.nombreusuario||"Usuario desconocido"]}),(0,w.jsxs)(c.default,{style:rt.modalText,children:[(0,w.jsx)(c.default,{style:rt.modalLabel,children:"Fecha: "}),I.fechaCompleta]}),(0,w.jsxs)(d.default,{style:rt.modalButtons,children:[(0,w.jsx)(h.default,{style:[rt.modalButton,rt.cancelButton],onPress:()=>T(!1),children:(0,w.jsx)(c.default,{style:rt.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[rt.modalButton,rt.confirmButton],onPress:async()=>{if(I)try{const{error:e}=await b.supabase.from("prestamos").update({estado:"Devuelto",fechadevolucion:(new Date).toISOString()}).eq("idprestamo",I.idprestamo);if(e)throw e;await b.supabase.from("equipos").update({estado:"disponible"}).eq("idequipo",I.idequipo),T(!1),Q(),pe.default.show({type:"success",text1:"Devoluci\xf3n registrada",text2:"El equipo ha sido marcado como devuelto"})}catch(e){console.error("Error al realizar acci\xf3n:",e),pe.default.show({type:"error",text1:"Error",text2:"No se pudo completar la acci\xf3n"})}},children:(0,w.jsx)(c.default,{style:[rt.modalButtonText,rt.confirmButtonText],children:"Confirmar Devoluci\xf3n"})})]})]})})})})]}),(0,w.jsx)(pe.default,{})]});var K},it=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,paddingTop:0},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,backgroundColor:"white",borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},menuButton:{padding:8},headerTitle:{fontSize:20,fontWeight:"600",color:"#343a40"},scanButton:{padding:8},listContainer:{padding:15,paddingBottom:20,flexGrow:1},listItem:{backgroundColor:"white",padding:15,borderRadius:8,marginBottom:10,flexDirection:"row",justifyContent:"space-between",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:3,elevation:2},prestamoInfo:{flex:1,marginRight:10},listItemTitle:{fontSize:16,fontWeight:"600",color:"#343a40",marginBottom:4},listItemText:{fontSize:14,color:"#495057",marginVertical:2},listItemSubText:{fontSize:13,color:"#6c757d",marginVertical:2},label:{color:"#6c757d",fontWeight:"normal"},devolverButton:{backgroundColor:"#28a745",paddingVertical:8,paddingHorizontal:12,borderRadius:6,minWidth:80,alignItems:"center"},devolverButtonText:{color:"white",fontWeight:"500",fontSize:14},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},emptyText:{fontSize:16,color:"#6c757d",marginTop:10,textAlign:"center"},loadingOverlay:Object.assign({},u.default.absoluteFillObject,{backgroundColor:"rgba(255, 255, 255, 0.9)",justifyContent:"center",alignItems:"center",zIndex:10}),loadingText:{marginTop:10,fontSize:16,color:"#6c757d"}}),lt=({navigation:e})=>{const[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[i,l]=(0,n.useState)(!1),[s,u]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1),y=async()=>{try{r(!0);const{data:e,error:t}=await b.supabase.from("prestamos").select("\n          idprestamo,\n          estado,\n          fechaprestamo,\n          fechadevolucion_prevista,\n          idequipo,\n          equipos(nombreequipo, estado, categoriasequipos(nombrecategoria)),\n          personal(nombre_completo, tipo_persona)\n        ").eq("estado","Prestado").order("fechaprestamo",{ascending:!1});if(t)throw t;o(e||[])}catch(e){console.error("Error cargando pr\xe9stamos:",e),p.default.alert("Error","No se pudieron cargar los pr\xe9stamos activos")}finally{r(!1),x(!1)}},C=e=>{p.default.alert("Confirmar Devoluci\xf3n",`\xbfDesea registrar la devoluci\xf3n del equipo?\n\nEquipo: ${e.equipos?.nombreequipo}\nCategor\xeda: ${e.equipos?.categoriasequipos?.nombrecategoria||"N/A"}\nPrestado a: ${e.personal?.nombre_completo}\nTipo: ${e.personal?.tipo_persona||"No especificado"}`,[{text:"Cancelar",style:"cancel",onPress:()=>console.log("Devoluci\xf3n cancelada")},{text:"Confirmar",onPress:()=>v(e)}])},v=async e=>{try{r(!0);const{data:t,error:o}=await b.supabase.rpc("registrar_devolucion_app",{p_idprestamo:e.idprestamo});if(o||t?.error)throw new Error(o?.message||t?.message||"Error en la devoluci\xf3n");p.default.alert("\xc9xito","Devoluci\xf3n registrada correctamente",[{text:"OK",onPress:()=>y()}])}catch(t){console.error("Error en devoluci\xf3n:",t),p.default.alert("Error",`No se pudo completar la devoluci\xf3n: ${t.message}`)}finally{r(!1)}};(0,n.useEffect)((()=>e.addListener("focus",y)),[e]);return(0,w.jsxs)(g.default,{style:it.safeArea,children:[(0,w.jsx)(O.default,{barStyle:"dark-content",backgroundColor:"#f8f9fa"}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!1,visible:s,onRequestClose:()=>u(!1),children:(0,w.jsx)(Q,{navigation:e,onClose:()=>u(!1)})}),(0,w.jsxs)(d.default,{style:it.container,children:[(0,w.jsxs)(d.default,{style:it.header,children:[(0,w.jsx)(h.default,{onPress:()=>u(!s),style:it.menuButton,children:(0,w.jsx)(j.default,{name:"menu",size:28,color:"#4a6da7"})}),(0,w.jsx)(c.default,{style:it.headerTitle,children:"Devoluci\xf3n de Equipos"}),(0,w.jsx)(h.default,{onPress:()=>l(!0),style:it.scanButton,disabled:a,children:(0,w.jsx)(j.default,{name:"qr-code-scanner",size:28,color:a?"#adb5bd":"#4a6da7"})})]}),(0,w.jsx)(P.default,{data:t,renderItem:({item:t})=>(0,w.jsxs)(h.default,{style:it.listItem,onPress:()=>e.navigate("DetallePrestamo",{prestamoId:t.idprestamo}),onLongPress:()=>C(t),children:[(0,w.jsxs)(d.default,{style:it.prestamoInfo,children:[(0,w.jsx)(c.default,{style:it.listItemTitle,children:t.equipos?.nombreequipo}),(0,w.jsxs)(c.default,{style:it.listItemText,children:[(0,w.jsx)(c.default,{style:it.label,children:"Prestado a: "}),t.personal?.nombre_completo]}),(0,w.jsxs)(c.default,{style:it.listItemSubText,children:[(0,w.jsx)(c.default,{style:it.label,children:"Fecha pr\xe9stamo: "}),new Date(t.fechaprestamo).toLocaleDateString()]}),t.fechadevolucion_prevista&&(0,w.jsxs)(c.default,{style:it.listItemSubText,children:[(0,w.jsx)(c.default,{style:it.label,children:"Devoluci\xf3n prevista: "}),new Date(t.fechadevolucion_prevista).toLocaleDateString()]})]}),(0,w.jsx)(h.default,{style:it.devolverButton,onPress:()=>C(t),children:(0,w.jsx)(c.default,{style:it.devolverButtonText,children:"Devolver"})})]}),keyExtractor:e=>e.idprestamo.toString(),contentContainerStyle:it.listContainer,ListEmptyComponent:(0,w.jsx)(d.default,{style:it.emptyContainer,children:a?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:it.loadingText,children:"Cargando pr\xe9stamos..."})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(j.default,{name:"assignment-return",size:50,color:"#6c757d"}),(0,w.jsx)(c.default,{style:it.emptyText,children:"No hay pr\xe9stamos activos"})]})}),refreshing:m,onRefresh:()=>{x(!0),y()}}),(0,w.jsx)(te,{visible:i,onClose:()=>l(!1),onScan:async e=>{try{l(!1),r(!0);const t=e.split("/").pop(),{data:o,error:a}=await b.supabase.from("prestamos").select("\n          idprestamo,\n          idequipo,\n          equipos(nombreequipo, estado, categoriasequipos(nombrecategoria)),\n          personal(nombre_completo, tipo_persona)\n        ").eq("estado","Prestado").eq("equipos.idequipo",t).single();if(a||!o)throw a||new Error("Pr\xe9stamo no encontrado para este equipo");if("prestado"!==o.equipos?.estado)throw new Error("El equipo no est\xe1 marcado como prestado en el sistema");C(o)}catch(t){console.error("Error en devoluci\xf3n por QR:",t),p.default.alert("Error",t.message||"No se encontr\xf3 un pr\xe9stamo activo para este equipo")}finally{r(!1)}}}),a&&(0,w.jsxs)(d.default,{style:it.loadingOverlay,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:it.loadingText,children:"Procesando..."})]})]})]})};var st=o(8033);const{width:dt}=x.default.get("window"),ct=dt<768,ut=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:ct?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},backButton:{marginRight:16},headerTitle:{fontSize:ct?18:20,fontWeight:"600",color:"#2c3e50"},scrollContent:{flexGrow:1,paddingBottom:24},content:{width:"100%",maxWidth:1200,alignSelf:"center",paddingHorizontal:ct?16:24},card:{backgroundColor:"#ffffff",borderRadius:12,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},cardHeader:{padding:ct?16:20,borderBottomWidth:1,borderBottomColor:"#e0e0e0"},cardTitle:{fontSize:ct?16:18,fontWeight:"600",color:"#2c3e50"},cardBody:{padding:ct?16:20},formGroup:{marginBottom:20},label:{fontSize:14,color:"#6c757d",marginBottom:8,fontWeight:"500"},pickerContainer:{borderWidth:1,borderColor:"#ced4da",borderRadius:6,overflow:"hidden"},picker:{height:50,width:"100%",color:"#495057"},textInput:{borderWidth:1,borderColor:"#ced4da",borderRadius:6,padding:12,minHeight:100,textAlignVertical:"top",backgroundColor:"#ffffff"},loadingContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:10},loadingText:{marginLeft:10,color:"#64748B"},infoBox:{flexDirection:"row",alignItems:"center",backgroundColor:"#e7f1ff",padding:12,borderRadius:6,marginBottom:20,borderLeftWidth:4,borderLeftColor:"#3B82F6"},infoTextContainer:{marginLeft:10},infoText:{color:"#1E40AF",fontSize:14,lineHeight:20},button:{backgroundColor:"#4a6da7",borderRadius:6,padding:14,alignItems:"center",justifyContent:"center",marginTop:10,flexDirection:"row"},buttonContent:{flexDirection:"row",alignItems:"center"},buttonText:{color:"#ffffff",fontSize:16,fontWeight:"600",marginLeft:10},buttonDisabled:{backgroundColor:"#95a5a6",opacity:.7},webSuccessMessage:{position:"fixed",top:20,left:"50%",transform:[{translateX:-180}],width:360,backgroundColor:"#D1FAE5",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},webSuccessText:{color:"#065F46",marginLeft:10,fontSize:14,fontWeight:"500"},webErrorMessage:{position:"fixed",top:20,left:"50%",transform:[{translateX:-180}],width:360,backgroundColor:"#FEE2E2",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},webErrorText:{color:"#B91C1C",marginLeft:10,fontSize:14,fontWeight:"500"},mobileSuccessMessage:{position:"absolute",bottom:20,left:20,right:20,backgroundColor:"#D1FAE5",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},mobileErrorMessage:{position:"absolute",bottom:20,left:20,right:20,backgroundColor:"#FEE2E2",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},mobileMessageText:{marginLeft:10,fontSize:14,fontWeight:"500"}}),ft=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)([]),[u,p]=(0,n.useState)([]),[x,y]=(0,n.useState)(""),[j,C]=(0,n.useState)({idequipo:"",tipomantenimiento:"Preventivo",observaciones:""}),[v,S]=(0,n.useState)(null),[T,q]=(0,n.useState)(!1),[k,I]=(0,n.useState)(""),[R,E]=(0,n.useState)(!1),[P,O]=(0,n.useState)("");(0,n.useEffect)((()=>{(async()=>{const{data:{user:e},error:t}=await b.supabase.auth.getUser();t?A("Error obteniendo usuario"):S(e)})()}),[]),(0,n.useEffect)((()=>{(async()=>{try{const{data:e,error:t}=await b.supabase.from("categoriasequipos").select("idcategoria, nombrecategoria").order("nombrecategoria",{ascending:!0});if(t)throw t;p(e||[])}catch(e){A("Error al cargar categor\xedas")}})()}),[]),(0,n.useEffect)((()=>{F()}),[x]);const F=async()=>{try{r(!0);let e=b.supabase.from("equipos").select("idequipo, nombreequipo, idcategoria").eq("estado","disponible").order("nombreequipo",{ascending:!0});x&&(e=e.eq("idcategoria",x));const{data:t,error:o}=await e;if(o)throw o;s(t||[])}catch(e){A("Error al cargar equipos disponibles")}finally{r(!1)}},W=(e,t)=>{C((o=>Object.assign({},o,{[e]:t})))},A=e=>{O(e),E(!0),setTimeout((()=>E(!1)),3e3),console.error(e)};return(0,w.jsxs)(g.default,{style:ut.safeArea,children:[(0,w.jsxs)(d.default,{style:ut.container,children:[(0,w.jsxs)(d.default,{style:ut.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.goBack(),style:ut.backButton,children:(0,w.jsx)(B.default,{name:"arrow-back",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:ut.headerTitle,children:"Agregar Mantenimiento"})]}),T&&(0,w.jsxs)(d.default,{style:ut.webSuccessMessage,children:[(0,w.jsx)(B.default,{name:"check-circle",size:20,color:"#10B981"}),(0,w.jsx)(c.default,{style:ut.webSuccessText,children:k})]}),R&&(0,w.jsxs)(d.default,{style:ut.webErrorMessage,children:[(0,w.jsx)(B.default,{name:"error",size:20,color:"#EF4444"}),(0,w.jsx)(c.default,{style:ut.webErrorText,children:P})]}),(0,w.jsx)(m.default,{contentContainerStyle:ut.scrollContent,showsVerticalScrollIndicator:!1,keyboardShouldPersistTaps:"handled",children:(0,w.jsx)(d.default,{style:ut.content,children:(0,w.jsxs)(d.default,{style:ut.card,children:[(0,w.jsx)(d.default,{style:ut.cardHeader,children:(0,w.jsx)(c.default,{style:ut.cardTitle,children:"Registrar Nuevo Mantenimiento"})}),(0,w.jsxs)(d.default,{style:ut.cardBody,children:[(0,w.jsxs)(d.default,{style:ut.formGroup,children:[(0,w.jsx)(c.default,{style:ut.label,children:"Filtrar por categor\xeda"}),(0,w.jsx)(d.default,{style:ut.pickerContainer,children:(0,w.jsxs)(st.Picker,{selectedValue:x,onValueChange:y,style:ut.picker,dropdownIconColor:"#666",children:[(0,w.jsx)(st.Picker.Item,{label:"Todas las categor\xedas",value:""}),u.map((e=>(0,w.jsx)(st.Picker.Item,{label:e.nombrecategoria,value:e.idcategoria},e.idcategoria)))]})})]}),(0,w.jsxs)(d.default,{style:ut.formGroup,children:[(0,w.jsx)(c.default,{style:ut.label,children:"Equipo Disponible *"}),a?(0,w.jsxs)(d.default,{style:ut.loadingContainer,children:[(0,w.jsx)(f.default,{size:"small",color:"#3B82F6"}),(0,w.jsx)(c.default,{style:ut.loadingText,children:"Cargando equipos..."})]}):(0,w.jsx)(d.default,{style:ut.pickerContainer,children:(0,w.jsxs)(st.Picker,{selectedValue:j.idequipo,onValueChange:e=>W("idequipo",e),style:ut.picker,dropdownIconColor:"#666",children:[(0,w.jsx)(st.Picker.Item,{label:"Seleccione un equipo",value:""}),l.map((e=>(0,w.jsx)(st.Picker.Item,{label:e.nombreequipo,value:e.idequipo},e.idequipo)))]})})]}),(0,w.jsxs)(d.default,{style:ut.formGroup,children:[(0,w.jsx)(c.default,{style:ut.label,children:"Tipo de mantenimiento *"}),(0,w.jsx)(d.default,{style:ut.pickerContainer,children:(0,w.jsxs)(st.Picker,{selectedValue:j.tipomantenimiento,onValueChange:e=>W("tipomantenimiento",e),style:ut.picker,dropdownIconColor:"#666",children:[(0,w.jsx)(st.Picker.Item,{label:"Preventivo",value:"Preventivo"}),(0,w.jsx)(st.Picker.Item,{label:"Correctivo",value:"Correctivo"})]})})]}),(0,w.jsxs)(d.default,{style:ut.formGroup,children:[(0,w.jsx)(c.default,{style:ut.label,children:"Observaciones"}),(0,w.jsx)(D.default,{style:ut.textInput,multiline:!0,numberOfLines:4,placeholder:"Describa las observaciones del mantenimiento...",value:j.observaciones,onChangeText:e=>W("observaciones",e)})]}),(0,w.jsxs)(d.default,{style:ut.infoBox,children:[(0,w.jsx)(B.default,{name:"info-outline",size:20,color:"#3B82F6"}),(0,w.jsxs)(d.default,{style:ut.infoTextContainer,children:[(0,w.jsxs)(c.default,{style:ut.infoText,children:["Registrado por: ",v?.email||"Usuario actual"]}),(0,w.jsx)(c.default,{style:ut.infoText,children:"Fecha y hora: Se registrar\xe1n autom\xe1ticamente"})]})]}),(0,w.jsx)(h.default,{style:[ut.button,(t||!j.idequipo)&&ut.buttonDisabled],onPress:async()=>{if(j.idequipo)if(v){o(!0),q(!1),E(!1);try{const t=new Date,o=t.toISOString().split("T")[0],a=t.toTimeString().substring(0,8),{data:r,error:n}=await b.supabase.from("historial_mantenimiento").insert([{idequipo:parseInt(j.idequipo),idusuario_registro:v.id,fechamantenimiento:o,horamantenimiento:a,tipomantenimiento:j.tipomantenimiento,observaciones:j.observaciones||null,accion:"Registro inicial"}]).select();if(n)throw n;const{data:i,error:l}=await b.supabase.from("mantenimiento").insert([{idequipo:parseInt(j.idequipo),idusuario_registro:v.id,tipomantenimiento:j.tipomantenimiento.toLowerCase(),observaciones:j.observaciones||null,estado:"en mantenimiento"}]).select();if(l)throw l;const{error:s}=await b.supabase.from("equipos").update({estado:"en mantenimiento"}).eq("idequipo",parseInt(j.idequipo));if(s)throw s;I("Mantenimiento registrado correctamente"),q(!0),setTimeout((()=>q(!1)),3e3),C({idequipo:"",tipomantenimiento:"Preventivo",observaciones:""}),F(),setTimeout((()=>{e.goBack()}),2e3)}catch(t){console.error("Error al registrar mantenimiento:",t);let e="Error al registrar el mantenimiento";t.message.includes("El equipo ya no est\xe1 disponible")?e="El equipo ya no est\xe1 disponible":t.message.includes("duplicate key value")?e="Ya existe un mantenimiento para este equipo":t.message.includes("foreign key constraint")?e="Error: Datos inv\xe1lidos":"23502"===t.code&&(e="Faltan datos requeridos"),A(e)}finally{o(!1)}}else A("No se pudo identificar al usuario");else A("Por favor seleccione un equipo disponible")},disabled:t||!j.idequipo,children:t?(0,w.jsx)(f.default,{color:"#fff"}):(0,w.jsxs)(d.default,{style:ut.buttonContent,children:[(0,w.jsx)(z.default,{name:"toolbox",size:20,color:"#fff"}),(0,w.jsx)(c.default,{style:ut.buttonText,children:"Registrar Mantenimiento"})]})})]})]})})})]}),!1,!1]})},{width:ht}=x.default.get("window"),mt=ht<768,gt=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:mt?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},refreshButton:{marginLeft:16},headerTitle:{fontSize:mt?18:20,fontWeight:"600",color:"#2c3e50",flex:1,textAlign:"center"},scrollContent:{flexGrow:1,paddingBottom:24},content:{width:"100%",maxWidth:1200,alignSelf:"center",paddingHorizontal:mt?16:24},card:{backgroundColor:"#ffffff",borderRadius:12,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},cardHeader:{padding:mt?16:20,borderBottomWidth:1,borderBottomColor:"#e0e0e0"},cardTitle:{fontSize:mt?16:18,fontWeight:"600",color:"#2c3e50"},cardBody:{padding:mt?16:20},formGroup:{marginBottom:20},label:{fontSize:14,color:"#6c757d",marginBottom:8,fontWeight:"500"},pickerContainer:{borderWidth:1,borderColor:"#ced4da",borderRadius:6,overflow:"hidden"},picker:{height:50,width:"100%",color:"#495057"},infoBox:{flexDirection:"row",alignItems:"center",backgroundColor:"#e7f1ff",padding:12,borderRadius:6,borderLeftWidth:4,borderLeftColor:"#3B82F6"},infoTextContainer:{marginLeft:10},infoText:{color:"#1E40AF",fontSize:14,lineHeight:20},textInput:{borderWidth:1,borderColor:"#ced4da",borderRadius:6,padding:12,minHeight:100,textAlignVertical:"top",backgroundColor:"#ffffff"},loadingContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:10},loadingText:{marginLeft:10,color:"#64748B"},button:{backgroundColor:"#4a6da7",borderRadius:6,padding:14,alignItems:"center",justifyContent:"center",marginTop:10,flexDirection:"row"},buttonContent:{flexDirection:"row",alignItems:"center"},buttonText:{color:"#ffffff",fontSize:16,fontWeight:"600",marginLeft:10},buttonDisabled:{backgroundColor:"#95a5a6",opacity:.7},webSuccessMessage:{position:"fixed",top:20,left:"50%",transform:[{translateX:-180}],width:360,backgroundColor:"#D1FAE5",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},webSuccessText:{color:"#065F46",marginLeft:10,fontSize:14,fontWeight:"500"},webErrorMessage:{position:"fixed",top:20,left:"50%",transform:[{translateX:-180}],width:360,backgroundColor:"#FEE2E2",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},webErrorText:{color:"#B91C1C",marginLeft:10,fontSize:14,fontWeight:"500"},mobileSuccessMessage:{position:"absolute",bottom:20,left:20,right:20,backgroundColor:"#D1FAE5",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},mobileErrorMessage:{position:"absolute",bottom:20,left:20,right:20,backgroundColor:"#FEE2E2",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},mobileMessageText:{marginLeft:10,fontSize:14,fontWeight:"500"}}),pt=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)([]),[u,p]=(0,n.useState)({idhistorialmantenimiento:"",observaciones:""}),[x,y]=(0,n.useState)(null),[j,C]=(0,n.useState)(!1),[v,S]=(0,n.useState)(""),[T,q]=(0,n.useState)(!1),[k,I]=(0,n.useState)("");(0,n.useEffect)((()=>{(async()=>{const{data:{user:e},error:t}=await b.supabase.auth.getUser();t?P("Error obteniendo usuario"):y(e)})()}),[]),(0,n.useEffect)((()=>{R()}),[]);const R=async()=>{try{r(!0);const{data:e,error:t}=await b.supabase.from("historial_mantenimiento").select("\n          idhistorialmantenimiento, \n          idequipo, \n          fechamantenimiento,\n          horamantenimiento,\n          tipomantenimiento,\n          equipos:equipos(nombreequipo),\n          usuarios:usuarios(nombreusuario)\n        ").is("horadevolucion",null).order("fechamantenimiento",{ascending:!1});if(t)throw t;s(e||[])}catch(e){P("No se pudieron cargar los mantenimientos activos"),console.error("Error fetching maintenance:",e)}finally{r(!1)}},E=(e,t)=>{p((o=>Object.assign({},o,{[e]:t})))},P=e=>{I(e),q(!0),setTimeout((()=>q(!1)),3e3),console.error(e)};return(0,w.jsxs)(g.default,{style:gt.safeArea,children:[(0,w.jsxs)(d.default,{style:gt.container,children:[(0,w.jsxs)(d.default,{style:gt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:gt.menuButton,children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:gt.headerTitle,children:"Devolver Equipo de Mantenimiento"}),(0,w.jsx)(h.default,{onPress:R,style:gt.refreshButton,children:(0,w.jsx)(B.default,{name:"refresh",size:24,color:"#2c3e50"})})]}),j&&(0,w.jsxs)(d.default,{style:gt.webSuccessMessage,children:[(0,w.jsx)(B.default,{name:"check-circle",size:20,color:"#10B981"}),(0,w.jsx)(c.default,{style:gt.webSuccessText,children:v})]}),T&&(0,w.jsxs)(d.default,{style:gt.webErrorMessage,children:[(0,w.jsx)(B.default,{name:"error",size:20,color:"#EF4444"}),(0,w.jsx)(c.default,{style:gt.webErrorText,children:k})]}),(0,w.jsx)(m.default,{contentContainerStyle:gt.scrollContent,showsVerticalScrollIndicator:!1,keyboardShouldPersistTaps:"handled",children:(0,w.jsx)(d.default,{style:gt.content,children:(0,w.jsxs)(d.default,{style:gt.card,children:[(0,w.jsx)(d.default,{style:gt.cardHeader,children:(0,w.jsx)(c.default,{style:gt.cardTitle,children:"Registrar Devoluci\xf3n"})}),(0,w.jsxs)(d.default,{style:gt.cardBody,children:[(0,w.jsxs)(d.default,{style:gt.formGroup,children:[(0,w.jsx)(c.default,{style:gt.label,children:"Mantenimiento Activo *"}),a?(0,w.jsxs)(d.default,{style:gt.loadingContainer,children:[(0,w.jsx)(f.default,{size:"small",color:"#3B82F6"}),(0,w.jsx)(c.default,{style:gt.loadingText,children:"Cargando mantenimientos..."})]}):(0,w.jsx)(d.default,{style:gt.pickerContainer,children:(0,w.jsxs)(st.Picker,{selectedValue:u.idhistorialmantenimiento,onValueChange:e=>E("idhistorialmantenimiento",e),style:gt.picker,dropdownIconColor:"#666",children:[(0,w.jsx)(st.Picker.Item,{label:"Seleccione un mantenimiento",value:""}),l.map((e=>(0,w.jsx)(st.Picker.Item,{label:`${e.equipos.nombreequipo} - ${new Date(e.fechamantenimiento).toLocaleDateString()} (${e.tipomantenimiento})`,value:e.idhistorialmantenimiento.toString()},e.idhistorialmantenimiento)))]})})]}),(0,w.jsxs)(d.default,{style:gt.formGroup,children:[(0,w.jsx)(c.default,{style:gt.label,children:"Informaci\xf3n de devoluci\xf3n"}),(0,w.jsxs)(d.default,{style:gt.infoBox,children:[(0,w.jsx)(B.default,{name:"info-outline",size:20,color:"#3B82F6"}),(0,w.jsxs)(d.default,{style:gt.infoTextContainer,children:[(0,w.jsx)(c.default,{style:gt.infoText,children:"Fecha y hora: El sistema registrar\xe1 autom\xe1ticamente"}),(0,w.jsxs)(c.default,{style:gt.infoText,children:["Usuario: ",x?.email||"Usuario actual"]})]})]})]}),(0,w.jsxs)(d.default,{style:gt.formGroup,children:[(0,w.jsx)(c.default,{style:gt.label,children:"Observaciones"}),(0,w.jsx)(D.default,{style:gt.textInput,multiline:!0,numberOfLines:4,placeholder:"Describa las observaciones del mantenimiento...",value:u.observaciones,onChangeText:e=>E("observaciones",e)})]}),(0,w.jsx)(h.default,{style:[gt.button,(t||!u.idhistorialmantenimiento)&&gt.buttonDisabled],onPress:async()=>{if(u.idhistorialmantenimiento)if(x){o(!0),C(!1),q(!1);try{const t=new Date,o=t.toTimeString().substring(0,8),{data:a,error:r}=await b.supabase.from("historial_mantenimiento").update({horadevolucion:o,observaciones:u.observaciones||null,accion:"Mantenimiento completado"}).eq("idhistorialmantenimiento",parseInt(u.idhistorialmantenimiento)).select().single();if(r)throw r;const n=l.find((e=>e.idhistorialmantenimiento.toString()===u.idhistorialmantenimiento));if(!n)throw new Error("No se encontr\xf3 el mantenimiento seleccionado");const{error:i}=await b.supabase.from("equipos").update({estado:"disponible"}).eq("idequipo",n.idequipo);if(i)throw i;const{error:s}=await b.supabase.from("mantenimiento").update({estado:"completado",fechafin:t.toISOString()}).eq("idequipo",n.idequipo).eq("estado","en mantenimiento");if(s)throw s;S("Devoluci\xf3n registrada correctamente"),C(!0),setTimeout((()=>C(!1)),3e3),p({idhistorialmantenimiento:"",observaciones:""}),R(),setTimeout((()=>{e.goBack()}),2e3)}catch(t){console.error("Error al registrar devoluci\xf3n:",t);let e="Error al registrar la devoluci\xf3n";t.message.includes("No se encontr\xf3 el mantenimiento")?e="Mantenimiento no encontrado":t.message.includes("foreign key constraint")?e="Error: Datos inv\xe1lidos":"23502"===t.code&&(e="Faltan datos requeridos"),P(e)}finally{o(!1)}}else P("No se pudo identificar al usuario");else P("Por favor seleccione un mantenimiento")},disabled:t||!u.idhistorialmantenimiento,children:t?(0,w.jsx)(f.default,{color:"#fff"}):(0,w.jsxs)(d.default,{style:gt.buttonContent,children:[(0,w.jsx)(z.default,{name:"check-circle",size:20,color:"#fff"}),(0,w.jsx)(c.default,{style:gt.buttonText,children:"Registrar Devoluci\xf3n"})]})})]})]})})})]}),!1,!1]})},{width:xt}=x.default.get("window"),bt=xt<768,yt=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa",alignSelf:"center",width:"100%"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:bt?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:bt?18:20,fontWeight:"600",color:"#2c3e50",flex:1},buttonGroup:{flexDirection:"row",alignItems:"center"},directorButton:{backgroundColor:"#4a6da7",borderRadius:4,marginRight:8,minWidth:40},tecnicoButton:{backgroundColor:"#8e44ad",borderRadius:4,marginRight:8,minWidth:40},printButton:{backgroundColor:"#27ae60",borderRadius:4,minWidth:40},buttonLabel:{color:"#FFF",marginVertical:6,marginHorizontal:0},filterContainer:{padding:16,backgroundColor:"#ffffff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},filterRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},filterLabel:{fontSize:14,color:"#6c757d"},filterToggle:{flexDirection:"row",alignItems:"center"},filterToggleText:{marginLeft:8,color:"#95a5a6"},filterToggleActive:{color:"#4a6da7",fontWeight:"600"},dateFilterContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},dateInput:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:"#ced4da",borderRadius:6,padding:12,flex:1,marginHorizontal:5},dateText:{marginLeft:8,color:"#495057"},dateSeparator:{marginHorizontal:8,color:"#6c757d"},webDateInput:{marginLeft:8,border:"none",outline:"none",fontSize:14,color:"#495057",fontFamily:"inherit",backgroundColor:"transparent",width:"100%"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},modalContent:{backgroundColor:"#FFF",borderRadius:8,padding:20,width:bt?"90%":"40%"},modalTitle:{fontSize:18,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},input:{borderWidth:1,borderColor:"#ced4da",borderRadius:6,padding:12,marginBottom:20,fontSize:16},modalButtons:{flexDirection:"row",justifyContent:"space-between"},cancelButton:{borderColor:"#95a5a6",flex:1,marginRight:10},cancelButtonText:{color:"#95a5a6"},saveButton:{backgroundColor:"#4a6da7",flex:1},saveButtonText:{color:"#FFF"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},listContent:{padding:bt?8:16},card:{backgroundColor:"#FFF",borderRadius:8,padding:16,marginBottom:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:4,elevation:2},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},cardTitle:{fontSize:16,fontWeight:"600",color:"#2c3e50"},statusBadge:{borderRadius:12,paddingVertical:4,paddingHorizontal:10},statusText:{fontSize:12,fontWeight:"500",color:"#FFF"},detailRow:{flexDirection:"row",alignItems:"center",marginVertical:4},detailText:{fontSize:14,color:"#6c757d",marginLeft:8},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:16,color:"#95a5a6",marginTop:16,textAlign:"center"}}),jt=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),[u,m]=(0,n.useState)("Lic. Juan P\xe9rez"),[x,y]=(0,n.useState)("T\xe9cnico Mantenimiento"),[j,C]=(0,n.useState)(!1),[v,S]=(0,n.useState)(!1),[T,q]=(0,n.useState)(""),[k,I]=(0,n.useState)(""),[R,O]=(0,n.useState)(new Date),[F,W]=(0,n.useState)(new Date),[A,L]=(0,n.useState)(!1),[N,H]=(0,n.useState)(!1),[V,M]=(0,n.useState)(!0),_=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,$=(e,t)=>{const o=e.split("-");t(new Date(o[0],o[1]-1,o[2])),U()};(0,n.useEffect)((()=>{(async()=>{try{const e=await De.default.getItem("@director_name"),t=await De.default.getItem("@tecnico_name");e&&m(e),t&&y(t)}catch(e){console.error("Error al cargar nombres:",e)}})(),U()}),[]);const U=async()=>{r(!0),s(!0);try{let e=b.supabase.from("historial_mantenimiento").select("\n          idhistorialmantenimiento,\n          fechamantenimiento,\n          horamantenimiento,\n          horadevolucion,\n          tipomantenimiento,\n          observaciones,\n          accion,\n          equipos:equipos(nombreequipo),\n          usuarios:usuarios(nombreusuario)\n        ").gte("fechamantenimiento",R.toISOString().split("T")[0]).lte("fechamantenimiento",F.toISOString().split("T")[0]).order("fechamantenimiento",{ascending:!1});V&&(e=e.not("horadevolucion","is",null));const{data:t,error:a}=await e;if(a)throw a;o(t||[])}catch(e){p.default.alert("Error","No se pudieron cargar los reportes"),console.error("Error fetching reports:",e)}finally{r(!1),s(!1)}};return(0,w.jsx)(g.default,{style:yt.safeArea,children:(0,w.jsxs)(d.default,{style:[yt.container,{maxWidth:1200}],children:[(0,w.jsxs)(d.default,{style:yt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:yt.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:yt.headerTitle,children:"Reporte de Mantenimientos"}),(0,w.jsxs)(d.default,{style:yt.buttonGroup,children:[(0,w.jsx)(Oe.default,{mode:"contained",onPress:()=>{q(u),C(!0)},style:yt.directorButton,labelStyle:yt.buttonLabel,children:(0,w.jsx)(B.default,{name:"edit",size:18,color:"#FFF"})}),(0,w.jsx)(Oe.default,{mode:"contained",onPress:()=>{I(x),S(!0)},style:yt.tecnicoButton,labelStyle:yt.buttonLabel,children:(0,w.jsx)(z.default,{name:"account-wrench",size:18,color:"#FFF"})}),(0,w.jsx)(Oe.default,{mode:"contained",onPress:async()=>{try{const e=`\n        <html>\n          <head>\n            <meta charset="UTF-8">\n            <style>\n              body { font-family: Arial; padding: 20px; margin: 0; }\n              .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #eee; }\n              .logo { max-width: 200px; max-height: 100px; margin-bottom: 15px; }\n              h1 { color: #2c3e50; margin: 5px 0; font-size: 24px; }\n              .subtitle { color: #7f8c8d; font-size: 14px; }\n              .date-range { margin: 10px 0; font-size: 14px; color: #34495e; }\n              .filter-info { margin: 10px 0; font-size: 14px; font-style: italic; }\n              table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px; }\n              th, td { padding: 12px 8px; border: 1px solid #ddd; text-align: left; }\n              th { background-color: #f8f9fa; font-weight: bold; color: #34495e; }\n              .firma-container { margin-top: 60px; text-align: center; }\n              .linea-firma { width: 300px; border-top: 1px solid #000; margin: 10px auto; }\n              .nombre-director { font-weight: bold; margin-top: 5px; font-size: 16px; }\n              .cargo-director { font-style: italic; color: #7f8c8d; }\n              .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #95a5a6; border-top: 1px solid #eee; padding-top: 15px; }\n              @media print { body { padding: 0; } .no-print { display: none; } }\n            </style>\n          </head>\n          <body>\n            <div class="header">\n              <img src="https://utregionaldelsur.sidci.mx/img/logo.png" class="logo" alt="Logo de la escuela">\n              <h1>Reporte de Mantenimientos ${V?"Completados":""}</h1>\n              <p class="subtitle">Generado el: ${(new Date).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}</p>\n              <p class="date-range">\n                Per\xedodo: ${R.toLocaleDateString("es-ES")} - ${F.toLocaleDateString("es-ES")}\n              </p>\n              <p class="filter-info">\n                Mostrando: ${V?"Solo mantenimientos completados":"Todos los mantenimientos"}\n              </p>\n            </div>\n            \n            <table>\n              <thead>\n                <tr>\n                  <th>Equipo</th>\n                  <th>Tipo</th>\n                  <th>Fecha</th>\n                  <th>Hora Devoluci\xf3n</th>\n                  <th>T\xe9cnico</th>\n                  <th>Acciones</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${t.map((e=>`\n                  <tr>\n                    <td>${e.equipos?.nombreequipo||"N/A"}</td>\n                    <td>${e.tipomantenimiento}</td>\n                    <td>${new Date(e.fechamantenimiento).toLocaleDateString("es-ES")}</td>\n                    <td>${e.horadevolucion||"N/A"}</td>\n                    <td>${x}</td>\n                    <td>${e.accion||"N/A"}</td>\n                  </tr>\n                `)).join("")}\n              </tbody>\n            </table>\n            \n            <div class="firma-container">\n              <div class="linea-firma"></div>\n              <div class="nombre-director">${u}</div>\n              <div class="cargo-director">Director de Carrera</div>\n            </div>\n            \n            <div class="footer">\n              <p>Sistema de Gesti\xf3n de Mantenimientos - ${(new Date).getFullYear()}</p>\n              <p>Documento generado autom\xe1ticamente - V\xe1lido sin firma manuscrita</p>\n            </div>\n          </body>\n        </html>\n      `;{const t=window.open("","_blank");t.document.write(e),t.document.close(),t.focus(),setTimeout((()=>t.print()),500)}}catch(e){p.default.alert("Error","No se pudo generar el documento"),console.error("Error generating document:",e)}},style:yt.printButton,labelStyle:yt.buttonLabel,children:(0,w.jsx)(B.default,{name:"print",size:18,color:"#FFF"})})]})]}),(0,w.jsxs)(d.default,{style:yt.filterContainer,children:[(0,w.jsxs)(d.default,{style:yt.filterRow,children:[(0,w.jsx)(c.default,{style:yt.filterLabel,children:"Rango de fechas:"}),(0,w.jsxs)(h.default,{style:yt.filterToggle,onPress:()=>{M(!V),U()},children:[(0,w.jsx)(z.default,{name:V?"checkbox-marked-circle-outline":"checkbox-blank-circle-outline",size:24,color:V?"#4a6da7":"#95a5a6"}),(0,w.jsx)(c.default,{style:[yt.filterToggleText,V&&yt.filterToggleActive],children:"Solo completados"})]})]}),(0,w.jsx)(d.default,{style:yt.dateFilterContainer,children:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(d.default,{style:yt.dateInput,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:16,color:"#4a6da7"}),(0,w.jsx)("input",{type:"date",value:_(R),onChange:e=>$(e.target.value,O),style:yt.webDateInput,max:_(new Date)})]}),(0,w.jsx)(c.default,{style:yt.dateSeparator,children:"a"}),(0,w.jsxs)(d.default,{style:yt.dateInput,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:16,color:"#4a6da7"}),(0,w.jsx)("input",{type:"date",value:_(F),onChange:e=>$(e.target.value,W),style:yt.webDateInput,min:_(R),max:_(new Date)})]})]})})]}),(0,w.jsx)(E.default,{visible:j,transparent:!0,animationType:"slide",onRequestClose:()=>C(!1),children:(0,w.jsx)(d.default,{style:yt.modalContainer,children:(0,w.jsxs)(d.default,{style:yt.modalContent,children:[(0,w.jsx)(c.default,{style:yt.modalTitle,children:"Cambiar Nombre del Director"}),(0,w.jsx)(D.default,{style:yt.input,value:T,onChangeText:q,placeholder:"Ingrese el nombre completo",placeholderTextColor:"#95a5a6",autoFocus:!0}),(0,w.jsxs)(d.default,{style:yt.modalButtons,children:[(0,w.jsx)(Oe.default,{mode:"outlined",onPress:()=>C(!1),style:yt.cancelButton,labelStyle:yt.cancelButtonText,children:"Cancelar"}),(0,w.jsx)(Oe.default,{mode:"contained",onPress:async()=>{if(T.trim())try{await De.default.setItem("@director_name",T),m(T),C(!1),p.default.alert("\xc9xito","Nombre del director actualizado correctamente")}catch(e){p.default.alert("Error","No se pudo actualizar el nombre del director")}else p.default.alert("Error","Por favor ingrese un nombre v\xe1lido")},style:yt.saveButton,labelStyle:yt.saveButtonText,children:"Guardar"})]})]})})}),(0,w.jsx)(E.default,{visible:v,transparent:!0,animationType:"slide",onRequestClose:()=>S(!1),children:(0,w.jsx)(d.default,{style:yt.modalContainer,children:(0,w.jsxs)(d.default,{style:yt.modalContent,children:[(0,w.jsx)(c.default,{style:yt.modalTitle,children:"Cambiar Nombre del T\xe9cnico"}),(0,w.jsx)(D.default,{style:yt.input,value:k,onChangeText:I,placeholder:"Ingrese el nombre del t\xe9cnico",placeholderTextColor:"#95a5a6",autoFocus:!0}),(0,w.jsxs)(d.default,{style:yt.modalButtons,children:[(0,w.jsx)(Oe.default,{mode:"outlined",onPress:()=>S(!1),style:yt.cancelButton,labelStyle:yt.cancelButtonText,children:"Cancelar"}),(0,w.jsx)(Oe.default,{mode:"contained",onPress:async()=>{if(k.trim())try{await De.default.setItem("@tecnico_name",k),y(k),S(!1),p.default.alert("\xc9xito","Nombre del t\xe9cnico actualizado correctamente")}catch(e){p.default.alert("Error","No se pudo actualizar el nombre del t\xe9cnico")}else p.default.alert("Error","Por favor ingrese un nombre v\xe1lido")},style:yt.saveButton,labelStyle:yt.saveButtonText,children:"Guardar"})]})]})})}),a?(0,w.jsxs)(d.default,{style:yt.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#3498db"}),(0,w.jsx)(c.default,{style:yt.loadingText,children:"Cargando reportes de mantenimiento..."})]}):(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsxs)(d.default,{style:yt.card,children:[(0,w.jsxs)(d.default,{style:yt.cardHeader,children:[(0,w.jsx)(d.default,{children:(0,w.jsx)(c.default,{style:yt.cardTitle,children:e.equipos?.nombreequipo||"Equipo no encontrado"})}),(0,w.jsx)(d.default,{style:[yt.statusBadge,{backgroundColor:e.horadevolucion?"#2ecc71":"#e74c3c"}],children:(0,w.jsx)(c.default,{style:yt.statusText,children:e.horadevolucion?"COMPLETADO":"PENDIENTE"})})]}),(0,w.jsxs)(d.default,{style:yt.detailRow,children:[(0,w.jsx)(z.default,{name:"toolbox-outline",size:16,color:"#4a6da7"}),(0,w.jsxs)(c.default,{style:yt.detailText,children:["Tipo: ",e.tipomantenimiento]})]}),(0,w.jsxs)(d.default,{style:yt.detailRow,children:[(0,w.jsx)(B.default,{name:"date-range",size:16,color:"#4a6da7"}),(0,w.jsxs)(c.default,{style:yt.detailText,children:["Fecha: ",new Date(e.fechamantenimiento).toLocaleDateString("es-ES")]})]}),e.horadevolucion?(0,w.jsxs)(d.default,{style:yt.detailRow,children:[(0,w.jsx)(z.default,{name:"clock-check-outline",size:16,color:"#4a6da7"}),(0,w.jsxs)(c.default,{style:yt.detailText,children:["Devoluci\xf3n: ",e.horadevolucion]})]}):(0,w.jsxs)(d.default,{style:yt.detailRow,children:[(0,w.jsx)(B.default,{name:"access-time",size:16,color:"#4a6da7"}),(0,w.jsxs)(c.default,{style:yt.detailText,children:["Hora inicio: ",e.horamantenimiento]})]}),(0,w.jsxs)(d.default,{style:yt.detailRow,children:[(0,w.jsx)(B.default,{name:"person-outline",size:16,color:"#4a6da7"}),(0,w.jsxs)(c.default,{style:yt.detailText,children:["T\xe9cnico: ",x]})]}),e.accion&&(0,w.jsxs)(d.default,{style:yt.detailRow,children:[(0,w.jsx)(z.default,{name:"hammer-wrench",size:16,color:"#4a6da7"}),(0,w.jsxs)(c.default,{style:yt.detailText,children:["Acciones: ",e.accion]})]}),e.observaciones&&(0,w.jsxs)(d.default,{style:yt.detailRow,children:[(0,w.jsx)(B.default,{name:"notes",size:16,color:"#4a6da7"}),(0,w.jsxs)(c.default,{style:yt.detailText,children:["Observaciones: ",e.observaciones]})]})]}),keyExtractor:e=>e.idhistorialmantenimiento.toString(),contentContainerStyle:yt.listContent,refreshControl:(0,w.jsx)(fe.default,{refreshing:l,onRefresh:U,colors:["#3498db"],tintColor:"#3498db"}),ListEmptyComponent:(0,w.jsxs)(d.default,{style:yt.emptyContainer,children:[(0,w.jsx)(z.default,{name:"tools",size:48,color:"#ecf0f1"}),(0,w.jsx)(c.default,{style:yt.emptyText,children:V?"No hay mantenimientos completados en el per\xedodo seleccionado":"No se encontraron mantenimientos en el per\xedodo seleccionado"})]})})]})})},{width:wt}=x.default.get("window"),Ct=wt<768,vt=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,paddingHorizontal:Ct?16:24},header:{flexDirection:"row",alignItems:"center",paddingVertical:16,marginBottom:20},menuButton:{marginRight:16},headerTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50"},scrollContent:{paddingBottom:24},card:{backgroundColor:"#ffffff",borderRadius:12,padding:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:6,elevation:2},form:{width:"100%"},label:{fontSize:14,color:"#4a5568",marginBottom:8,fontWeight:"500"},input:{height:50,borderWidth:1,borderColor:"#e2e8f0",borderRadius:8,paddingHorizontal:15,marginBottom:20,backgroundColor:"#f8fafc",fontSize:16},registerButton:{backgroundColor:"#4a6da7",paddingVertical:15,borderRadius:8,alignItems:"center",justifyContent:"center",marginTop:10},buttonText:{color:"white",fontSize:16,fontWeight:"600"},successContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},successTitle:{fontSize:22,fontWeight:"bold",color:"#2e7d32",marginVertical:16},successText:{fontSize:16,color:"#333",textAlign:"center",marginBottom:8},emailText:{fontWeight:"bold",color:"#1a237e",marginBottom:16,fontSize:16},successSubtext:{fontSize:14,color:"#666",textAlign:"center",marginBottom:24},successButton:{backgroundColor:"#4a6da7",paddingVertical:15,paddingHorizontal:30,borderRadius:8},successButtonText:{color:"white",fontSize:16,fontWeight:"600"}}),St=({navigation:e})=>{const[t,o]=(0,n.useState)(""),[a,r]=(0,n.useState)(""),[i,l]=(0,n.useState)(""),[s,u]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1);return p?(0,w.jsx)(g.default,{style:vt.safeArea,children:(0,w.jsxs)(d.default,{style:vt.container,children:[(0,w.jsxs)(d.default,{style:vt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:vt.menuButton,children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:vt.headerTitle,children:"Registro Exitoso"})]}),(0,w.jsxs)(d.default,{style:vt.successContainer,children:[(0,w.jsx)(B.default,{name:"check-circle",size:60,color:"#4CAF50"}),(0,w.jsx)(c.default,{style:vt.successTitle,children:"\xa1Registro completado!"}),(0,w.jsx)(c.default,{style:vt.successText,children:"Se ha enviado un enlace de verificaci\xf3n al correo:"}),(0,w.jsx)(c.default,{style:vt.emailText,children:t}),(0,w.jsx)(c.default,{style:vt.successSubtext,children:"Por favor revise su bandeja de entrada y spam para confirmar la cuenta."}),(0,w.jsx)(h.default,{style:vt.successButton,onPress:()=>x(!1),children:(0,w.jsx)(c.default,{style:vt.successButtonText,children:"Registrar otro administrador"})})]})]})}):(0,w.jsx)(g.default,{style:vt.safeArea,children:(0,w.jsxs)(d.default,{style:vt.container,children:[(0,w.jsxs)(d.default,{style:vt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:vt.menuButton,children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:vt.headerTitle,children:"Registrar Nuevo Administrador"})]}),(0,w.jsx)(m.default,{contentContainerStyle:vt.scrollContent,children:(0,w.jsx)(d.default,{style:vt.card,children:(0,w.jsxs)(d.default,{style:vt.form,children:[(0,w.jsx)(c.default,{style:vt.label,children:"Nombre completo"}),(0,w.jsx)(D.default,{style:vt.input,placeholder:"Nombre del administrador",value:i,onChangeText:l}),(0,w.jsx)(c.default,{style:vt.label,children:"Correo electr\xf3nico"}),(0,w.jsx)(D.default,{style:vt.input,placeholder:"admin@institucion.edu",value:t,onChangeText:o,keyboardType:"email-address",autoCapitalize:"none"}),(0,w.jsx)(c.default,{style:vt.label,children:"Contrase\xf1a"}),(0,w.jsx)(D.default,{style:vt.input,placeholder:"M\xednimo 6 caracteres",value:a,onChangeText:r,secureTextEntry:!0}),(0,w.jsx)(h.default,{style:vt.registerButton,onPress:async()=>{if(t&&a&&i){u(!0);try{const{error:e}=await b.supabase.auth.signUp({email:t,password:a,options:{data:{username:i}}});if(e)throw e;x(!0),o(""),r(""),l("")}catch(e){console.log("Error en registro:",e)}finally{u(!1)}}},disabled:s,children:s?(0,w.jsx)(f.default,{color:"#FFF"}):(0,w.jsx)(c.default,{style:vt.buttonText,children:"Registrar Administrador"})})]})})})]})})},{width:Tt}=x.default.get("window"),Bt=Tt<768,zt=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},unauthorizedContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},unauthorizedContent:{width:"90%",maxWidth:400,alignItems:"center",padding:24,backgroundColor:"#FFFFFF",borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:2},unauthorizedTitle:{fontSize:20,fontWeight:"bold",color:"#EF4444",marginTop:16,marginBottom:8},unauthorizedText:{fontSize:16,color:"#64748B",textAlign:"center",marginBottom:24},backButton:{backgroundColor:"#3B82F6",paddingVertical:12,paddingHorizontal:24,borderRadius:8,width:"100%",alignItems:"center"},backButtonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:Bt?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:Bt?18:20,fontWeight:"600",color:"#2c3e50"},container:{flexGrow:1,padding:Bt?16:24,backgroundColor:"#f8f9fa"},webMessage:{backgroundColor:"#EFF6FF",padding:12,borderRadius:8,marginBottom:16,borderLeftWidth:4,borderLeftColor:"#3B82F6"},webMessageText:{color:"#1E40AF",fontSize:14},webSuccessMessage:{position:"fixed",top:20,left:"50%",transform:[{translateX:-180}],width:360,backgroundColor:"#D1FAE5",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},webSuccessText:{color:"#065F46",marginLeft:10,fontSize:14,fontWeight:"500"},card:{backgroundColor:"#FFFFFF",borderRadius:12,padding:Bt?20:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,maxWidth:800,width:"100%",alignSelf:"center"},title:{fontSize:Bt?20:24,fontWeight:"bold",color:"#111827",marginBottom:24,textAlign:"center"},formGroup:{marginBottom:20},label:{fontSize:16,color:"#374151",marginBottom:8,fontWeight:"500"},input:{height:50,borderWidth:1,borderColor:"#D1D5DB",borderRadius:8,paddingHorizontal:16,fontSize:16,color:"#111827",backgroundColor:"#F9FAFB"},pickerButton:{height:50,borderWidth:1,borderColor:"#D1D5DB",borderRadius:8,paddingHorizontal:16,justifyContent:"space-between",alignItems:"center",flexDirection:"row",backgroundColor:"#F9FAFB"},pickerButtonText:{fontSize:16,color:"#111827"},pickerOptions:{marginTop:8,borderWidth:1,borderColor:"#E5E7EB",borderRadius:8,overflow:"hidden"},pickerOption:{paddingVertical:12,paddingHorizontal:16,backgroundColor:"#FFFFFF",borderBottomWidth:1,borderBottomColor:"#E5E7EB"},selectedPickerOption:{backgroundColor:"#EFF6FF"},pickerOptionText:{fontSize:16,color:"#374151"},selectedPickerOptionText:{color:"#1D4ED8",fontWeight:"500"},button:{height:50,backgroundColor:"#3B82F6",borderRadius:8,justifyContent:"center",alignItems:"center",marginTop:24},buttonDisabled:{opacity:.7},buttonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600"}}),qt=({navigation:e})=>{const[t,o]=(0,n.useState)(""),[a,r]=(0,n.useState)("maestro"),[i,l]=(0,n.useState)(!1),[s,u]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1),[y,j]=(0,n.useState)(!1),[C,v]=(0,n.useState)(""),S=[{value:"maestro",label:"Maestro"},{value:"directivo",label:"Directivo"},{value:"invitado",label:"Invitado"}];(0,n.useEffect)((()=>{(async()=>{const{data:{user:e}}=await b.supabase.auth.getUser();if(e){const{data:t,error:o}=await b.supabase.from("usuarios").select("rol").eq("idusuario",e.id).single();!o&&t&&"admin"===t.rol&&x(!0)}})()}),[]);const T=(e,t)=>{v(t),j(!0),setTimeout((()=>j(!1)),3e3)};return p?(0,w.jsxs)(g.default,{style:zt.safeArea,children:[(0,w.jsxs)(d.default,{style:zt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:zt.menuButton,children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:zt.headerTitle,children:"Agregar Personal"})]}),y&&(0,w.jsxs)(d.default,{style:zt.webSuccessMessage,children:[(0,w.jsx)(B.default,{name:"check-circle",size:20,color:"#10B981"}),(0,w.jsx)(c.default,{style:zt.webSuccessText,children:C})]}),(0,w.jsxs)(m.default,{contentContainerStyle:zt.container,children:[(0,w.jsx)(d.default,{style:zt.webMessage,children:(0,w.jsx)(c.default,{style:zt.webMessageText,children:"Est\xe1s utilizando la versi\xf3n web del sistema de administraci\xf3n"})}),(0,w.jsxs)(d.default,{style:zt.card,children:[(0,w.jsx)(c.default,{style:zt.title,children:"Agregar Nuevo Personal"}),(0,w.jsxs)(d.default,{style:zt.formGroup,children:[(0,w.jsx)(c.default,{style:zt.label,children:"Nombre Completo"}),(0,w.jsx)(D.default,{style:zt.input,placeholder:"Ej: Juan P\xe9rez L\xf3pez",value:t,onChangeText:o,maxLength:100})]}),(0,w.jsxs)(d.default,{style:zt.formGroup,children:[(0,w.jsx)(c.default,{style:zt.label,children:"Cargo"}),(0,w.jsxs)(h.default,{style:zt.pickerButton,onPress:()=>u(!s),children:[(0,w.jsx)(c.default,{style:zt.pickerButtonText,children:S.find((e=>e.value===a))?.label}),(0,w.jsx)(B.default,{name:s?"keyboard-arrow-up":"keyboard-arrow-down",size:24,color:"#64748B"})]}),s&&(0,w.jsx)(d.default,{style:zt.pickerOptions,children:S.map((e=>(0,w.jsx)(h.default,{style:[zt.pickerOption,a===e.value&&zt.selectedPickerOption],onPress:()=>{r(e.value),u(!1)},children:(0,w.jsx)(c.default,{style:[zt.pickerOptionText,a===e.value&&zt.selectedPickerOptionText],children:e.label})},e.value)))})]}),(0,w.jsx)(h.default,{style:[zt.button,i&&zt.buttonDisabled],onPress:async()=>{if(t.trim()){l(!0);try{const{data:e,error:n}=await b.supabase.from("personal").insert([{nombre_completo:t,tipo_persona:a,estado:"activo"}]).select();if(n)throw n;v(`Personal agregado correctamente como ${S.find((e=>e.value===a))?.label}`),j(!0),setTimeout((()=>{o(""),r("maestro"),u(!1),j(!1)}),2e3)}catch(e){let t="Ocurri\xf3 un error al agregar el personal";e.message.includes("duplicate key value")?t="Este nombre de personal ya existe":e.message.includes("permission denied")&&(t="No tienes permisos para realizar esta acci\xf3n"),T(0,t)}finally{l(!1)}}else T(0,"Por favor ingrese el nombre completo")},disabled:i,children:i?(0,w.jsx)(f.default,{color:"#FFF"}):(0,w.jsx)(c.default,{style:zt.buttonText,children:"Agregar Personal"})})]})]})]}):(0,w.jsx)(g.default,{style:zt.unauthorizedContainer,children:(0,w.jsxs)(d.default,{style:zt.unauthorizedContent,children:[(0,w.jsx)(B.default,{name:"warning",size:48,color:"#EF4444"}),(0,w.jsx)(c.default,{style:zt.unauthorizedTitle,children:"Acceso no autorizado"}),(0,w.jsx)(c.default,{style:zt.unauthorizedText,children:"Solo administradores pueden agregar personal"}),(0,w.jsx)(h.default,{style:zt.backButton,onPress:()=>e.goBack(),children:(0,w.jsx)(c.default,{style:zt.backButtonText,children:"Volver al panel"})})]})})},{width:kt}=x.default.get("window"),It=kt<768,Rt=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},unauthorizedContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},unauthorizedContent:{width:"90%",maxWidth:400,alignItems:"center",padding:24,backgroundColor:"#FFFFFF",borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:2},unauthorizedTitle:{fontSize:20,fontWeight:"bold",color:"#EF4444",marginTop:16,marginBottom:8},unauthorizedText:{fontSize:16,color:"#64748B",textAlign:"center",marginBottom:24},backButton:{backgroundColor:"#3B82F6",paddingVertical:12,paddingHorizontal:24,borderRadius:8,width:"100%",alignItems:"center"},backButtonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:It?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:It?18:20,fontWeight:"600",color:"#2c3e50"},container:{flexGrow:1,padding:It?16:24,backgroundColor:"#f8f9fa"},webMessage:{backgroundColor:"#EFF6FF",padding:12,borderRadius:8,marginBottom:16,borderLeftWidth:4,borderLeftColor:"#3B82F6"},webMessageText:{color:"#1E40AF",fontSize:14},webSuccessMessage:{position:"fixed",top:20,left:"50%",transform:[{translateX:-180}],width:360,backgroundColor:"#D1FAE5",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},webSuccessText:{color:"#065F46",marginLeft:10,fontSize:14,fontWeight:"500"},card:{backgroundColor:"#FFFFFF",borderRadius:12,padding:It?16:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,maxWidth:800,width:"100%",alignSelf:"center",marginBottom:16},editForm:{marginTop:16},title:{fontSize:It?20:24,fontWeight:"bold",color:"#111827",marginBottom:24,textAlign:"center"},searchContainer:{flexDirection:"row",marginBottom:16},searchInput:{flex:1,height:50,borderWidth:1,borderColor:"#D1D5DB",borderTopLeftRadius:8,borderBottomLeftRadius:8,paddingHorizontal:16,fontSize:16,color:"#111827",backgroundColor:"#F9FAFB"},searchButton:{width:50,height:50,backgroundColor:"#3B82F6",borderTopRightRadius:8,borderBottomRightRadius:8,justifyContent:"center",alignItems:"center"},loadingContainer:{padding:24,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:16,color:"#64748B"},emptyContainer:{padding:24,justifyContent:"center",alignItems:"center"},emptyText:{marginTop:16,color:"#64748B",fontSize:16},listContainer:{width:"100%"},listContent:{paddingBottom:8},personalItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:16,paddingHorizontal:12,borderBottomWidth:1,borderBottomColor:"#F3F4F6"},selectedPersonalItem:{backgroundColor:"#F0FDF4"},personalInfo:{flex:1},personalName:{fontSize:16,fontWeight:"500",color:"#111827",marginBottom:4},personalDetails:{flexDirection:"row",alignItems:"center"},personalType:{fontSize:14,color:"#64748B",marginRight:12},statusBadge:{paddingHorizontal:8,paddingVertical:2,borderRadius:12},activeBadge:{backgroundColor:"#D1FAE5"},inactiveBadge:{backgroundColor:"#FEE2E2"},statusText:{fontSize:12,fontWeight:"500"},formGroup:{marginBottom:20},label:{fontSize:16,color:"#374151",marginBottom:8,fontWeight:"500"},input:{height:50,borderWidth:1,borderColor:"#D1D5DB",borderRadius:8,paddingHorizontal:16,fontSize:16,color:"#111827",backgroundColor:"#F9FAFB"},pickerButton:{height:50,borderWidth:1,borderColor:"#D1D5DB",borderRadius:8,paddingHorizontal:16,justifyContent:"space-between",alignItems:"center",flexDirection:"row",backgroundColor:"#F9FAFB"},pickerButtonText:{fontSize:16,color:"#111827"},pickerOptions:{marginTop:8,borderWidth:1,borderColor:"#E5E7EB",borderRadius:8,overflow:"hidden"},pickerOption:{paddingVertical:12,paddingHorizontal:16,backgroundColor:"#FFFFFF",borderBottomWidth:1,borderBottomColor:"#E5E7EB"},selectedPickerOption:{backgroundColor:"#EFF6FF"},pickerOptionText:{fontSize:16,color:"#374151"},selectedPickerOptionText:{color:"#1D4ED8",fontWeight:"500"},buttonGroup:{marginTop:24},button:{height:50,borderRadius:8,justifyContent:"center",alignItems:"center",marginBottom:12},saveButton:{backgroundColor:"#10B981"},deleteButton:{backgroundColor:"#EF4444"},cancelButton:{backgroundColor:"#F3F4F6",borderWidth:1,borderColor:"#D1D5DB"},buttonDisabled:{opacity:.7},buttonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},cancelButtonText:{color:"#374151"}}),Et=({navigation:e})=>{const[t,o]=(0,n.useState)(""),[a,r]=(0,n.useState)("maestro"),[i,l]=(0,n.useState)("activo"),[s,u]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!0),[y,j]=(0,n.useState)(!1),[C,v]=(0,n.useState)(!1),[S,T]=(0,n.useState)(!1),[z,q]=(0,n.useState)(null),[k,I]=(0,n.useState)([]),[R,E]=(0,n.useState)(""),[O,F]=(0,n.useState)(null),[W,A]=(0,n.useState)(!1),[L,N]=(0,n.useState)(""),H=[{value:"maestro",label:"Maestro"},{value:"directivo",label:"Directivo"},{value:"invitado",label:"Invitado"}],V=[{value:"activo",label:"Activo"},{value:"inactivo",label:"Inactivo"}];(0,n.useEffect)((()=>{(async()=>{const{data:{user:e}}=await b.supabase.auth.getUser();if(e){const{data:t,error:o}=await b.supabase.from("usuarios").select("rol").eq("idusuario",e.id).single();!o&&t&&"admin"===t.rol&&(T(!0),M())}})()}),[]);const M=async()=>{x(!0);try{let e=b.supabase.from("personal").select("*").order("created_at",{ascending:!1});R&&(e=e.ilike("nombre_completo",`%${R}%`));const{data:t,error:o}=await e;if(o)throw o;I(t||[])}catch(e){_("Error","No se pudo cargar la lista de personal"),console.error("Error fetching personal:",e)}finally{x(!1)}},_=(e,t)=>{N(t),A(!0),setTimeout((()=>A(!1)),3e3)},$=async()=>{u(!0);try{const{error:e}=await b.supabase.from("personal").delete().eq("idpersonal",z);if(e)throw e;N("Personal eliminado correctamente"),A(!0),setTimeout((()=>{A(!1),F(null),M()}),2e3)}catch(e){_("Error","Ocurri\xf3 un error al eliminar el personal")}finally{u(!1)}};return S?(0,w.jsxs)(g.default,{style:Rt.safeArea,children:[(0,w.jsxs)(d.default,{style:Rt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:Rt.menuButton,children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:Rt.headerTitle,children:"Administrar Personal"})]}),W&&(0,w.jsxs)(d.default,{style:Rt.webSuccessMessage,children:[(0,w.jsx)(B.default,{name:"check-circle",size:20,color:"#10B981"}),(0,w.jsx)(c.default,{style:Rt.webSuccessText,children:L})]}),(0,w.jsxs)(m.default,{contentContainerStyle:Rt.container,children:[(0,w.jsx)(d.default,{style:Rt.webMessage,children:(0,w.jsx)(c.default,{style:Rt.webMessageText,children:"Est\xe1s utilizando la versi\xf3n web del sistema de administraci\xf3n"})}),(0,w.jsxs)(d.default,{style:Rt.card,children:[(0,w.jsxs)(d.default,{style:Rt.searchContainer,children:[(0,w.jsx)(D.default,{style:Rt.searchInput,placeholder:"Buscar personal...",value:R,onChangeText:E,onSubmitEditing:M}),(0,w.jsx)(h.default,{style:Rt.searchButton,onPress:M,children:(0,w.jsx)(B.default,{name:"search",size:24,color:"#FFFFFF"})})]}),p?(0,w.jsxs)(d.default,{style:Rt.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#3B82F6"}),(0,w.jsx)(c.default,{style:Rt.loadingText,children:"Cargando personal..."})]}):0===k.length?(0,w.jsxs)(d.default,{style:Rt.emptyContainer,children:[(0,w.jsx)(B.default,{name:"people-outline",size:48,color:"#9CA3AF"}),(0,w.jsx)(c.default,{style:Rt.emptyText,children:"No se encontr\xf3 personal"})]}):(0,w.jsx)(P.default,{data:k,renderItem:({item:e})=>(0,w.jsxs)(h.default,{style:[Rt.personalItem,O?.idpersonal===e.idpersonal&&Rt.selectedPersonalItem],onPress:()=>{return F(t=e),q(t.idpersonal),o(t.nombre_completo),r(t.tipo_persona),void l(t.estado);var t},children:[(0,w.jsxs)(d.default,{style:Rt.personalInfo,children:[(0,w.jsx)(c.default,{style:Rt.personalName,children:e.nombre_completo}),(0,w.jsxs)(d.default,{style:Rt.personalDetails,children:[(0,w.jsx)(c.default,{style:Rt.personalType,children:H.find((t=>t.value===e.tipo_persona))?.label}),(0,w.jsx)(d.default,{style:[Rt.statusBadge,"activo"===e.estado?Rt.activeBadge:Rt.inactiveBadge],children:(0,w.jsx)(c.default,{style:Rt.statusText,children:"activo"===e.estado?"Activo":"Inactivo"})})]})]}),(0,w.jsx)(B.default,{name:"chevron-right",size:24,color:"#64748B"})]}),keyExtractor:e=>e.idpersonal.toString(),style:Rt.listContainer,contentContainerStyle:Rt.listContent})]}),O&&(0,w.jsxs)(d.default,{style:[Rt.card,Rt.editForm],children:[(0,w.jsx)(c.default,{style:Rt.title,children:"Editar Personal"}),(0,w.jsxs)(d.default,{style:Rt.formGroup,children:[(0,w.jsx)(c.default,{style:Rt.label,children:"Nombre Completo"}),(0,w.jsx)(D.default,{style:Rt.input,placeholder:"Ej: Juan P\xe9rez L\xf3pez",value:t,onChangeText:o,maxLength:100})]}),(0,w.jsxs)(d.default,{style:Rt.formGroup,children:[(0,w.jsx)(c.default,{style:Rt.label,children:"Cargo"}),(0,w.jsxs)(h.default,{style:Rt.pickerButton,onPress:()=>j(!y),children:[(0,w.jsx)(c.default,{style:Rt.pickerButtonText,children:H.find((e=>e.value===a))?.label}),(0,w.jsx)(B.default,{name:y?"keyboard-arrow-up":"keyboard-arrow-down",size:24,color:"#64748B"})]}),y&&(0,w.jsx)(d.default,{style:Rt.pickerOptions,children:H.map((e=>(0,w.jsx)(h.default,{style:[Rt.pickerOption,a===e.value&&Rt.selectedPickerOption],onPress:()=>{r(e.value),j(!1)},children:(0,w.jsx)(c.default,{style:[Rt.pickerOptionText,a===e.value&&Rt.selectedPickerOptionText],children:e.label})},e.value)))})]}),(0,w.jsxs)(d.default,{style:Rt.formGroup,children:[(0,w.jsx)(c.default,{style:Rt.label,children:"Estado"}),(0,w.jsxs)(h.default,{style:Rt.pickerButton,onPress:()=>v(!C),children:[(0,w.jsx)(c.default,{style:Rt.pickerButtonText,children:V.find((e=>e.value===i))?.label}),(0,w.jsx)(B.default,{name:C?"keyboard-arrow-up":"keyboard-arrow-down",size:24,color:"#64748B"})]}),C&&(0,w.jsx)(d.default,{style:Rt.pickerOptions,children:V.map((e=>(0,w.jsx)(h.default,{style:[Rt.pickerOption,i===e.value&&Rt.selectedPickerOption],onPress:()=>{l(e.value),v(!1)},children:(0,w.jsx)(c.default,{style:[Rt.pickerOptionText,i===e.value&&Rt.selectedPickerOptionText],children:e.label})},e.value)))})]}),(0,w.jsxs)(d.default,{style:Rt.buttonGroup,children:[(0,w.jsx)(h.default,{style:[Rt.button,Rt.saveButton,s&&Rt.buttonDisabled],onPress:async()=>{if(t.trim()){u(!0);try{const{data:e,error:o}=await b.supabase.from("personal").update({nombre_completo:t,tipo_persona:a,estado:i}).eq("idpersonal",z).select();if(o)throw o;N("Cambios guardados correctamente"),A(!0),setTimeout((()=>{A(!1),F(null),M()}),2e3)}catch(e){let t="Ocurri\xf3 un error al guardar los cambios";e.message.includes("permission denied")&&(t="No tienes permisos para realizar esta acci\xf3n"),_("Error",t)}finally{u(!1)}}else _("Error","Por favor ingrese el nombre completo")},disabled:s,children:s?(0,w.jsx)(f.default,{color:"#FFF"}):(0,w.jsx)(c.default,{style:Rt.buttonText,children:"Guardar Cambios"})}),(0,w.jsx)(h.default,{style:[Rt.button,Rt.deleteButton],onPress:async()=>{if(!window.confirm(`\xbfEst\xe1s seguro de que deseas eliminar a ${O.nombre_completo}? Esta acci\xf3n no se puede deshacer.`))return;await $()},disabled:s,children:(0,w.jsx)(c.default,{style:Rt.buttonText,children:"Eliminar Personal"})}),(0,w.jsx)(h.default,{style:[Rt.button,Rt.cancelButton],onPress:()=>F(null),disabled:s,children:(0,w.jsx)(c.default,{style:[Rt.buttonText,Rt.cancelButtonText],children:"Cancelar"})})]})]})]})]}):(0,w.jsx)(g.default,{style:Rt.unauthorizedContainer,children:(0,w.jsxs)(d.default,{style:Rt.unauthorizedContent,children:[(0,w.jsx)(B.default,{name:"warning",size:48,color:"#EF4444"}),(0,w.jsx)(c.default,{style:Rt.unauthorizedTitle,children:"Acceso no autorizado"}),(0,w.jsx)(c.default,{style:Rt.unauthorizedText,children:"Solo administradores pueden modificar personal"}),(0,w.jsx)(h.default,{style:Rt.backButton,onPress:()=>e.goBack(),children:(0,w.jsx)(c.default,{style:Rt.backButtonText,children:"Volver al panel"})})]})})},{width:Pt}=x.default.get("window"),Dt=Pt<768,Ot=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:Dt?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:Dt?18:20,fontWeight:"600",color:"#2c3e50"},content:{flex:1,padding:Dt?16:24},statsContainer:{marginBottom:16},statCard:{backgroundColor:"#ffffff",borderRadius:12,padding:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2,flexDirection:"row",alignItems:"center"},statIconContainer:{width:48,height:48,borderRadius:24,justifyContent:"center",alignItems:"center",marginRight:16},statTitle:{fontSize:14,color:"#6c757d",marginBottom:4,fontWeight:"500"},statValue:{fontSize:28,fontWeight:"700",color:"#2c3e50"},section:{flex:1,backgroundColor:"#ffffff",borderRadius:12,padding:Dt?16:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},sectionTitle:{fontSize:Dt?16:18,fontWeight:"600",color:"#2c3e50",marginBottom:16},personCard:{flexDirection:"row",alignItems:"center",backgroundColor:"#f8f9fa",borderRadius:8,padding:16,marginBottom:12,borderWidth:1,borderColor:"#e0e0e0"},personAvatar:{width:40,height:40,borderRadius:20,backgroundColor:"#e3f2fd",justifyContent:"center",alignItems:"center",marginRight:16},personInfo:{flex:1},personName:{fontSize:16,fontWeight:"500",color:"#2c3e50",marginBottom:4},badgeContainer:{flexDirection:"row",gap:8},typeBadge:{borderRadius:10,paddingHorizontal:8,paddingVertical:2},statusBadge:{borderRadius:10,paddingHorizontal:8,paddingVertical:2},badgeText:{fontSize:12,color:"#ffffff",fontWeight:"600"},emptyContainer:{flex:1,alignItems:"center",justifyContent:"center",paddingVertical:40},emptyText:{fontSize:16,color:"#95a5a6",marginTop:16},listContent:{paddingBottom:20},emptyListContent:{flex:1,justifyContent:"center"},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},modalContainer:{backgroundColor:"#ffffff",borderRadius:12,width:Dt?"90%":"60%",maxWidth:600,maxHeight:"80%",overflow:"hidden"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:"#e0e0e0"},modalTitle:{fontSize:18,fontWeight:"600",color:"#2c3e50"},closeButton:{padding:4},modalContent:{padding:16},detailRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},detailLabel:{fontSize:16,color:"#6c757d",fontWeight:"500"},detailValue:{fontSize:16,color:"#2c3e50",fontWeight:"500",maxWidth:"60%",textAlign:"right"},modalFooter:{flexDirection:"row",justifyContent:"flex-end",padding:16,borderTopWidth:1,borderTopColor:"#e0e0e0"},modalButton:{borderRadius:8,paddingVertical:10,paddingHorizontal:16,minWidth:100,alignItems:"center"},closeModalButton:{backgroundColor:"#f8f9fa",borderWidth:1,borderColor:"#e0e0e0"},modalButtonText:{fontSize:16,fontWeight:"600"}}),Ft=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),[u,x]=(0,n.useState)(null),[y,j]=(0,n.useState)(!1),C=async()=>{try{s(!0);const{data:e,error:t}=await b.supabase.from("personal").select("*").order("created_at",{ascending:!1});if(t)throw t;o(e||[])}catch(e){console.error("Error fetching personal:",e),p.default.alert("Error","No se pudo cargar el personal")}finally{r(!1),s(!1)}};(0,n.useEffect)((()=>{C()}),[]);const v=e=>{switch(e.toLowerCase()){case"maestro":return"#3498db";case"directivo":return"#9b59b6";case"invitado":return"#2ecc71";default:return"#95a5a6"}},S=e=>"activo"===e.toLowerCase()?"#2ecc71":"#e74c3c";return a?(0,w.jsxs)(g.default,{style:Ot.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:Ot.loadingText,children:"Cargando personal..."})]}):(0,w.jsx)(g.default,{style:Ot.safeArea,children:(0,w.jsxs)(d.default,{style:Ot.container,children:[(0,w.jsxs)(d.default,{style:Ot.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:Ot.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:Ot.headerTitle,children:"Lista de Personal"})]}),(0,w.jsxs)(d.default,{style:Ot.content,children:[(0,w.jsx)(d.default,{style:Ot.statsContainer,children:(0,w.jsxs)(d.default,{style:Ot.statCard,children:[(0,w.jsx)(d.default,{style:[Ot.statIconContainer,{backgroundColor:"#e3f2fd"}],children:(0,w.jsx)(B.default,{name:"people",size:24,color:"#1976d2"})}),(0,w.jsx)(c.default,{style:Ot.statTitle,children:"Total de Personal  "}),(0,w.jsx)(c.default,{style:Ot.statValue,children:t.length})]})}),(0,w.jsxs)(d.default,{style:Ot.section,children:[(0,w.jsx)(c.default,{style:Ot.sectionTitle,children:"Personal Registrado"}),(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsxs)(h.default,{style:Ot.personCard,onPress:()=>{x(e),j(!0)},children:[(0,w.jsx)(d.default,{style:Ot.personAvatar,children:(0,w.jsx)(B.default,{name:"maestro"===e.tipo_persona?"school":"directivo"===e.tipo_persona?"supervisor-account":"person",size:24,color:"#4a6da7"})}),(0,w.jsxs)(d.default,{style:Ot.personInfo,children:[(0,w.jsx)(c.default,{style:Ot.personName,children:e.nombre_completo}),(0,w.jsxs)(d.default,{style:Ot.badgeContainer,children:[(0,w.jsx)(d.default,{style:[Ot.typeBadge,{backgroundColor:v(e.tipo_persona)}],children:(0,w.jsx)(c.default,{style:Ot.badgeText,children:e.tipo_persona.toUpperCase()})}),(0,w.jsx)(d.default,{style:[Ot.statusBadge,{backgroundColor:S(e.estado)}],children:(0,w.jsx)(c.default,{style:Ot.badgeText,children:e.estado.toUpperCase()})})]})]}),(0,w.jsx)(B.default,{name:"chevron-right",size:24,color:"#64748B"})]}),keyExtractor:e=>e.idpersonal.toString(),refreshControl:(0,w.jsx)(fe.default,{refreshing:l,onRefresh:C,colors:["#4a6da7"]}),ListEmptyComponent:(0,w.jsxs)(d.default,{style:Ot.emptyContainer,children:[(0,w.jsx)(B.default,{name:"people-outline",size:48,color:"#95a5a6"}),(0,w.jsx)(c.default,{style:Ot.emptyText,children:"No hay personal registrado"})]}),contentContainerStyle:0===t.length?Ot.emptyListContent:Ot.listContent})]})]}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!0,visible:y,onRequestClose:()=>j(!1),children:(0,w.jsx)(d.default,{style:Ot.modalOverlay,children:(0,w.jsx)(d.default,{style:Ot.modalContainer,children:u&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(d.default,{style:Ot.modalHeader,children:[(0,w.jsx)(c.default,{style:Ot.modalTitle,children:"Detalles del Personal"}),(0,w.jsx)(h.default,{onPress:()=>j(!1),style:Ot.closeButton,children:(0,w.jsx)(B.default,{name:"close",size:24,color:"#6c757d"})})]}),(0,w.jsxs)(m.default,{style:Ot.modalContent,children:[(0,w.jsxs)(d.default,{style:Ot.detailRow,children:[(0,w.jsx)(c.default,{style:Ot.detailLabel,children:"Nombre Completo:"}),(0,w.jsx)(c.default,{style:Ot.detailValue,children:u.nombre_completo})]}),(0,w.jsxs)(d.default,{style:Ot.detailRow,children:[(0,w.jsx)(c.default,{style:Ot.detailLabel,children:"Tipo de Persona:"}),(0,w.jsx)(d.default,{style:[Ot.typeBadge,{backgroundColor:v(u.tipo_persona)}],children:(0,w.jsx)(c.default,{style:Ot.badgeText,children:u.tipo_persona.toUpperCase()})})]}),(0,w.jsxs)(d.default,{style:Ot.detailRow,children:[(0,w.jsx)(c.default,{style:Ot.detailLabel,children:"Estado:"}),(0,w.jsx)(d.default,{style:[Ot.statusBadge,{backgroundColor:S(u.estado)}],children:(0,w.jsx)(c.default,{style:Ot.badgeText,children:u.estado.toUpperCase()})})]}),(0,w.jsxs)(d.default,{style:Ot.detailRow,children:[(0,w.jsx)(c.default,{style:Ot.detailLabel,children:"Fecha de Registro:"}),(0,w.jsx)(c.default,{style:Ot.detailValue,children:(T=u.created_at,new Date(T).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}))})]})]}),(0,w.jsx)(d.default,{style:Ot.modalFooter,children:(0,w.jsx)(h.default,{style:[Ot.modalButton,Ot.closeModalButton],onPress:()=>j(!1),children:(0,w.jsx)(c.default,{style:[Ot.modalButtonText,{color:"#2c3e50"}],children:"Cerrar"})})})]})})})})]})});var T};var Wt=o(9864),At=o(9193),Lt=o(5473),Nt=o(5704),Ht=o(1223),Vt=o(5727);const Mt=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:16,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},backButton:{padding:4},headerTitle:{fontSize:18,fontWeight:"600",color:"#2c3e50"},editButton:{padding:4},saveButton:{backgroundColor:"#4a6da7",paddingHorizontal:16,paddingVertical:8,borderRadius:4,minWidth:80,alignItems:"center"},saveButtonText:{color:"#fff",fontWeight:"500",fontSize:14},scrollContent:{flexGrow:1,paddingBottom:24},content:{width:"100%",maxWidth:800,alignSelf:"center",paddingHorizontal:16},profileSection:{marginTop:24,alignItems:"center"},avatarContainer:{alignItems:"center",marginBottom:24,position:"relative"},avatar:{width:120,height:120,borderRadius:60},avatarPlaceholder:{backgroundColor:"#95a5a6",justifyContent:"center",alignItems:"center"},cameraIcon:{position:"absolute",bottom:0,right:0,backgroundColor:"#4a6da7",width:36,height:36,borderRadius:18,justifyContent:"center",alignItems:"center",borderWidth:2,borderColor:"#fff"},card:{width:"100%",backgroundColor:"#ffffff",borderRadius:12,padding:16,marginBottom:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},formGroup:{marginBottom:16},label:{fontSize:14,color:"#6c757d",marginBottom:8,fontWeight:"500"},input:{fontSize:16,color:"#2c3e50",borderWidth:1,borderColor:"#e0e0e0",borderRadius:8,padding:12,backgroundColor:"#f8f9fa"},textValue:{fontSize:16,color:"#2c3e50",paddingVertical:8},roleContainer:{flexDirection:"row",flexWrap:"wrap",marginTop:8},roleButton:{paddingHorizontal:12,paddingVertical:8,marginRight:8,marginBottom:8,borderRadius:8,backgroundColor:"#f8f9fa",borderWidth:1,borderColor:"#e0e0e0"},selectedRoleButton:{backgroundColor:"#4a6da7",borderColor:"#4a6da7"},roleButtonText:{color:"#2c3e50",fontSize:14},selectedRoleButtonText:{color:"#fff"},imagePickerButton:{marginTop:8},scheduleImage:{width:"100%",height:200,borderRadius:8},imagePickerPlaceholder:{height:100,borderWidth:1,borderColor:"#4a6da7",borderStyle:"dashed",borderRadius:8,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},imagePickerText:{marginTop:8,color:"#4a6da7",fontSize:14},changePasswordButton:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#ffffff",borderRadius:12,padding:16,width:"100%",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},changePasswordText:{color:"#4a6da7",fontWeight:"500",fontSize:16},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},modalContent:{width:"90%",backgroundColor:"#fff",borderRadius:12,padding:24},modalTitle:{fontSize:18,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},modalLabel:{fontSize:14,color:"#6c757d",marginBottom:8,fontWeight:"500"},modalInput:{fontSize:16,color:"#2c3e50",borderWidth:1,borderColor:"#e0e0e0",borderRadius:8,padding:12,marginBottom:16,backgroundColor:"#f8f9fa"},modalButtons:{flexDirection:"row",justifyContent:"flex-end",marginTop:16},modalButton:{paddingHorizontal:16,paddingVertical:10,borderRadius:8,marginLeft:8,minWidth:80,alignItems:"center"},cancelButton:{backgroundColor:"#f8f9fa",borderWidth:1,borderColor:"#e0e0e0"},confirmButton:{backgroundColor:"#4a6da7"},modalButtonText:{fontSize:14,fontWeight:"500"},confirmButtonText:{color:"#fff"}}),_t=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)({nombreusuario:"",email:"",rol:"",contrasena:"",fotoperfil:null,fotohorario:null}),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),[u,x]=(0,n.useState)(!1),[y,j]=(0,n.useState)(!1),[C,v]=(0,n.useState)(""),[S,T]=(0,n.useState)(""),[z,q]=(0,n.useState)("");(0,n.useEffect)((()=>{k()}),[]);const k=async()=>{try{r(!0);const{data:{session:t}}=await b.supabase.auth.getSession();if(!t)return void e.navigate("Login");const{data:a,error:n}=await b.supabase.from("usuarios").select("nombreusuario, email, rol, fotoperfil, fotohorario").eq("idusuario",t.user.id).single();if(n)throw n;o({nombreusuario:a?.nombreusuario||"",email:a?.email||"",rol:a?.rol||"",contrasena:"",fotoperfil:a?.fotoperfil||null,fotohorario:a?.fotohorario||null})}catch(t){p.default.alert("Error","No se pudieron cargar los datos del perfil"),console.error("Error fetching user data:",t)}finally{r(!1)}},I=(e,t)=>{o((o=>Object.assign({},o,{[e]:t})))},R=async e=>{try{const{status:t}=await Wt.requestMediaLibraryPermissionsAsync();if("granted"!==t)return void p.default.alert("Permisos necesarios","Necesitamos acceso a tus fotos para cambiar las im\xe1genes");const o=await Wt.launchImageLibraryAsync({mediaTypes:At.MediaTypeOptions.Images,allowsEditing:!0,aspect:[1,1],quality:.8});o.canceled||I(e,o.assets[0].uri)}catch(t){console.error("Error selecting image:",t),p.default.alert("Error","No se pudo seleccionar la imagen")}},P=async(e,t)=>{try{const o="imagenes-usuarios",a=(0,Vt.default)(),r=e.split(".").pop().toLowerCase(),n=`${t}_${a}.${r}`,i=await Lt.readAsStringAsync(e,{encoding:Nt.EncodingType.Base64}),{data:l,error:s}=await b.supabase.storage.from(o).upload(n,(0,Ht.decode)(i),{contentType:"image/"+("png"===r?"png":"jpeg"),upsert:!1,cacheControl:"3600"});if(s)throw s;const{data:{publicUrl:d}}=await b.supabase.storage.from(o).getPublicUrl(l.path);return d}catch(o){throw console.error("Error uploading image:",o),new Error("No se pudo subir la imagen. Verifica tu conexi\xf3n y permisos.")}};return a?(0,w.jsxs)(g.default,{style:Mt.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:Mt.loadingText,children:"Cargando perfil..."})]}):(0,w.jsx)(g.default,{style:Mt.safeArea,children:(0,w.jsxs)(d.default,{style:Mt.container,children:[(0,w.jsxs)(d.default,{style:Mt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.goBack(),style:Mt.backButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"arrow-back",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:Mt.headerTitle,children:"Mi Perfil"}),u?(0,w.jsx)(h.default,{onPress:async()=>{try{s(!0);const{data:{session:o}}=await b.supabase.auth.getSession();if(!o)return void e.navigate("Login");let a=t.fotoperfil;t.fotoperfil&&t.fotoperfil.startsWith("file:")&&(a=await P(t.fotoperfil,"profile"));let r=t.fotohorario;t.fotohorario&&t.fotohorario.startsWith("file:")&&(r=await P(t.fotohorario,"schedule"));const{error:n}=await b.supabase.from("usuarios").update({nombreusuario:t.nombreusuario,rol:t.rol,fotoperfil:a,fotohorario:r}).eq("idusuario",o.user.id);if(n)throw n;p.default.alert("\xc9xito","Perfil actualizado correctamente"),x(!1)}catch(o){console.error("Error al guardar perfil:",o),p.default.alert("Error",o.message||"Ocurri\xf3 un error al actualizar el perfil. Por favor intente nuevamente.")}finally{s(!1)}},style:Mt.saveButton,disabled:l,children:l?(0,w.jsx)(f.default,{color:"#fff",size:"small"}):(0,w.jsx)(c.default,{style:Mt.saveButtonText,children:"Guardar"})}):(0,w.jsx)(h.default,{onPress:()=>x(!0),style:Mt.editButton,children:(0,w.jsx)(B.default,{name:"edit",size:20,color:"#4a6da7"})})]}),(0,w.jsx)(m.default,{contentContainerStyle:Mt.scrollContent,showsVerticalScrollIndicator:!1,children:(0,w.jsx)(d.default,{style:Mt.content,children:(0,w.jsxs)(d.default,{style:Mt.profileSection,children:[(0,w.jsx)(h.default,{onPress:u?()=>R("fotoperfil"):null,disabled:!u,activeOpacity:.7,children:(0,w.jsxs)(d.default,{style:Mt.avatarContainer,children:[t.fotoperfil?(0,w.jsx)(re.default,{source:{uri:t.fotoperfil},style:Mt.avatar}):(0,w.jsx)(d.default,{style:[Mt.avatar,Mt.avatarPlaceholder],children:(0,w.jsx)(B.default,{name:"person",size:40,color:"#fff"})}),u&&(0,w.jsx)(d.default,{style:Mt.cameraIcon,children:(0,w.jsx)(B.default,{name:"photo-camera",size:20,color:"#fff"})})]})}),(0,w.jsxs)(d.default,{style:Mt.card,children:[(0,w.jsxs)(d.default,{style:Mt.formGroup,children:[(0,w.jsx)(c.default,{style:Mt.label,children:"Nombre"}),u?(0,w.jsx)(D.default,{style:Mt.input,value:t.nombreusuario,onChangeText:e=>I("nombreusuario",e),placeholder:"Ingresa tu nombre"}):(0,w.jsx)(c.default,{style:Mt.textValue,children:t.nombreusuario})]}),(0,w.jsxs)(d.default,{style:Mt.formGroup,children:[(0,w.jsx)(c.default,{style:Mt.label,children:"Email"}),(0,w.jsx)(c.default,{style:Mt.textValue,children:t.email})]}),(0,w.jsxs)(d.default,{style:Mt.formGroup,children:[(0,w.jsx)(c.default,{style:Mt.label,children:"Rol"}),u?(0,w.jsx)(d.default,{style:Mt.roleContainer,children:["admin","maestro","directivo","invitado"].map((e=>(0,w.jsx)(h.default,{style:[Mt.roleButton,t.rol===e&&Mt.selectedRoleButton],onPress:()=>I("rol",e),activeOpacity:.7,children:(0,w.jsx)(c.default,{style:[Mt.roleButtonText,t.rol===e&&Mt.selectedRoleButtonText],children:e.charAt(0).toUpperCase()+e.slice(1)})},e)))}):(0,w.jsx)(c.default,{style:Mt.textValue,children:t.rol.charAt(0).toUpperCase()+t.rol.slice(1)})]})]}),(0,w.jsx)(d.default,{style:Mt.card,children:(0,w.jsxs)(d.default,{style:Mt.formGroup,children:[(0,w.jsx)(c.default,{style:Mt.label,children:"Foto de Horario"}),u?(0,w.jsx)(h.default,{style:Mt.imagePickerButton,onPress:()=>R("fotohorario"),activeOpacity:.7,children:t.fotohorario?(0,w.jsx)(re.default,{source:{uri:t.fotohorario},style:Mt.scheduleImage}):(0,w.jsxs)(d.default,{style:Mt.imagePickerPlaceholder,children:[(0,w.jsx)(B.default,{name:"add-a-photo",size:24,color:"#4a6da7"}),(0,w.jsx)(c.default,{style:Mt.imagePickerText,children:"Seleccionar imagen"})]})}):t.fotohorario?(0,w.jsx)(re.default,{source:{uri:t.fotohorario},style:Mt.scheduleImage}):(0,w.jsx)(c.default,{style:Mt.textValue,children:"No hay imagen de horario"})]})}),(0,w.jsxs)(h.default,{style:Mt.changePasswordButton,onPress:()=>j(!0),activeOpacity:.7,children:[(0,w.jsx)(c.default,{style:Mt.changePasswordText,children:"Cambiar contrase\xf1a"}),(0,w.jsx)(B.default,{name:"keyboard-arrow-right",size:20,color:"#4a6da7"})]})]})})}),(0,w.jsx)(E.default,{visible:y,animationType:"slide",transparent:!0,onRequestClose:()=>j(!1),children:(0,w.jsx)(d.default,{style:Mt.modalContainer,children:(0,w.jsxs)(d.default,{style:Mt.modalContent,children:[(0,w.jsx)(c.default,{style:Mt.modalTitle,children:"Cambiar contrase\xf1a"}),(0,w.jsx)(c.default,{style:Mt.modalLabel,children:"Contrase\xf1a actual"}),(0,w.jsx)(D.default,{style:Mt.modalInput,secureTextEntry:!0,value:C,onChangeText:v,placeholder:"Ingresa tu contrase\xf1a actual",placeholderTextColor:"#95a5a6"}),(0,w.jsx)(c.default,{style:Mt.modalLabel,children:"Nueva contrase\xf1a"}),(0,w.jsx)(D.default,{style:Mt.modalInput,secureTextEntry:!0,value:S,onChangeText:T,placeholder:"Ingresa nueva contrase\xf1a",placeholderTextColor:"#95a5a6"}),(0,w.jsx)(c.default,{style:Mt.modalLabel,children:"Confirmar contrase\xf1a"}),(0,w.jsx)(D.default,{style:Mt.modalInput,secureTextEntry:!0,value:z,onChangeText:q,placeholder:"Confirma nueva contrase\xf1a",placeholderTextColor:"#95a5a6"}),(0,w.jsxs)(d.default,{style:Mt.modalButtons,children:[(0,w.jsx)(h.default,{style:[Mt.modalButton,Mt.cancelButton],onPress:()=>j(!1),activeOpacity:.7,children:(0,w.jsx)(c.default,{style:Mt.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[Mt.modalButton,Mt.confirmButton],onPress:async()=>{if(S===z)try{s(!0);const{error:e}=await b.supabase.auth.updateUser({password:S});if(e)throw e;p.default.alert("\xc9xito","Contrase\xf1a actualizada correctamente"),j(!1),v(""),T(""),q("")}catch(e){console.error("Error al cambiar contrase\xf1a:",e),p.default.alert("Error","No se pudo cambiar la contrase\xf1a. Aseg\xfarate que la contrase\xf1a actual es correcta y que la nueva contrase\xf1a tiene al menos 6 caracteres.")}finally{s(!1)}else p.default.alert("Error","Las contrase\xf1as no coinciden")},disabled:l,activeOpacity:.7,children:l?(0,w.jsx)(f.default,{color:"#fff",size:"small"}):(0,w.jsx)(c.default,{style:[Mt.modalButtonText,Mt.confirmButtonText],children:"Cambiar"})})]})]})})})]})})};var $t=o(313);const{width:Ut}=x.default.get("window"),Gt=Ut<768,Xt=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:Gt?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:Gt?18:20,fontWeight:"600",color:"#2c3e50"},scrollContent:{flexGrow:1,paddingBottom:24},content:{width:"100%",maxWidth:1200,alignSelf:"center",paddingHorizontal:Gt?16:24},formContainer:{backgroundColor:"#ffffff",borderRadius:12,padding:Gt?16:24,marginTop:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},formGroup:{marginBottom:20},label:{fontSize:14,color:"#495057",marginBottom:8,fontWeight:"500"},input:{backgroundColor:"#f8f9fa",borderWidth:1,borderColor:"#ced4da",borderRadius:8,padding:Gt?12:14,fontSize:16,color:"#495057"},multilineInput:{minHeight:100,textAlignVertical:"top"},pickerContainer:{backgroundColor:"#f8f9fa",borderWidth:1,borderColor:"#ced4da",borderRadius:8,overflow:"hidden"},picker:{width:"100%",color:"#495057"},submitButton:{flexDirection:"row",justifyContent:"center",alignItems:"center",backgroundColor:"#4a6da7",borderRadius:8,padding:16,marginTop:16},submitButtonText:{color:"#ffffff",fontSize:16,fontWeight:"600",marginLeft:8},buttonIcon:{marginRight:8},qrContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},qrTitle:{fontSize:22,fontWeight:"bold",color:"#2c3e50",marginBottom:8},qrSubtitle:{fontSize:16,color:"#7f8c8d",marginBottom:24,textAlign:"center"},qrCodeContainer:{padding:20,backgroundColor:"white",borderRadius:12,marginBottom:24,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:6,elevation:3},qrInfo:{fontSize:16,color:"#34495e",marginBottom:24,textAlign:"center"},closeButton:{backgroundColor:"#4a6da7",paddingVertical:12,paddingHorizontal:24,borderRadius:8},closeButtonText:{color:"white",fontSize:16,fontWeight:"600"}}),Jt=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)(!1),[a,r]=(0,n.useState)([]),[l,s]=(0,n.useState)(!1),[u,p]=(0,n.useState)(null),[x,y]=(0,n.useState)(null),[j,C]=(0,n.useState)({nombreequipo:"",idcategoria:"",descripcion:""});(0,n.useEffect)((()=>{const t=t=>{if(t.url){const o=t.url.replace(/.*?:\/\//g,""),[a,r]=o.split("/");"equipos"===a&&r&&e.navigate("DetallesEquipo",{equipoId:r})}};return Y.default.addEventListener("url",t),()=>{Y.default.removeEventListener("url",t)}}),[e]);const v=(e,t,o=!1)=>{alert(`${e}\n${t}\n\n${o?"\u2705":"\u274c"}`)};(0,n.useEffect)((()=>{(async()=>{try{const{data:e,error:t}=await b.supabase.from("categoriasequipos").select("idcategoria, nombrecategoria").order("nombrecategoria",{ascending:!0});if(t)throw t;r(e)}catch(e){console.error("Error al cargar categor\xedas:",e),v("Error","No se pudieron cargar las categor\xedas. Por favor, intente nuevamente.")}})()}),[]);const S=(e,t)=>{C(Object.assign({},j,{[e]:String(t)}))};return(0,w.jsx)(g.default,{style:Xt.safeArea,children:(0,w.jsxs)(d.default,{style:Xt.container,children:[(0,w.jsxs)(d.default,{style:Xt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:Xt.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:Xt.headerTitle,children:"Agregar Nuevo Equipo"})]}),l?(0,w.jsxs)(d.default,{style:Xt.qrContainer,children:[(0,w.jsx)(c.default,{style:Xt.qrTitle,children:"C\xf3digo QR del Equipo"}),(0,w.jsx)(c.default,{style:Xt.qrSubtitle,children:"Escanea este c\xf3digo para ver los detalles del equipo"}),(0,w.jsx)(d.default,{style:Xt.qrCodeContainer,children:(0,w.jsx)($t.default,{value:u,size:Gt?250:300,color:"#2c3e50",backgroundColor:"white"})}),(0,w.jsxs)(c.default,{style:Xt.qrInfo,children:["Equipo: ",j.nombreequipo]}),(0,w.jsx)(h.default,{style:Xt.closeButton,onPress:()=>e.navigate("DetallesEquipo",{equipoId:x}),children:(0,w.jsx)(c.default,{style:Xt.closeButtonText,children:"Ver Detalles"})}),(0,w.jsx)(h.default,{style:[Xt.closeButton,{backgroundColor:"#6c757d",marginTop:10}],onPress:()=>{s(!1),e.goBack()},children:(0,w.jsx)(c.default,{style:Xt.closeButtonText,children:"Cerrar"})})]}):(0,w.jsx)(m.default,{contentContainerStyle:Xt.scrollContent,showsVerticalScrollIndicator:!1,children:(0,w.jsx)(d.default,{style:Xt.content,children:(0,w.jsxs)(d.default,{style:Xt.formContainer,children:[(0,w.jsxs)(d.default,{style:Xt.formGroup,children:[(0,w.jsx)(c.default,{style:Xt.label,children:"Nombre del equipo*"}),(0,w.jsx)(D.default,{style:Xt.input,placeholder:"Ej. Laptop Dell XPS 15",value:j.nombreequipo,onChangeText:e=>S("nombreequipo",e),maxLength:50})]}),(0,w.jsxs)(d.default,{style:Xt.formGroup,children:[(0,w.jsx)(c.default,{style:Xt.label,children:"Categor\xeda*"}),(0,w.jsx)(d.default,{style:Xt.pickerContainer,children:(0,w.jsxs)(st.Picker,{selectedValue:j.idcategoria,onValueChange:e=>S("idcategoria",e),children:[(0,w.jsx)(st.Picker.Item,{label:"Seleccione una categor\xeda",value:""}),a.map((e=>(0,w.jsx)(st.Picker.Item,{label:e.nombrecategoria,value:String(e.idcategoria)},String(e.idcategoria))))]})})]}),(0,w.jsxs)(d.default,{style:Xt.formGroup,children:[(0,w.jsx)(c.default,{style:Xt.label,children:"Descripci\xf3n"}),(0,w.jsx)(D.default,{style:[Xt.input,Xt.multilineInput],placeholder:"Detalles adicionales sobre el equipo",value:j.descripcion,onChangeText:e=>S("descripcion",e),multiline:!0,numberOfLines:4,maxLength:200})]}),(0,w.jsx)(h.default,{style:[Xt.submitButton,t&&Xt.disabledButton],onPress:async()=>{if(j.nombreequipo.trim())if(j.idcategoria){o(!0);try{const e={nombreequipo:j.nombreequipo.trim(),idcategoria:Number(j.idcategoria),estado:"disponible",descripcion:j.descripcion.trim()},{data:t,error:o}=await b.supabase.from("equipos").insert([e]).select();if(o)throw o;const a=`equipos://${t[0].idequipo}`;p(a),y(t[0].idequipo),s(!0),v("\xa1\xc9xito!","El equipo se ha registrado exitosamente. Puede escanear el c\xf3digo QR para ver los detalles.")}catch(e){console.error("Error al guardar equipo:",e);let t="Ocurri\xf3 un error al intentar guardar el equipo.";e.message.includes("duplicate key")?t="Ya existe un equipo con ese nombre. Por favor use un nombre diferente.":e.message&&(t=`Error: ${e.message}`),v("Error",t)}finally{o(!1)}}else v("Campo requerido","Por favor seleccione una categor\xeda");else v("Campo requerido","Por favor ingrese el nombre del equipo")},disabled:t,children:t?(0,w.jsx)(f.default,{color:"#ffffff"}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(B.default,{name:"save",size:20,color:"#ffffff",style:Xt.buttonIcon}),(0,w.jsx)(c.default,{style:Xt.submitButtonText,children:"Guardar Equipo"})]})})]})})})]})})},{width:Qt}=x.default.get("window"),Yt=Qt<768,Zt=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa",maxWidth:1200,width:"100%",alignSelf:"center"},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:Yt?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},refreshButton:{marginLeft:16},headerTitle:{fontSize:Yt?18:20,fontWeight:"600",color:"#2c3e50",flex:1,textAlign:"center"},controlsContainer:{padding:Yt?16:20,backgroundColor:"#ffffff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},searchContainer:{flexDirection:"row",alignItems:"center",marginBottom:16},searchInput:{flex:1,height:40,backgroundColor:"#f8f9fa",borderRadius:8,paddingHorizontal:16,fontSize:16,color:"#2c3e50",borderWidth:1,borderColor:"#e0e0e0"},searchButton:{backgroundColor:"#4a6da7",width:40,height:40,borderRadius:8,marginLeft:8,justifyContent:"center",alignItems:"center"},filterContainer:{flexDirection:"row",alignItems:"center"},filterLabel:{fontSize:14,color:"#6c757d",marginRight:8},pickerContainer:{flex:1,borderWidth:1,borderColor:"#ddd",borderRadius:8,overflow:"hidden"},picker:{height:40,width:"100%"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:18,color:"#495057",marginTop:16},refreshButtonLarge:{marginTop:16,backgroundColor:"#4a6da7",paddingVertical:12,paddingHorizontal:24,borderRadius:8},refreshButtonText:{color:"white",fontWeight:"500",fontSize:16},listContent:{padding:Yt?8:16},itemContainer:{backgroundColor:"#ffffff",borderRadius:8,padding:16,marginBottom:12,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:1},itemHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},itemName:{fontSize:18,fontWeight:"500",color:"#2c3e50",flex:1},statusBadge:{paddingHorizontal:8,paddingVertical:4,borderRadius:12,marginLeft:8},statusText:{fontSize:12,fontWeight:"600",color:"#ffffff"},itemDetails:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",marginBottom:8},detailText:{fontSize:14,color:"#7f8c8d",marginBottom:4,width:"48%"},itemDescription:{fontSize:14,color:"#34495e",lineHeight:20,marginBottom:12},itemActions:{flexDirection:"row",justifyContent:"flex-end",marginTop:8},actionButton:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:12,borderRadius:6,marginLeft:8},editButton:{backgroundColor:"#4a6da7"},deleteButton:{backgroundColor:"#e74c3c"},actionButtonText:{color:"white",marginLeft:6,fontWeight:"500"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},modalContent:{width:Yt?"90%":"70%",backgroundColor:"white",borderRadius:10,padding:20},modalTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},deleteMessage:{fontSize:16,color:"#7f8c8d",marginBottom:20,textAlign:"center"},formGroup:{marginBottom:16},label:{fontSize:14,color:"#7f8c8d",marginBottom:6},input:{borderWidth:1,borderColor:"#ddd",borderRadius:6,padding:10,fontSize:16},textArea:{height:100,textAlignVertical:"top"},modalButtons:{flexDirection:"row",justifyContent:"space-between",marginTop:20},modalButton:{flex:1,padding:12,borderRadius:6,justifyContent:"center",alignItems:"center"},cancelButton:{backgroundColor:"#95a5a6",marginRight:8},saveButton:{backgroundColor:"#4a6da7"},modalButtonText:{color:"white",fontWeight:"500"}}),Kt=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),[u,m]=(0,n.useState)(""),[x,y]=(0,n.useState)("todos"),[j,C]=(0,n.useState)(!1),[v,S]=(0,n.useState)(null),[T,z]=(0,n.useState)({nombreequipo:"",idcategoria:"",estado:"disponible",descripcion:""}),[q,k]=(0,n.useState)([]),[I,R]=(0,n.useState)(!1),[O,F]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{r(!0);const{data:e,error:t}=await b.supabase.from("categoriasequipos").select("idcategoria, nombrecategoria").order("nombrecategoria",{ascending:!0});if(t)throw t;k(e||[]),await W()}catch(e){console.error("Error al cargar datos:",e),p.default.alert("Error","No se pudieron cargar los datos")}finally{r(!1)}})()}),[]);const W=async()=>{try{r(!0);const{data:e,error:t}=await b.supabase.from("equipos").select("\n          idequipo,\n          nombreequipo,\n          idcategoria,\n          estado,\n          descripcion,\n          fechacreacion,\n          categoriasequipos: idcategoria (nombrecategoria)\n        ").neq("estado","en mantenimiento").order("nombreequipo",{ascending:!0});if(t)throw t;o(e||[])}catch(e){console.error("Error al cargar equipos:",e),p.default.alert("Error",e.message||"Error al cargar equipos")}finally{r(!1)}},A=(e,t)=>{z(Object.assign({},T,{[e]:t}))},L=e=>{switch(e){case"disponible":return"#2ecc71";case"prestado":return"#3498db";case"reservado":return"#f39c12";case"no disponible":return"#e74c3c";default:return"#95a5a6"}};return(0,w.jsx)(g.default,{style:Zt.safeArea,children:(0,w.jsxs)(d.default,{style:Zt.container,children:[(0,w.jsxs)(d.default,{style:Zt.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:Zt.menuButton,children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:Zt.headerTitle,children:"Administrar Equipos"}),(0,w.jsx)(h.default,{onPress:W,style:Zt.refreshButton,children:(0,w.jsx)(B.default,{name:"refresh",size:24,color:"#2c3e50"})})]}),(0,w.jsxs)(d.default,{style:Zt.controlsContainer,children:[(0,w.jsxs)(d.default,{style:Zt.searchContainer,children:[(0,w.jsx)(D.default,{style:Zt.searchInput,placeholder:"Buscar equipos...",value:u,onChangeText:m,placeholderTextColor:"#999"}),(0,w.jsx)(h.default,{style:Zt.searchButton,onPress:W,children:(0,w.jsx)(B.default,{name:"search",size:20,color:"white"})})]}),(0,w.jsxs)(d.default,{style:Zt.filterContainer,children:[(0,w.jsx)(c.default,{style:Zt.filterLabel,children:"Filtrar por estado:"}),(0,w.jsx)(d.default,{style:Zt.pickerContainer,children:(0,w.jsxs)(st.Picker,{selectedValue:x,onValueChange:e=>{y(e),W()},style:Zt.picker,children:[(0,w.jsx)(st.Picker.Item,{label:"Todos",value:"todos"}),(0,w.jsx)(st.Picker.Item,{label:"Disponible",value:"disponible"}),(0,w.jsx)(st.Picker.Item,{label:"Prestado",value:"prestado"}),(0,w.jsx)(st.Picker.Item,{label:"Reservado",value:"reservado"}),(0,w.jsx)(st.Picker.Item,{label:"No disponible",value:"no disponible"})]})})]})]}),a&&!l?(0,w.jsxs)(d.default,{style:Zt.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:Zt.loadingText,children:"Cargando equipos..."})]}):0===t.length?(0,w.jsxs)(d.default,{style:Zt.emptyContainer,children:[(0,w.jsx)(B.default,{name:"info-outline",size:48,color:"#95a5a6"}),(0,w.jsx)(c.default,{style:Zt.emptyText,children:"No se encontraron equipos"}),(0,w.jsx)(h.default,{style:Zt.refreshButtonLarge,onPress:W,children:(0,w.jsx)(c.default,{style:Zt.refreshButtonText,children:"Recargar"})})]}):(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsxs)(d.default,{style:Zt.itemContainer,children:[(0,w.jsxs)(d.default,{style:Zt.itemHeader,children:[(0,w.jsx)(c.default,{style:Zt.itemName,children:e.nombreequipo}),(0,w.jsx)(d.default,{style:[Zt.statusBadge,{backgroundColor:L(e.estado)}],children:(0,w.jsx)(c.default,{style:Zt.statusText,children:e.estado.toUpperCase()})})]}),(0,w.jsxs)(d.default,{style:Zt.itemDetails,children:[(0,w.jsxs)(c.default,{style:Zt.detailText,children:[(0,w.jsx)(B.default,{name:"category",size:16,color:"#7f8c8d"})," ",e.categoriasequipos?.nombrecategoria||"Sin categor\xeda"]}),(0,w.jsxs)(c.default,{style:Zt.detailText,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:16,color:"#7f8c8d"})," ",new Date(e.fechacreacion).toLocaleDateString()]}),e.fechacreacion&&(0,w.jsxs)(c.default,{style:Zt.detailText,children:[(0,w.jsx)(B.default,{name:"update",size:16,color:"#7f8c8d"})," Creado: ",new Date(e.fechacreacion).toLocaleDateString()]})]}),e.descripcion&&(0,w.jsx)(c.default,{style:Zt.itemDescription,numberOfLines:2,children:e.descripcion}),(0,w.jsxs)(d.default,{style:Zt.itemActions,children:[(0,w.jsxs)(h.default,{style:[Zt.actionButton,Zt.editButton],onPress:()=>{return S(t=e),z({nombreequipo:t.nombreequipo,idcategoria:String(t.idcategoria),estado:t.estado,descripcion:t.descripcion||""}),void C(!0);var t},children:[(0,w.jsx)(B.default,{name:"edit",size:18,color:"white"}),(0,w.jsx)(c.default,{style:Zt.actionButtonText,children:"Editar"})]}),(0,w.jsxs)(h.default,{style:[Zt.actionButton,Zt.deleteButton],onPress:()=>(F(e),void R(!0)),disabled:"no disponible"===e.estado,children:[(0,w.jsx)(B.default,{name:"delete",size:18,color:"white"}),(0,w.jsx)(c.default,{style:Zt.actionButtonText,children:"Eliminar"})]})]})]}),keyExtractor:e=>e.idequipo.toString(),contentContainerStyle:Zt.listContent,refreshControl:(0,w.jsx)(fe.default,{refreshing:l,onRefresh:W,colors:["#4a6da7"]})}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!0,visible:j,onRequestClose:()=>C(!1),children:(0,w.jsx)(d.default,{style:Zt.modalContainer,children:(0,w.jsxs)(d.default,{style:Zt.modalContent,children:[(0,w.jsx)(c.default,{style:Zt.modalTitle,children:"Editar Equipo"}),(0,w.jsxs)(d.default,{style:Zt.formGroup,children:[(0,w.jsx)(c.default,{style:Zt.label,children:"Nombre*"}),(0,w.jsx)(D.default,{style:Zt.input,value:T.nombreequipo,onChangeText:e=>A("nombreequipo",e),placeholder:"Nombre del equipo"})]}),(0,w.jsxs)(d.default,{style:Zt.formGroup,children:[(0,w.jsx)(c.default,{style:Zt.label,children:"Categor\xeda*"}),(0,w.jsx)(d.default,{style:Zt.pickerContainer,children:(0,w.jsxs)(st.Picker,{selectedValue:T.idcategoria,onValueChange:e=>A("idcategoria",e),style:Zt.picker,children:[(0,w.jsx)(st.Picker.Item,{label:"Seleccione categor\xeda",value:""}),q.map((e=>(0,w.jsx)(st.Picker.Item,{label:e.nombrecategoria,value:String(e.idcategoria)},e.idcategoria)))]})})]}),(0,w.jsxs)(d.default,{style:Zt.formGroup,children:[(0,w.jsx)(c.default,{style:Zt.label,children:"Estado*"}),(0,w.jsx)(d.default,{style:Zt.pickerContainer,children:(0,w.jsxs)(st.Picker,{selectedValue:T.estado,onValueChange:e=>A("estado",e),style:Zt.picker,children:[(0,w.jsx)(st.Picker.Item,{label:"Disponible",value:"disponible"}),(0,w.jsx)(st.Picker.Item,{label:"Prestado",value:"prestado"}),(0,w.jsx)(st.Picker.Item,{label:"Reservado",value:"reservado"}),(0,w.jsx)(st.Picker.Item,{label:"No disponible",value:"no disponible"})]})})]}),(0,w.jsxs)(d.default,{style:Zt.formGroup,children:[(0,w.jsx)(c.default,{style:Zt.label,children:"Descripci\xf3n"}),(0,w.jsx)(D.default,{style:[Zt.input,Zt.textArea],value:T.descripcion,onChangeText:e=>A("descripcion",e),placeholder:"Descripci\xf3n del equipo",multiline:!0,numberOfLines:4})]}),(0,w.jsxs)(d.default,{style:Zt.modalButtons,children:[(0,w.jsx)(h.default,{style:[Zt.modalButton,Zt.cancelButton],onPress:()=>C(!1),disabled:a,children:(0,w.jsx)(c.default,{style:Zt.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[Zt.modalButton,Zt.saveButton],onPress:async()=>{if(T.nombreequipo&&T.idcategoria)try{r(!0);const{error:e}=await b.supabase.from("equipos").update({nombreequipo:T.nombreequipo,idcategoria:Number(T.idcategoria),estado:T.estado,descripcion:T.descripcion}).eq("idequipo",v.idequipo);if(e)throw e;p.default.alert("\xc9xito","Equipo actualizado correctamente"),C(!1),W()}catch(e){console.error("Error al actualizar equipo:",e),p.default.alert("Error","No se pudo actualizar el equipo")}finally{r(!1)}else p.default.alert("Error","Por favor complete todos los campos obligatorios")},disabled:a,children:a?(0,w.jsx)(f.default,{color:"white"}):(0,w.jsx)(c.default,{style:Zt.modalButtonText,children:"Guardar"})})]})]})})}),(0,w.jsx)(E.default,{animationType:"fade",transparent:!0,visible:I,onRequestClose:()=>R(!1),children:(0,w.jsx)(d.default,{style:Zt.modalContainer,children:(0,w.jsxs)(d.default,{style:Zt.modalContent,children:[(0,w.jsx)(c.default,{style:Zt.modalTitle,children:"Confirmar Eliminaci\xf3n"}),(0,w.jsxs)(c.default,{style:Zt.deleteMessage,children:['\xbfEst\xe1 seguro que desea marcar el equipo "',O?.nombreequipo,'" como no disponible?']}),(0,w.jsxs)(d.default,{style:Zt.modalButtons,children:[(0,w.jsx)(h.default,{style:[Zt.modalButton,Zt.cancelButton],onPress:()=>R(!1),disabled:a,children:(0,w.jsx)(c.default,{style:Zt.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[Zt.modalButton,Zt.deleteButton],onPress:async()=>{try{r(!0);const{error:e}=await b.supabase.from("equipos").update({estado:"no disponible",fechaactualizacion:(new Date).toISOString()}).eq("idequipo",O.idequipo);if(e)throw e;p.default.alert("\xc9xito","Equipo marcado como no disponible"),R(!1),W()}catch(e){console.error("Error al eliminar equipo:",e),p.default.alert("Error","No se pudo actualizar el estado del equipo")}finally{r(!1)}},disabled:a,children:a?(0,w.jsx)(f.default,{color:"white"}):(0,w.jsx)(c.default,{style:Zt.modalButtonText,children:"Confirmar"})})]})]})})})]})})},{width:eo}=x.default.get("window"),to=eo<768,oo=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa",maxWidth:1200,width:"100%",alignSelf:"center"},header:{flexDirection:"row",alignItems:"center",padding:to?16:24,backgroundColor:"#ffffff",borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:to?22:24,fontWeight:"600",color:"#2c3e50",flex:1},headerSubtitle:{fontSize:14,color:"#7f8c8d",marginTop:4},searchContainer:{flexDirection:"row",padding:to?16:20,backgroundColor:"#ffffff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},searchInput:{flex:1,height:40,backgroundColor:"#f8f9fa",borderRadius:8,paddingHorizontal:16,fontSize:16,color:"#2c3e50"},searchButton:{backgroundColor:"#4a6da7",width:40,height:40,borderRadius:8,marginLeft:8,justifyContent:"center",alignItems:"center"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:16,color:"#6c757d",fontSize:16},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:18,color:"#495057",marginTop:16,textAlign:"center"},emptySubtext:{fontSize:14,color:"#6c757d",marginTop:8,textAlign:"center"},refreshButton:{marginTop:16,backgroundColor:"#4a6da7",paddingVertical:12,paddingHorizontal:24,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},refreshButtonText:{color:"white",fontWeight:"500",fontSize:16},listContent:{padding:to?8:16,paddingBottom:24},itemContainer:{backgroundColor:"#ffffff",borderRadius:12,padding:16,marginBottom:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},itemHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},itemName:{fontSize:18,fontWeight:"600",color:"#2c3e50",flex:1},statusBadge:{paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginLeft:8},statusText:{fontSize:12,fontWeight:"600",color:"#ffffff"},itemDetails:{marginBottom:12},detailText:{fontSize:14,color:"#6c757d",marginBottom:6},itemDescription:{fontSize:14,color:"#495057",lineHeight:20,marginBottom:12},itemActions:{flexDirection:"row",justifyContent:"space-between",marginTop:12},actionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:10,paddingHorizontal:16,borderRadius:8,marginHorizontal:4,flex:1,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},detailsButton:{backgroundColor:"#4a6da7"},qrButton:{backgroundColor:"#2c3e50"},actionButtonText:{color:"white",marginLeft:8,fontWeight:"500",fontSize:14},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},modalContent:{backgroundColor:"white",borderRadius:16,padding:24,width:to?"90%":"80%",maxWidth:400,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:10,elevation:5},modalTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},qrContainer:{padding:16,backgroundColor:"white",borderRadius:12,marginBottom:20,borderWidth:1,borderColor:"#e9ecef"},equipoName:{fontSize:18,fontWeight:"600",color:"#2c3e50",marginBottom:4,textAlign:"center"},equipoCategory:{fontSize:16,color:"#6c757d",marginBottom:20,textAlign:"center"},modalButtons:{flexDirection:"row",justifyContent:"space-between",width:"100%"},modalButton:{flexDirection:"row",alignItems:"center",paddingVertical:12,paddingHorizontal:16,borderRadius:8,flex:1,justifyContent:"center",marginHorizontal:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},closeButton:{backgroundColor:"#6c757d"},modalButtonText:{color:"white",marginLeft:8,fontWeight:"500",fontSize:16}}),ao=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),[u,m]=(0,n.useState)(""),[x,y]=(0,n.useState)(null),[j,C]=(0,n.useState)(!1),[v,S]=(0,n.useState)("");(0,n.useEffect)((()=>{T()}),[]);const T=async()=>{try{s(!0),r(!0);let e=b.supabase.from("equipos").select("\n          idequipo,\n          nombreequipo,\n          idcategoria,\n          estado,\n          descripcion,\n          fechacreacion,\n          categoriasequipos: categoriasequipos!inner(nombrecategoria)\n        ");u&&(e=e.ilike("nombreequipo",`%${u}%`)),e=e.order("nombreequipo",{ascending:!0});const{data:t,error:a}=await e;if(a)throw a;o(t||[])}catch(e){console.error("Error al cargar equipos:",e),p.default.alert("Error","No se pudieron cargar los equipos")}finally{r(!1),s(!1)}},z=()=>{T()},q=e=>{switch(e){case"disponible":return"#2ecc71";case"prestado":return"#3498db";case"reservado":return"#f39c12";case"no disponible":return"#e74c3c";case"en mantenimiento":return"#9b59b6";default:return"#95a5a6"}};return(0,w.jsx)(g.default,{style:oo.safeArea,children:(0,w.jsxs)(d.default,{style:oo.container,children:[(0,w.jsxs)(d.default,{style:oo.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:oo.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:oo.headerTitle,children:"Listado de Equipos"}),(0,w.jsxs)(c.default,{style:oo.headerSubtitle,children:["Total: ",t.length," equipos"]})]}),(0,w.jsxs)(d.default,{style:oo.searchContainer,children:[(0,w.jsx)(D.default,{style:oo.searchInput,placeholder:"Buscar equipos...",value:u,onChangeText:m,onSubmitEditing:z,placeholderTextColor:"#999"}),(0,w.jsx)(h.default,{style:oo.searchButton,onPress:z,children:(0,w.jsx)(B.default,{name:"search",size:20,color:"white"})})]}),a&&!l?(0,w.jsxs)(d.default,{style:oo.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:oo.loadingText,children:"Cargando equipos..."})]}):0===t.length?(0,w.jsxs)(d.default,{style:oo.emptyContainer,children:[(0,w.jsx)(B.default,{name:"inventory",size:48,color:"#95a5a6"}),(0,w.jsx)(c.default,{style:oo.emptyText,children:"No se encontraron equipos"}),(0,w.jsx)(c.default,{style:oo.emptySubtext,children:u?"Prueba con otros t\xe9rminos de b\xfasqueda":"No hay equipos registrados en el sistema"}),(0,w.jsx)(h.default,{style:oo.refreshButton,onPress:T,children:(0,w.jsx)(c.default,{style:oo.refreshButtonText,children:"Recargar"})})]}):(0,w.jsx)(P.default,{data:t,renderItem:({item:t})=>(0,w.jsxs)(d.default,{style:oo.itemContainer,children:[(0,w.jsxs)(d.default,{style:oo.itemHeader,children:[(0,w.jsx)(c.default,{style:oo.itemName,children:t.nombreequipo}),(0,w.jsx)(d.default,{style:[oo.statusBadge,{backgroundColor:q(t.estado)}],children:(0,w.jsx)(c.default,{style:oo.statusText,children:t.estado.toUpperCase()})})]}),(0,w.jsxs)(d.default,{style:oo.itemDetails,children:[(0,w.jsxs)(c.default,{style:oo.detailText,children:[(0,w.jsx)(B.default,{name:"category",size:16,color:"#7f8c8d"})," ",t.categoriasequipos?.nombrecategoria||"Sin categor\xeda"]}),(0,w.jsxs)(c.default,{style:oo.detailText,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:16,color:"#7f8c8d"})," ",new Date(t.fechacreacion).toLocaleDateString()]})]}),t.descripcion&&(0,w.jsx)(c.default,{style:oo.itemDescription,numberOfLines:2,children:t.descripcion}),(0,w.jsxs)(d.default,{style:oo.itemActions,children:[(0,w.jsxs)(h.default,{style:[oo.actionButton,oo.detailsButton],onPress:()=>e.navigate("DetallesEquipo",{equipoId:t.idequipo}),children:[(0,w.jsx)(B.default,{name:"info",size:18,color:"white"}),(0,w.jsx)(c.default,{style:oo.actionButtonText,children:"Detalles"})]}),(0,w.jsxs)(h.default,{style:[oo.actionButton,oo.qrButton],onPress:()=>(e=>{const t=`equipos://detalles/${e.idequipo}`;S(t),y(e),C(!0)})(t),children:[(0,w.jsx)(B.default,{name:"qr-code",size:18,color:"white"}),(0,w.jsx)(c.default,{style:oo.actionButtonText,children:"Ver QR"})]})]})]}),keyExtractor:e=>e.idequipo.toString(),contentContainerStyle:oo.listContent,refreshControl:(0,w.jsx)(fe.default,{refreshing:l,onRefresh:T,colors:["#4a6da7"],tintColor:"#4a6da7"}),ListEmptyComponent:(0,w.jsx)(d.default,{style:oo.emptyContainer,children:(0,w.jsx)(c.default,{style:oo.emptyText,children:"No hay equipos que coincidan con tu b\xfasqueda"})})}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!0,visible:j,onRequestClose:()=>C(!1),children:(0,w.jsx)(d.default,{style:oo.modalOverlay,children:(0,w.jsxs)(d.default,{style:oo.modalContent,children:[(0,w.jsx)(c.default,{style:oo.modalTitle,children:"C\xf3digo QR del Equipo"}),(0,w.jsx)(d.default,{style:oo.qrContainer,children:(0,w.jsx)($t.default,{value:v,size:to?250:300,color:"#2c3e50",backgroundColor:"white"})}),(0,w.jsx)(c.default,{style:oo.equipoName,children:x?.nombreequipo}),(0,w.jsx)(c.default,{style:oo.equipoCategory,children:x?.categoriasequipos?.nombrecategoria||"Sin categor\xeda"}),(0,w.jsxs)(d.default,{style:oo.modalButtons,children:[(0,w.jsxs)(h.default,{style:[oo.modalButton,oo.detailsButton],onPress:()=>{C(!1),e.navigate("DetallesEquipo",{equipoId:x.idequipo})},children:[(0,w.jsx)(B.default,{name:"info",size:18,color:"white"}),(0,w.jsx)(c.default,{style:oo.modalButtonText,children:"Ver Detalles"})]}),(0,w.jsxs)(h.default,{style:[oo.modalButton,oo.closeButton],onPress:()=>C(!1),children:[(0,w.jsx)(B.default,{name:"close",size:18,color:"white"}),(0,w.jsx)(c.default,{style:oo.modalButtonText,children:"Cerrar"})]})]})]})})})]})})},{width:ro}=x.default.get("window"),no=ro<768,io=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa",maxWidth:1200,width:"100%",alignSelf:"center"},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:no?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},refreshButton:{marginLeft:16},headerTitle:{fontSize:no?18:20,fontWeight:"600",color:"#2c3e50",flex:1,textAlign:"center"},searchContainer:{flexDirection:"row",padding:no?16:20,backgroundColor:"#ffffff",borderBottomWidth:1,borderBottomColor:"#e0e0e0"},searchInput:{flex:1,height:40,backgroundColor:"#f8f9fa",borderRadius:8,paddingHorizontal:16,fontSize:16,color:"#2c3e50",borderWidth:1,borderColor:"#e0e0e0"},searchButton:{backgroundColor:"#4a6da7",width:40,height:40,borderRadius:8,marginLeft:8,justifyContent:"center",alignItems:"center"},addButton:{backgroundColor:"#2ecc71",width:40,height:40,borderRadius:8,marginLeft:8,justifyContent:"center",alignItems:"center"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:18,color:"#495057",marginTop:16,textAlign:"center"},emptySubtext:{fontSize:14,color:"#6c757d",marginTop:8,textAlign:"center"},refreshButtonLarge:{marginTop:16,backgroundColor:"#4a6da7",paddingVertical:12,paddingHorizontal:24,borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},refreshButtonText:{color:"white",fontWeight:"500",fontSize:16},listContent:{padding:no?8:16,paddingBottom:24},itemContainer:{backgroundColor:"#ffffff",borderRadius:12,marginBottom:12,marginHorizontal:no?8:16,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2,overflow:"hidden"},itemContent:{padding:16},itemHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:12},itemName:{fontSize:18,fontWeight:"600",color:"#2c3e50",flex:1},statusBadge:{paddingHorizontal:12,paddingVertical:6,borderRadius:16,marginLeft:8},statusText:{fontSize:12,fontWeight:"600",color:"#ffffff"},itemDetails:{marginBottom:12},detailText:{fontSize:14,color:"#6c757d",marginBottom:6,flexDirection:"row",alignItems:"center"},actionModalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},actionModalContent:{backgroundColor:"white",borderRadius:16,padding:24,width:no?"90%":"60%",maxWidth:400},actionModalTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},actionModalButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:14,paddingHorizontal:16,borderRadius:8,marginBottom:12},actionModalButtonText:{color:"white",marginLeft:10,fontWeight:"500",fontSize:16},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},modalContent:{backgroundColor:"white",borderRadius:16,padding:24,width:no?"90%":"80%",maxWidth:400,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.2,shadowRadius:10,elevation:5},modalTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50",marginTop:16,marginBottom:8,textAlign:"center"},modalText:{fontSize:16,color:"#6c757d",marginBottom:24,textAlign:"center"},modalButtons:{flexDirection:"row",justifyContent:"space-between",width:"100%"},modalButton:{paddingVertical:12,paddingHorizontal:24,borderRadius:8,flex:1,justifyContent:"center",marginHorizontal:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},cancelButton:{backgroundColor:"#6c757d"},confirmButton:{backgroundColor:"#e74c3c"},modalButtonText:{color:"white",fontWeight:"500",fontSize:16,textAlign:"center"},formModalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},formModalContent:{backgroundColor:"white",borderRadius:16,padding:24,width:no?"90%":"60%",maxWidth:500,maxHeight:"90%"},formModalTitle:{fontSize:20,fontWeight:"600",color:"#2c3e50",marginBottom:20,textAlign:"center"},label:{fontSize:14,color:"#6c757d",marginBottom:8,fontWeight:"500"},input:{backgroundColor:"#f8f9fa",borderRadius:8,padding:12,marginBottom:16,fontSize:16,color:"#2c3e50",borderWidth:1,borderColor:"#e0e0e0"},textArea:{minHeight:100,textAlignVertical:"top"},formModalButtons:{flexDirection:"row",justifyContent:"space-between",marginTop:20},formModalButton:{paddingVertical:12,paddingHorizontal:24,borderRadius:8,flex:1,justifyContent:"center",marginHorizontal:8,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},submitButton:{backgroundColor:"#4a6da7"},formModalButtonText:{color:"white",fontWeight:"500",fontSize:16,textAlign:"center"},editButton:{backgroundColor:"#f39c12"},deleteButton:{backgroundColor:"#e74c3c"},webSuccessMessage:{position:"fixed",top:20,left:"50%",transform:[{translateX:-180}],width:360,backgroundColor:"#D1FAE5",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},webSuccessText:{color:"#065F46",marginLeft:10,fontSize:14,fontWeight:"500"},webErrorMessage:{position:"fixed",top:20,left:"50%",transform:[{translateX:-180}],width:360,backgroundColor:"#FEE2E2",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},webErrorText:{color:"#B91C1C",marginLeft:10,fontSize:14,fontWeight:"500"},mobileSuccessMessage:{position:"absolute",bottom:20,left:20,right:20,backgroundColor:"#D1FAE5",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},mobileErrorMessage:{position:"absolute",bottom:20,left:20,right:20,backgroundColor:"#FEE2E2",padding:16,borderRadius:8,flexDirection:"row",alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,zIndex:1e3},mobileMessageText:{marginLeft:10,fontSize:14,fontWeight:"500"}}),lo=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),[u,p]=(0,n.useState)(""),[x,y]=(0,n.useState)(!1),[j,C]=(0,n.useState)(!1),[v,S]=(0,n.useState)(!1),[T,q]=(0,n.useState)(null),[k,I]=(0,n.useState)({nombrecategoria:"",descripcion:""}),[R,O]=(0,n.useState)("create"),[F,W]=(0,n.useState)(!1),[A,L]=(0,n.useState)(""),[N,H]=(0,n.useState)(!1),[V,M]=(0,n.useState)("");(0,n.useEffect)((()=>{_()}),[]);const _=async()=>{try{s(!0),r(!0);let e=b.supabase.from("categoriasequipos").select("*");u&&(e=e.ilike("nombrecategoria",`%${u}%`)),e=e.order("nombrecategoria",{ascending:!0});const{data:t,error:a}=await e;if(a)throw a;o(t||[])}catch(e){console.error("Error al cargar categor\xedas:",e),U("No se pudieron cargar las categor\xedas")}finally{r(!1),s(!1)}},$=e=>{L(e),W(!0),setTimeout((()=>W(!1)),3e3)},U=e=>{M(e),H(!0),setTimeout((()=>H(!1)),3e3),console.error(e)},G=()=>{_()},X=(e,t)=>{I((o=>Object.assign({},o,{[e]:t})))},J=e=>{switch(e){case"activo":return"#2ecc71";case"inactivo":return"#e74c3c";default:return"#95a5a6"}};return a&&!l?(0,w.jsxs)(g.default,{style:io.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:io.loadingText,children:"Cargando categor\xedas..."})]}):(0,w.jsx)(g.default,{style:io.safeArea,children:(0,w.jsxs)(d.default,{style:io.container,children:[(0,w.jsxs)(d.default,{style:io.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:io.menuButton,children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:io.headerTitle,children:"Gesti\xf3n de Categor\xedas"}),(0,w.jsx)(h.default,{onPress:_,style:io.refreshButton,children:(0,w.jsx)(B.default,{name:"refresh",size:24,color:"#2c3e50"})})]}),F&&(0,w.jsxs)(d.default,{style:io.webSuccessMessage,children:[(0,w.jsx)(B.default,{name:"check-circle",size:20,color:"#10B981"}),(0,w.jsx)(c.default,{style:io.webSuccessText,children:A})]}),N&&(0,w.jsxs)(d.default,{style:io.webErrorMessage,children:[(0,w.jsx)(B.default,{name:"error",size:20,color:"#EF4444"}),(0,w.jsx)(c.default,{style:io.webErrorText,children:V})]}),(0,w.jsxs)(d.default,{style:io.searchContainer,children:[(0,w.jsx)(D.default,{style:io.searchInput,placeholder:"Buscar categor\xedas...",value:u,onChangeText:p,onSubmitEditing:G,placeholderTextColor:"#999"}),(0,w.jsx)(h.default,{style:io.searchButton,onPress:G,children:(0,w.jsx)(B.default,{name:"search",size:20,color:"white"})}),(0,w.jsx)(h.default,{style:io.addButton,onPress:()=>{q(null),I({nombrecategoria:"",descripcion:""}),O("create"),C(!0)},children:(0,w.jsx)(B.default,{name:"add",size:24,color:"white"})})]}),0===t.length?(0,w.jsxs)(d.default,{style:io.emptyContainer,children:[(0,w.jsx)(z.default,{name:"shape-outline",size:48,color:"#95a5a6"}),(0,w.jsx)(c.default,{style:io.emptyText,children:"No se encontraron categor\xedas"}),(0,w.jsx)(c.default,{style:io.emptySubtext,children:u?"Prueba con otros t\xe9rminos de b\xfasqueda":"No hay categor\xedas registradas en el sistema"}),(0,w.jsx)(h.default,{style:io.refreshButtonLarge,onPress:_,children:(0,w.jsx)(c.default,{style:io.refreshButtonText,children:"Recargar"})})]}):(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsx)(h.default,{onPress:()=>(q(e),void S(!0)),children:(0,w.jsx)(d.default,{style:io.itemContainer,children:(0,w.jsxs)(d.default,{style:io.itemContent,children:[(0,w.jsxs)(d.default,{style:io.itemHeader,children:[(0,w.jsx)(c.default,{style:io.itemName,children:e.nombrecategoria}),(0,w.jsx)(d.default,{style:[io.statusBadge,{backgroundColor:J(e.estado||"activo")}],children:(0,w.jsx)(c.default,{style:io.statusText,children:(e.estado||"activo").toUpperCase()})})]}),(0,w.jsxs)(d.default,{style:io.itemDetails,children:[e.descripcion&&(0,w.jsxs)(c.default,{style:io.detailText,numberOfLines:2,children:[(0,w.jsx)(B.default,{name:"description",size:16,color:"#7f8c8d"})," ",e.descripcion]}),(0,w.jsxs)(c.default,{style:io.detailText,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:16,color:"#7f8c8d"})," ",new Date(e.fechacreacion||new Date).toLocaleDateString()]})]})]})})}),keyExtractor:e=>e.idcategoria.toString(),contentContainerStyle:io.listContent,refreshControl:(0,w.jsx)(fe.default,{refreshing:l,onRefresh:_,colors:["#4a6da7"],tintColor:"#4a6da7"})}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!0,visible:v,onRequestClose:()=>S(!1),children:(0,w.jsx)(d.default,{style:io.actionModalOverlay,children:(0,w.jsxs)(d.default,{style:io.actionModalContent,children:[(0,w.jsx)(c.default,{style:io.actionModalTitle,children:T?.nombrecategoria}),(0,w.jsxs)(h.default,{style:[io.actionModalButton,io.editButton],onPress:()=>{return q(e=T),I({nombrecategoria:e.nombrecategoria,descripcion:e.descripcion||""}),O("edit"),C(!0),void S(!1);var e},children:[(0,w.jsx)(B.default,{name:"edit",size:20,color:"white"}),(0,w.jsx)(c.default,{style:io.actionModalButtonText,children:"Editar Categor\xeda"})]}),(0,w.jsxs)(h.default,{style:[io.actionModalButton,io.deleteButton],onPress:()=>{S(!1),y(!0)},children:[(0,w.jsx)(B.default,{name:"delete",size:20,color:"white"}),(0,w.jsx)(c.default,{style:io.actionModalButtonText,children:"Eliminar Categor\xeda"})]}),(0,w.jsx)(h.default,{style:[io.actionModalButton,io.cancelButton],onPress:()=>S(!1),children:(0,w.jsx)(c.default,{style:io.actionModalButtonText,children:"Cancelar"})})]})})}),(0,w.jsx)(E.default,{animationType:"fade",transparent:!0,visible:x,onRequestClose:()=>y(!1),children:(0,w.jsx)(d.default,{style:io.modalOverlay,children:(0,w.jsxs)(d.default,{style:io.modalContent,children:[(0,w.jsx)(z.default,{name:"alert-circle-outline",size:48,color:"#e74c3c"}),(0,w.jsx)(c.default,{style:io.modalTitle,children:"\xbfEliminar categor\xeda?"}),(0,w.jsxs)(c.default,{style:io.modalText,children:['Est\xe1s a punto de eliminar la categor\xeda "',T?.nombrecategoria,'". Esta acci\xf3n no se puede deshacer.']}),(0,w.jsxs)(d.default,{style:io.modalButtons,children:[(0,w.jsx)(h.default,{style:[io.modalButton,io.cancelButton],onPress:()=>y(!1),children:(0,w.jsx)(c.default,{style:io.modalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[io.modalButton,io.confirmButton],onPress:async()=>{try{const{count:e,error:t}=await b.supabase.from("equipos").select("*",{count:"exact"}).eq("idcategoria",T.idcategoria);if(t)throw t;if(e>0)return U("No se puede eliminar la categor\xeda porque tiene equipos asociados"),y(!1),void S(!1);const{error:o}=await b.supabase.from("categoriasequipos").delete().eq("idcategoria",T.idcategoria);if(o)throw o;y(!1),S(!1),_(),$("Categor\xeda eliminada correctamente")}catch(e){console.error("Error al eliminar categor\xeda:",e),U("No se pudo eliminar la categor\xeda")}},children:(0,w.jsx)(c.default,{style:io.modalButtonText,children:"Eliminar"})})]})]})})}),(0,w.jsx)(E.default,{animationType:"slide",transparent:!0,visible:j,onRequestClose:()=>C(!1),children:(0,w.jsx)(d.default,{style:io.formModalOverlay,children:(0,w.jsxs)(m.default,{style:io.formModalContent,children:[(0,w.jsx)(c.default,{style:io.formModalTitle,children:"edit"===R?"Editar Categor\xeda":"Crear Nueva Categor\xeda"}),(0,w.jsx)(c.default,{style:io.label,children:"Nombre de la categor\xeda *"}),(0,w.jsx)(D.default,{style:io.input,placeholder:"Ej: Laptops, Monitores, etc.",value:k.nombrecategoria,onChangeText:e=>X("nombrecategoria",e),placeholderTextColor:"#999"}),(0,w.jsx)(c.default,{style:io.label,children:"Descripci\xf3n"}),(0,w.jsx)(D.default,{style:[io.input,io.textArea],placeholder:"Descripci\xf3n opcional",value:k.descripcion,onChangeText:e=>X("descripcion",e),multiline:!0,numberOfLines:4,placeholderTextColor:"#999"}),(0,w.jsxs)(d.default,{style:io.formModalButtons,children:[(0,w.jsx)(h.default,{style:[io.formModalButton,io.cancelButton],onPress:()=>C(!1),children:(0,w.jsx)(c.default,{style:io.formModalButtonText,children:"Cancelar"})}),(0,w.jsx)(h.default,{style:[io.formModalButton,io.submitButton],onPress:async()=>{if(k.nombrecategoria.trim())try{r(!0);const e={nombrecategoria:k.nombrecategoria.trim(),descripcion:k.descripcion.trim(),estado:"activo"};if("edit"===R&&T?.idcategoria){const{data:t,error:o}=await b.supabase.from("categoriasequipos").update(e).eq("idcategoria",T.idcategoria).select();if(o)throw o;console.log("Categor\xeda actualizada:",t)}else{const{data:t,error:o}=await b.supabase.from("categoriasequipos").insert(e).select();if(o)throw o;console.log("Categor\xeda creada:",t)}$(`Categor\xeda ${"edit"===R?"actualizada":"creada"} correctamente`),C(!1),_()}catch(e){console.error("Error al guardar:",e),U(e.message||"Error en la operaci\xf3n")}finally{r(!1)}else U("El nombre de la categor\xeda es requerido")},disabled:a,children:a?(0,w.jsx)(f.default,{color:"white"}):(0,w.jsx)(c.default,{style:io.formModalButtonText,children:"edit"===R?"Guardar Cambios":"Crear Categor\xeda"})})]})]})})}),!1,!1]})})},{width:so}=x.default.get("window"),co=so<768,uo=u.default.create({safeArea:{flex:1,backgroundColor:"#f8f9fa"},container:{flex:1,backgroundColor:"#f8f9fa",width:"100%"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f8f9fa"},loadingText:{marginTop:16,fontSize:16,color:"#6c757d"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#ffffff",paddingVertical:16,paddingHorizontal:co?16:24,borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:3,elevation:2},menuButton:{marginRight:16},headerTitle:{fontSize:co?18:20,fontWeight:"600",color:"#2c3e50"},content:{flex:1,padding:co?16:24},statsContainer:{marginBottom:16},statCard:{backgroundColor:"#ffffff",borderRadius:12,padding:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2,flexDirection:"row",alignItems:"center"},statIconContainer:{width:48,height:48,borderRadius:24,justifyContent:"center",alignItems:"center",marginRight:16},statTitle:{fontSize:14,color:"#6c757d",marginBottom:4,fontWeight:"500"},statValue:{fontSize:28,fontWeight:"700",color:"#2c3e50"},section:{flex:1,backgroundColor:"#ffffff",borderRadius:12,padding:co?16:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.05,shadowRadius:6,elevation:2},sectionTitle:{fontSize:co?16:18,fontWeight:"600",color:"#2c3e50",marginBottom:16},categoryCard:{flexDirection:"row",alignItems:"center",backgroundColor:"#f8f9fa",borderRadius:8,padding:16,marginBottom:12,borderWidth:1,borderColor:"#e0e0e0"},categoryIconContainer:{width:40,height:40,borderRadius:20,backgroundColor:"#e3f2fd",justifyContent:"center",alignItems:"center",marginRight:16},categoryInfo:{flex:1},categoryName:{fontSize:16,fontWeight:"500",color:"#2c3e50",marginBottom:4},categoryDescription:{fontSize:14,color:"#6c757d",marginBottom:8},categoryDetails:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},statusBadge:{borderRadius:10,paddingHorizontal:8,paddingVertical:2},statusText:{fontSize:12,color:"#ffffff",fontWeight:"600"},categoryDate:{fontSize:12,color:"#7f8c8d"},emptyContainer:{flex:1,alignItems:"center",justifyContent:"center",paddingVertical:40},emptyText:{fontSize:16,color:"#95a5a6",marginTop:16},listContent:{paddingBottom:20},emptyListContent:{flex:1,justifyContent:"center"}}),fo=()=>{const e=(0,i.useNavigation)(),[t,o]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)(!1),u=async()=>{try{s(!0);const{data:e,error:t}=await b.supabase.from("categoriasequipos").select("idcategoria, nombrecategoria, descripcion, estado, fechacreacion").order("nombrecategoria",{ascending:!0});if(t)throw t;o(e||[])}catch(e){console.error("Error fetching categories:",e),p.default.alert("Error","No se pudieron cargar las categor\xedas")}finally{r(!1),s(!1)}};(0,n.useEffect)((()=>{u()}),[]);const m=e=>{switch(e.toLowerCase()){case"activo":return"#2ecc71";case"inactivo":return"#e74c3c";case"mantenimiento":return"#f39c12";default:return"#95a5a6"}};return a?(0,w.jsxs)(g.default,{style:uo.loadingContainer,children:[(0,w.jsx)(f.default,{size:"large",color:"#4a6da7"}),(0,w.jsx)(c.default,{style:uo.loadingText,children:"Cargando categor\xedas..."})]}):(0,w.jsx)(g.default,{style:uo.safeArea,children:(0,w.jsxs)(d.default,{style:[uo.container,!co&&{maxWidth:1200,alignSelf:"center"}],children:[(0,w.jsxs)(d.default,{style:uo.header,children:[(0,w.jsx)(h.default,{onPress:()=>e.openDrawer(),style:uo.menuButton,hitSlop:{top:20,bottom:20,left:20,right:20},children:(0,w.jsx)(B.default,{name:"menu",size:24,color:"#2c3e50"})}),(0,w.jsx)(c.default,{style:uo.headerTitle,children:"Lista de Categor\xedas"})]}),(0,w.jsxs)(d.default,{style:uo.content,children:[(0,w.jsx)(d.default,{style:uo.statsContainer,children:(0,w.jsxs)(d.default,{style:uo.statCard,children:[(0,w.jsx)(d.default,{style:[uo.statIconContainer,{backgroundColor:"#e3f2fd"}],children:(0,w.jsx)(z.default,{name:"shape-outline",size:24,color:"#1976d2"})}),(0,w.jsx)(c.default,{style:uo.statTitle,children:"Total de Categor\xedas  "}),(0,w.jsx)(c.default,{style:uo.statValue,children:t.length})]})}),(0,w.jsxs)(d.default,{style:uo.section,children:[(0,w.jsx)(c.default,{style:uo.sectionTitle,children:"Categor\xedas Registradas"}),(0,w.jsx)(P.default,{data:t,renderItem:({item:e})=>(0,w.jsxs)(d.default,{style:uo.categoryCard,children:[(0,w.jsx)(d.default,{style:uo.categoryIconContainer,children:(0,w.jsx)(z.default,{name:"shape-outline",size:24,color:"#4a6da7"})}),(0,w.jsxs)(d.default,{style:uo.categoryInfo,children:[(0,w.jsx)(c.default,{style:uo.categoryName,children:e.nombrecategoria}),e.descripcion&&(0,w.jsx)(c.default,{style:uo.categoryDescription,numberOfLines:2,children:e.descripcion}),(0,w.jsxs)(d.default,{style:uo.categoryDetails,children:[(0,w.jsx)(d.default,{style:[uo.statusBadge,{backgroundColor:m(e.estado)}],children:(0,w.jsx)(c.default,{style:uo.statusText,children:e.estado.toUpperCase()})}),(0,w.jsxs)(c.default,{style:uo.categoryDate,children:[(0,w.jsx)(B.default,{name:"calendar-today",size:14,color:"#7f8c8d"})," ",new Date(e.fechacreacion).toLocaleDateString("es-ES")]})]})]})]}),keyExtractor:e=>e.idcategoria,refreshControl:(0,w.jsx)(fe.default,{refreshing:l,onRefresh:u,colors:["#4a6da7"]}),ListEmptyComponent:(0,w.jsxs)(d.default,{style:uo.emptyContainer,children:[(0,w.jsx)(z.default,{name:"shape-outline",size:48,color:"#95a5a6"}),(0,w.jsx)(c.default,{style:uo.emptyText,children:"No hay categor\xedas registradas"})]}),contentContainerStyle:0===t.length?uo.emptyListContent:uo.listContent})]})]})]})})},ho=()=>(0,w.jsx)(d.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,w.jsx)(c.default,{children:"Pantalla de Sanciones"})}),mo=()=>(0,w.jsx)(d.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,w.jsx)(c.default,{children:"Pantalla de Manual Administrador"})});let go,po,xo;go=o(9866).default,po=o(5099).default,xo=o(5333).default;const bo=(0,l.createNativeStackNavigator)(),yo=(0,s.createDrawerNavigator)(),jo=()=>(0,w.jsxs)(yo.Navigator,{drawerContent:e=>(0,w.jsx)(ue,Object.assign({},e)),screenOptions:{headerShown:!1,drawerType:"front",drawerStyle:{width:280},drawerHideStatusBarOnOpen:!1,overlayColor:"transparent",drawerStatusBarAnimation:"fade"},children:[(0,w.jsx)(yo.Screen,{name:"PrincipalAdmin",component:R,options:{unmountOnBlur:!0,title:"Inicio Administrador"}}),(0,w.jsx)(yo.Screen,{name:"Prestamos",component:Pe,options:{unmountOnBlur:!0,title:"Gesti\xf3n de Pr\xe9stamos"}}),(0,w.jsx)(yo.Screen,{name:"HistorialPrestamos",component:Le,options:{unmountOnBlur:!0,title:"Historial de Pr\xe9stamos"}}),(0,w.jsx)(yo.Screen,{name:"Devoluciones",component:Me,options:{unmountOnBlur:!0,title:"Devoluciones"}}),(0,w.jsx)(yo.Screen,{name:"AgregarMantenimiento",component:ft,options:{unmountOnBlur:!0,title:"Registrar Mantenimiento"}}),(0,w.jsx)(yo.Screen,{name:"DevolverMantenimiento",component:pt,options:{unmountOnBlur:!0,title:"Devolver de Mantenimiento"}}),(0,w.jsx)(yo.Screen,{name:"ReporteMantenimiento",component:jt,options:{unmountOnBlur:!0,title:"Reportes de Mantenimiento"}}),(0,w.jsx)(yo.Screen,{name:"AgregarAdmin",component:St,options:{unmountOnBlur:!0,title:"Agregar Administrador"}}),(0,w.jsx)(yo.Screen,{name:"AgregarUsuarios",component:qt,options:{unmountOnBlur:!0,title:"Agregar Usuarios"}}),(0,w.jsx)(yo.Screen,{name:"ModificarUsuarios",component:Et,options:{unmountOnBlur:!0,title:"Modificar Usuarios"}}),(0,w.jsx)(yo.Screen,{name:"VerUsuarios",component:Ft,options:{unmountOnBlur:!0,title:"Listado de Usuarios"}}),(0,w.jsx)(yo.Screen,{name:"AgregarEquipos",component:Jt,options:{unmountOnBlur:!0,title:"Agregar Equipos"}}),(0,w.jsx)(yo.Screen,{name:"ModificarEquipos",component:Kt,options:{unmountOnBlur:!0,title:"Modificar Equipos"}}),(0,w.jsx)(yo.Screen,{name:"VerEquipos",component:ao,options:{unmountOnBlur:!0,title:"Inventario de Equipos"}}),(0,w.jsx)(yo.Screen,{name:"AgregarCategorias",component:lo,options:{unmountOnBlur:!0,title:"Agregar Categor\xedas"}}),(0,w.jsx)(yo.Screen,{name:"VerCategorias",component:fo,options:{unmountOnBlur:!0,title:"Listado de Categor\xedas"}}),(0,w.jsx)(yo.Screen,{name:"Sanciones",component:ho,options:{unmountOnBlur:!0,title:"Gesti\xf3n de Sanciones"}}),(0,w.jsx)(yo.Screen,{name:"Manual",component:mo,options:{unmountOnBlur:!0,title:"Manual del Sistema"}}),(0,w.jsx)(yo.Screen,{name:"PerfilUsuario",component:_t,options:{unmountOnBlur:!0,title:"Mi Perfil"}})]}),wo=()=>(0,w.jsxs)(yo.Navigator,{drawerContent:e=>(0,w.jsx)(Q,Object.assign({},e)),screenOptions:{headerShown:!1,drawerType:"front",drawerStyle:{width:280},drawerHideStatusBarOnOpen:!1,overlayColor:"transparent",drawerStatusBarAnimation:"fade"},children:[(0,w.jsx)(yo.Screen,{name:"SolicitarPrestamo",component:ae,options:{unmountOnBlur:!0,title:"Solicitar Pr\xe9stamo"}}),(0,w.jsx)(yo.Screen,{name:"PrestamosUsuarios",component:nt,options:{unmountOnBlur:!0,title:"Mis Pr\xe9stamos"}}),(0,w.jsx)(yo.Screen,{name:"DevolucionesUsuarios",component:lt,options:{unmountOnBlur:!0,title:"Mis Devoluciones"}}),(0,w.jsx)(yo.Screen,{name:"PerfilUsuario",component:_t,options:{unmountOnBlur:!0,title:"Mi Perfil"}})]}),Co={prefixes:["tuapp://","https://tuapp.com"],config:{screens:{Auth:"auth",Login:"login",Register:"register",AdminArea:{path:"admin",screens:{PrincipalAdmin:"inicio",VerEquipos:{path:"equipos",screens:{DetallesEquipo:":equipoId"}}}},UserArea:{path:"user",screens:{SolicitarPrestamo:"prestamos/solicitar",PrestamosUsuarios:"prestamos/mis-prestamos"}},DetallesEquipo:"equipos/:equipoId"}}};(0,a.default)((function(){return(0,w.jsx)(r.GestureHandlerRootView,{style:{flex:1},children:(0,w.jsx)(i.NavigationContainer,{linking:Co,children:(0,w.jsxs)(bo.Navigator,{initialRouteName:"Auth",screenOptions:{animation:"fade",animationDuration:200},children:[(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(bo.Screen,{name:"Auth",component:go,options:{headerShown:!1}}),(0,w.jsx)(bo.Screen,{name:"Login",component:po,options:{headerShown:!1,animation:"slide_from_right"}}),(0,w.jsx)(bo.Screen,{name:"Register",component:xo,options:{headerShown:!1,animation:"slide_from_right"}})]}),(0,w.jsx)(bo.Screen,{name:"AdminArea",component:jo,options:{headerShown:!1,animation:"fade"}}),(0,w.jsx)(bo.Screen,{name:"UserArea",component:wo,options:{headerShown:!1,animation:"fade"}}),(0,w.jsx)(bo.Screen,{name:"DetallesEquipo",component:T,options:{headerShown:!1,animation:"slide_from_right"}})]})})})}))},4023:(e,t,o)=>{o.r(t),o.d(t,{getCurrentSession:()=>s,signOut:()=>d,supabase:()=>l});var a=o(9561),r=o(3277);const n=r.default.expoConfig?.extra?.supabaseUrl||"https://dqiynypelfrofpyodrtx.supabase.co",i=r.default.expoConfig?.extra?.supabaseKey||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRxaXlueXBlbGZyb2ZweW9kcnR4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ1NjMyNzgsImV4cCI6MjA2MDEzOTI3OH0.nTYDHWCzZmufRlNJJOcPfxve9TBToj1BUtrFsB33zI4",l=(0,a.createClient)(n,i,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),s=async()=>{const{data:{session:e},error:t}=await l.auth.getSession();if(t)throw t;return e},d=async()=>{const{error:e}=await l.auth.signOut();if(e)throw e}},5099:(e,t,o)=>{o.r(t),o.d(t,{default:()=>w});var a=o(314),r=o(4485),n=o(2535),i=o(7137),l=o(2412),s=o(9772),d=o(7795),c=o(8798),u=o(4790),f=o(2057),h=o(3163),m=o(607),g=o(4023),p=o(7730);const{width:x,height:b}=f.default.get("window"),y=x<768,j=x>=768&&x<1024;function w({navigation:e}){const[t,o]=(0,a.useState)(""),[d,f]=(0,a.useState)(""),[x,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)({email:!1,password:!1}),w=e=>j(Object.assign({},y,{[e]:!0})),v=e=>j(Object.assign({},y,{[e]:!1}));return(0,p.jsx)(h.default,{behavior:"height",style:C.container,children:(0,p.jsx)(m.default,{contentContainerStyle:C.scrollContainer,keyboardShouldPersistTaps:"handled",children:(0,p.jsxs)(r.default,{style:C.card,children:[(0,p.jsx)(r.default,{style:C.logoContainer,children:(0,p.jsx)(s.default,{source:{uri:"https://utregionaldelsur.sidci.mx/img/logo.png"},style:C.logo,resizeMode:"contain"})}),(0,p.jsx)(n.default,{style:C.title,children:"Sistema de Gesti\xf3n de Equipos"}),(0,p.jsx)(n.default,{style:C.subtitle,children:"Inicio de sesi\xf3n"}),(0,p.jsxs)(r.default,{style:C.form,children:[(0,p.jsx)(n.default,{style:C.label,children:"Correo electr\xf3nico"}),(0,p.jsx)(i.default,{placeholder:"usuario@gmail.com",placeholderTextColor:"#9CA3AF",value:t,onChangeText:o,autoCapitalize:"none",keyboardType:"email-address",style:[C.input,y.email&&C.inputFocused],onFocus:()=>w("email"),onBlur:()=>v("email")}),(0,p.jsx)(n.default,{style:C.label,children:"Contrase\xf1a"}),(0,p.jsx)(i.default,{placeholder:"Min. 6 caracteres",placeholderTextColor:"#9CA3AF",value:d,onChangeText:f,secureTextEntry:!0,style:[C.input,y.password&&C.inputFocused],onFocus:()=>w("password"),onBlur:()=>v("password")}),(0,p.jsx)(l.default,{style:C.loginButton,onPress:async()=>{b(!0);try{const{error:o}=await g.supabase.auth.signInWithPassword({email:t,password:d});if(o)throw o;const{data:{user:a}}=await g.supabase.auth.getUser(),{data:r,error:n}=await g.supabase.from("usuarios").select("rol").eq("idusuario",a.id).single();if(n)throw n;"admin"===r.rol?e.replace("AdminArea",{screen:"PrincipalAdmin",params:{userId:a.id}}):e.replace("UserArea",{screen:"SolicitarPrestamo",params:{userId:a.id}})}catch(o){c.default.alert("Error de inicio de sesi\xf3n",o.message||"Ocurri\xf3 un error al iniciar sesi\xf3n")}finally{b(!1)}},disabled:x,children:x?(0,p.jsx)(u.default,{color:"#FFF",size:"small"}):(0,p.jsx)(n.default,{style:C.buttonText,children:"Ingresar"})}),(0,p.jsx)(l.default,{style:C.forgotPassword,onPress:()=>{},children:(0,p.jsx)(n.default,{style:C.forgotText,children:"\xbfOlvidaste tu contrase\xf1a?"})})]})]})})})}const C=d.default.create({container:{flex:1,backgroundColor:"#F3F4F6"},scrollContainer:{flexGrow:1,justifyContent:"center",padding:y?20:j?40:0},card:{backgroundColor:"#FFFFFF",borderRadius:12,padding:y?24:32,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,maxWidth:480,width:"100%",alignSelf:"center"},logoContainer:{alignItems:"center",marginBottom:24},logo:{width:y?200:240,height:y?80:100},title:{fontSize:y?20:24,fontWeight:"bold",color:"#111827",textAlign:"center",marginBottom:4},subtitle:{fontSize:y?16:18,color:"#6B7280",textAlign:"center",marginBottom:32},form:{marginBottom:24},label:{fontSize:14,color:"#374151",marginBottom:8,fontWeight:"500"},input:{height:48,borderWidth:1,borderColor:"#E5E7EB",borderRadius:8,paddingHorizontal:16,marginBottom:16,fontSize:16,color:"#111827",backgroundColor:"#F9FAFB"},inputFocused:{borderColor:"#3B82F6",backgroundColor:"#FFFFFF"},loginButton:{height:48,backgroundColor:"#3B82F6",borderRadius:8,justifyContent:"center",alignItems:"center",marginTop:8,shadowColor:"#3B82F6",shadowOffset:{width:0,height:2},shadowOpacity:.3,shadowRadius:4,elevation:3},buttonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600"},forgotPassword:{alignSelf:"flex-end",marginTop:12},forgotText:{color:"#3B82F6",fontSize:14,fontWeight:"500"}})},5333:(e,t,o)=>{o.r(t),o.d(t,{default:()=>j});var a=o(314),r=o(4485),n=o(2535),i=o(7137),l=o(2412),s=o(9772),d=o(7795),c=o(8798),u=o(4790),f=o(2057),h=o(3163),m=o(607),g=o(4023),p=o(7730);const{width:x}=f.default.get("window"),b=x<768,y=d.default.create({container:{flex:1,backgroundColor:"#F3F4F6"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},unauthorizedContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},unauthorizedText:{fontSize:24,fontWeight:"bold",color:"#EF4444",marginBottom:10},unauthorizedSubtext:{fontSize:16,color:"#6B7280",textAlign:"center",marginBottom:20},backButton:{backgroundColor:"#3B82F6",padding:15,borderRadius:8,width:"80%",alignItems:"center"},backButtonText:{color:"#FFFFFF",fontWeight:"600"},scrollContainer:{flexGrow:1,justifyContent:"center",padding:b?20:40},card:{backgroundColor:"#FFFFFF",borderRadius:12,padding:b?24:32,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:8,elevation:5,maxWidth:480,width:"100%",alignSelf:"center"},logoContainer:{alignItems:"center",marginBottom:24},logo:{width:b?200:240,height:b?80:100},title:{fontSize:b?20:24,fontWeight:"bold",color:"#111827",textAlign:"center",marginBottom:16},form:{marginBottom:24},label:{fontSize:14,color:"#374151",marginBottom:8,fontWeight:"500"},input:{height:48,borderWidth:1,borderColor:"#E5E7EB",borderRadius:8,paddingHorizontal:16,marginBottom:16,fontSize:16,color:"#111827",backgroundColor:"#F9FAFB"},registerButton:{height:48,backgroundColor:"#3B82F6",borderRadius:8,justifyContent:"center",alignItems:"center",marginTop:16},buttonText:{color:"#FFFFFF",fontSize:16,fontWeight:"600"}}),j=({navigation:e})=>{const[t,o]=(0,a.useState)(""),[d,f]=(0,a.useState)(""),[x,b]=(0,a.useState)(""),[j,w]=(0,a.useState)(!1),[C,v]=(0,a.useState)(!1),[S,T]=(0,a.useState)(!0);(0,a.useEffect)((()=>{(async()=>{const{data:{user:e}}=await g.supabase.auth.getUser();if(e){const{data:t,error:o}=await g.supabase.from("usuarios").select("rol").eq("idusuario",e.id).single();!o&&t&&"admin"===t.rol&&v(!0)}T(!1)})()}),[]);return S?(0,p.jsx)(r.default,{style:y.loadingContainer,children:(0,p.jsx)(u.default,{size:"large"})}):C?(0,p.jsx)(h.default,{behavior:"height",style:y.container,children:(0,p.jsx)(m.default,{contentContainerStyle:y.scrollContainer,children:(0,p.jsxs)(r.default,{style:y.card,children:[(0,p.jsx)(r.default,{style:y.logoContainer,children:(0,p.jsx)(s.default,{source:{uri:"https://utregionaldelsur.sidci.mx/img/logo.png"},style:y.logo,resizeMode:"contain"})}),(0,p.jsx)(n.default,{style:y.title,children:"Registrar Nuevo Administrador"}),(0,p.jsxs)(r.default,{style:y.form,children:[(0,p.jsx)(n.default,{style:y.label,children:"Nombre completo"}),(0,p.jsx)(i.default,{style:y.input,placeholder:"Nombre del administrador",placeholderTextColor:"#9CA3AF",value:x,onChangeText:b}),(0,p.jsx)(n.default,{style:y.label,children:"Correo electr\xf3nico"}),(0,p.jsx)(i.default,{style:y.input,placeholder:"admin@institucion.edu",placeholderTextColor:"#9CA3AF",value:t,onChangeText:o,autoCapitalize:"none",keyboardType:"email-address"}),(0,p.jsx)(n.default,{style:y.label,children:"Contrase\xf1a"}),(0,p.jsx)(i.default,{style:y.input,placeholder:"M\xednimo 6 caracteres",placeholderTextColor:"#9CA3AF",value:d,onChangeText:f,secureTextEntry:!0}),(0,p.jsx)(l.default,{style:y.registerButton,onPress:async()=>{if(t&&d&&x){w(!0);try{const{data:{user:o},error:a}=await g.supabase.auth.signUp({email:t,password:d,options:{data:{username:x}}});if(a)throw a;const{error:r}=await g.supabase.from("usuarios").insert({idusuario:o.id,nombreusuario:x,email:t,rol:"admin"});if(r)throw await g.supabase.auth.admin.deleteUser(o.id),r;c.default.alert("Registro exitoso","Nuevo administrador registrado. Verifica el correo electr\xf3nico.",[{text:"OK",onPress:()=>e.goBack()}])}catch(o){c.default.alert("Error",o.message||"Error al registrar administrador")}finally{w(!1)}}else c.default.alert("Error","Por favor complete todos los campos")},disabled:j,children:j?(0,p.jsx)(u.default,{color:"#FFF"}):(0,p.jsx)(n.default,{style:y.buttonText,children:"Registrar Administrador"})})]})]})})}):(0,p.jsxs)(r.default,{style:y.unauthorizedContainer,children:[(0,p.jsx)(n.default,{style:y.unauthorizedText,children:"Acceso restringido"}),(0,p.jsx)(n.default,{style:y.unauthorizedSubtext,children:"Solo administradores pueden registrar nuevos usuarios"}),(0,p.jsx)(l.default,{style:y.backButton,onPress:()=>e.goBack(),children:(0,p.jsx)(n.default,{style:y.backButtonText,children:"Volver"})})]})}},9866:(e,t,o)=>{o.r(t),o.d(t,{default:()=>s});var a=o(314),r=o(4485),n=o(4790),i=o(4023),l=o(7730);function s({navigation:e}){const[t,o]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(async()=>{try{const{data:{session:t},error:o}=await i.supabase.auth.getSession();if(o||!t)return void e.replace("Login");const{data:a,error:r}=await i.supabase.from("usuarios").select("rol").eq("idusuario",t.user.id).single();if(r||!a||"admin"!==a.rol)return await i.supabase.auth.signOut(),void e.replace("Login");e.replace("AdminArea",{screen:"PrincipalAdmin",params:{userId:t.user.id}})}catch(t){console.error("Error de autenticaci\xf3n:",t),e.replace("Login")}finally{o(!1)}})()}),[e]),(0,l.jsx)(r.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(n.default,{size:"large"})})}}},t={};function o(a){var r=t[a];if(void 0!==r)return r.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,o),n.exports}o.m=e,(()=>{var e=[];o.O=(t,a,r,n)=>{if(!a){var i=1/0;for(c=0;c<e.length;c++){for(var[a,r,n]=e[c],l=!0,s=0;s<a.length;s++)(!1&n||i>=n)&&Object.keys(o.O).every((e=>o.O[e](a[s])))?a.splice(s--,1):(l=!1,n<i&&(i=n));if(l){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,r,n]}})(),o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;o.t=function(a,r){if(1&r&&(a=this(a)),8&r)return a;if("object"===typeof a&&a){if(4&r&&a.__esModule)return a;if(16&r&&"function"===typeof a.then)return a}var n=Object.create(null);o.r(n);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&r&&a;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>i[e]=()=>a[e]));return i.default=()=>a,o.d(n,i),n}})(),o.d=(e,t)=>{for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,a)=>(o.f[a](e,t),t)),[])),o.u=e=>"static/js/"+e+".8d176786.chunk.js",o.miniCssF=e=>{},o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="web:";o.l=(a,r,n,i)=>{if(e[a])e[a].push(r);else{var l,s;if(void 0!==n)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+n){l=u;break}}l||(s=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.setAttribute("data-webpack",t+n),l.src=a),e[a]=[r];var f=(t,o)=>{l.onerror=l.onload=null,clearTimeout(h);var r=e[a];if(delete e[a],l.parentNode&&l.parentNode.removeChild(l),r&&r.forEach((e=>e(o))),t)return t(o)},h=setTimeout(f.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=f.bind(null,l.onerror),l.onload=f.bind(null,l.onload),s&&document.head.appendChild(l)}}})(),o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="/proyectocanones/",(()=>{var e={792:0};o.f.j=(t,a)=>{var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var n=new Promise(((o,a)=>r=e[t]=[o,a]));a.push(r[2]=n);var i=o.p+o.u(t),l=new Error;o.l(i,(a=>{if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var n=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",l.name="ChunkLoadError",l.type=n,l.request=i,r[1](l)}}),"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,a)=>{var r,n,[i,l,s]=a,d=0;if(i.some((t=>0!==e[t]))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(s)var c=s(o)}for(t&&t(a);d<i.length;d++)n=i[d],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(c)},a=self.webpackChunkweb=self.webpackChunkweb||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=o.O(void 0,[915],(()=>o(2705)));a=o.O(a)})();
//# sourceMappingURL=main.f201bece.js.map